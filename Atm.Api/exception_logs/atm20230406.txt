2023-04-06 18:57:00.518 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 18:57:00.587 +04:00 [DBG] Hosting starting
2023-04-06 18:57:00.612 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 18:57:00.619 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 18:57:00.626 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 18:57:00.632 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 18:57:00.637 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 18:57:00.643 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 18:57:00.647 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 18:57:00.650 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 18:57:00.652 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 18:57:00.655 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 18:57:00.661 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 18:57:00.665 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 18:57:00.667 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 18:57:00.800 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 18:57:00.801 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 18:57:00.802 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 18:57:00.802 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 18:57:00.803 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 18:57:00.804 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 18:57:00.805 +04:00 [INF] Hosting environment: Development
2023-04-06 18:57:00.805 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 18:57:00.806 +04:00 [DBG] Hosting started
2023-04-06 18:57:01.123 +04:00 [DBG] Connection id "0HMPMLSMLNGTO" accepted.
2023-04-06 18:57:01.123 +04:00 [DBG] Connection id "0HMPMLSMLNGTP" accepted.
2023-04-06 18:57:01.125 +04:00 [DBG] Connection id "0HMPMLSMLNGTO" started.
2023-04-06 18:57:01.125 +04:00 [DBG] Connection id "0HMPMLSMLNGTP" started.
2023-04-06 18:57:01.146 +04:00 [DBG] Connection id "0HMPMLSMLNGTO" received FIN.
2023-04-06 18:57:01.146 +04:00 [DBG] Connection id "0HMPMLSMLNGTP" received FIN.
2023-04-06 18:57:01.154 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 18:57:01.154 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 18:57:01.189 +04:00 [DBG] Connection id "0HMPMLSMLNGTO" stopped.
2023-04-06 18:57:01.189 +04:00 [DBG] Connection id "0HMPMLSMLNGTP" stopped.
2023-04-06 18:57:01.192 +04:00 [DBG] Connection id "0HMPMLSMLNGTP" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 18:57:01.192 +04:00 [DBG] Connection id "0HMPMLSMLNGTO" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 18:57:01.367 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" accepted.
2023-04-06 18:57:01.370 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" started.
2023-04-06 18:57:01.430 +04:00 [DBG] Connection 0HMPMLSMLNGTQ established using the following protocol: "Tls12"
2023-04-06 18:57:01.632 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 18:57:01.654 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 18:57:01.680 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 18:57:01.682 +04:00 [DBG] Request did not match any endpoints
2023-04-06 18:57:01.929 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 18:57:01.944 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 18:57:01.949 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 318.9812ms
2023-04-06 18:57:01.972 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 18:57:01.980 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 7.4576ms
2023-04-06 18:57:02.004 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 18:57:02.027 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 22.8099ms
2023-04-06 18:57:02.138 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 18:57:02.140 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 18:57:02.142 +04:00 [DBG] Request did not match any endpoints
2023-04-06 18:57:02.295 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 157.3543ms
2023-04-06 18:57:03.681 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" accepted.
2023-04-06 18:57:03.682 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" started.
2023-04-06 18:57:03.686 +04:00 [DBG] Connection 0HMPMLSMLNGTR established using the following protocol: "Tls12"
2023-04-06 18:57:03.689 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-06 18:57:03.692 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 18:57:03.694 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:03.697 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:03.699 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:03.700 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:03.701 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:03.702 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 13.3964ms
2023-04-06 18:57:03.704 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 45
2023-04-06 18:57:03.706 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 18:57:03.709 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-06 18:57:03.711 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:57:03.712 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:03.713 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:03.714 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:03.779 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-06 18:57:03.784 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:57:03.809 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:03.812 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:03.814 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:03.815 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:03.817 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:03.819 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:03.821 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:03.982 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 18:57:04.002 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:04.011 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 18:57:04.014 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-06 18:57:04.016 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 18:57:04.021 +04:00 [DBG] Connection id "0HMPMLSMLNGTR", Request id "0HMPMLSMLNGTR:00000003": started reading request body.
2023-04-06 18:57:04.023 +04:00 [DBG] Connection id "0HMPMLSMLNGTR", Request id "0HMPMLSMLNGTR:00000003": done reading request body.
2023-04-06 18:57:04.026 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-06 18:57:04.028 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:57:04.029 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:57:04.030 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 18:57:04.037 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:57:04.540 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 18:57:04.543 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 18:57:04.813 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:04.898 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-06 18:57:04.949 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 18:57:05.070 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 18:57:05.106 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:05.108 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:05.129 +04:00 [DBG] Created DbConnection. (18ms).
2023-04-06 18:57:05.136 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (28ms).
2023-04-06 18:57:05.146 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (40ms).
2023-04-06 18:57:05.150 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:05.327 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:05.335 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 18:57:05.397 +04:00 [INF] Executed DbCommand (64ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 18:57:05.421 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:05.461 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:05.470 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:05.484 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:05.490 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 86ms reading results.
2023-04-06 18:57:05.494 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:05.500 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-04-06 18:57:05.603 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:05.607 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:05.608 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:05.609 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:05.611 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:05.612 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:05.623 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 1800.7711ms
2023-04-06 18:57:05.624 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:57:05.627 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:05.630 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:05.633 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:57:05.634 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 45 - 200 - application/json;+charset=utf-8 1930.5247ms
2023-04-06 18:57:06.984 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" received FIN.
2023-04-06 18:57:06.984 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" received FIN.
2023-04-06 18:57:06.987 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" is closed. The last processed stream ID was 7.
2023-04-06 18:57:06.987 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" is closed. The last processed stream ID was 3.
2023-04-06 18:57:06.997 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" sending FIN because: "The client closed the connection."
2023-04-06 18:57:06.997 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" sending FIN because: "The client closed the connection."
2023-04-06 18:57:06.999 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTQ completed.
2023-04-06 18:57:07.000 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTR completed.
2023-04-06 18:57:07.003 +04:00 [DBG] Connection id "0HMPMLSMLNGTQ" stopped.
2023-04-06 18:57:07.003 +04:00 [DBG] Connection id "0HMPMLSMLNGTR" stopped.
2023-04-06 18:57:10.266 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" accepted.
2023-04-06 18:57:10.267 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" started.
2023-04-06 18:57:10.269 +04:00 [DBG] Connection 0HMPMLSMLNGTS established using the following protocol: "Tls12"
2023-04-06 18:57:10.270 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:10.270 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:10.271 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.272 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.273 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:10.274 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:10.276 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:10.277 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:10.278 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:10.278 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:10.280 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:10.281 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:10.282 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:10.283 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:10.284 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 13.3559ms
2023-04-06 18:57:10.284 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.1173ms
2023-04-06 18:57:10.286 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:10.287 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.288 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.290 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.291 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:10.292 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:10.293 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:10.336 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:10.338 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:10.346 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:10.347 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.352 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:10.354 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:10.355 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:10.357 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:10.358 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:10.360 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:10.361 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:10.364 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:10.378 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:10.382 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-06 18:57:10.384 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 18:57:10.392 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 18:57:10.396 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:10.397 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:10.398 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 18:57:10.399 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:10.401 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:57:10.402 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.404 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.406 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:10.416 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:10.419 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.421 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.423 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.424 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.426 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 18:57:10.428 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.430 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:10.432 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:10.435 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:10.436 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:10.437 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:10.439 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:10.440 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:10.447 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 85.4093ms
2023-04-06 18:57:10.448 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:10.449 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.450 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.452 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:10.453 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:10.454 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.456 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.458 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 18:57:10.459 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:10.460 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 174.4336ms
2023-04-06 18:57:10.461 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:10.464 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:10.468 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:10.469 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:10.471 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:10.473 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.475 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:10.477 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:10.479 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:10.481 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:10.483 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:10.484 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:10.486 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:10.489 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:10.548 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:10.554 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:10.555 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:10.556 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:10.557 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:10.558 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:57:10.559 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.560 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.562 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:10.568 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:10.571 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.572 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.574 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:10.575 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.576 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 18:57:10.578 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.580 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:10.582 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:10.584 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:10.585 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:10.586 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:10.587 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:10.588 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:10.589 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 103.9977ms
2023-04-06 18:57:10.591 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:10.592 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:10.593 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:10.594 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:57:10.596 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 147.7394ms
2023-04-06 18:57:13.220 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:13.221 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:13.222 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:13.224 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.225 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:13.225 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:13.226 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:13.227 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:13.229 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:13.231 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:13.232 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.233 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:13.235 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:13.236 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:13.238 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:13.240 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:13.241 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:13.243 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:13.245 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:13.247 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:13.250 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:13.251 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:13.251 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:13.252 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:13.253 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:13.254 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.256 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.257 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:13.262 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:13.264 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.266 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.267 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.269 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.270 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 18:57:13.271 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.272 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:13.274 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:13.276 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:13.277 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:13.278 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:13.279 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:13.282 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:13.284 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 40.5687ms
2023-04-06 18:57:13.285 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.285 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:13.286 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:13.287 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:13.288 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.289 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:13.290 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 18:57:13.292 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.293 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 73.5866ms
2023-04-06 18:57:13.294 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:13.297 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:13.298 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:13.299 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:13.300 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:13.301 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:13.301 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.302 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:13.304 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:13.305 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:13.307 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:13.309 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:13.311 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:13.313 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:13.314 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:13.316 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:13.318 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:13.319 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:13.320 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:13.321 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:13.322 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:13.323 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.324 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.326 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:13.329 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:13.332 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.333 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.334 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:13.335 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.336 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 18:57:13.337 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.338 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:13.340 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:13.342 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:13.343 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:13.344 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:13.345 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:13.346 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:13.347 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.8245ms
2023-04-06 18:57:13.349 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:13.350 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:13.351 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:13.352 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:57:13.353 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 67.8072ms
2023-04-06 18:57:16.989 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" received FIN.
2023-04-06 18:57:16.990 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" is closed. The last processed stream ID was 11.
2023-04-06 18:57:16.991 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTS completed.
2023-04-06 18:57:16.992 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" sending FIN because: "The client closed the connection."
2023-04-06 18:57:16.995 +04:00 [DBG] Connection id "0HMPMLSMLNGTS" stopped.
2023-04-06 18:57:27.849 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" accepted.
2023-04-06 18:57:27.850 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" started.
2023-04-06 18:57:27.852 +04:00 [DBG] Connection 0HMPMLSMLNGTT established using the following protocol: "Tls12"
2023-04-06 18:57:27.853 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 18:57:27.854 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 18:57:27.855 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:27.856 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:27.856 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:27.857 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:27.858 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:27.859 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.1248ms
2023-04-06 18:57:27.861 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 18:57:27.861 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 18:57:27.862 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 18:57:27.863 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:57:27.864 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:27.865 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:27.866 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:27.866 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:27.867 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:27.868 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:27.869 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:57:27.872 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 18:57:27.874 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:27.875 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:27.876 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:27.878 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:27.879 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:27.881 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 18:57:27.882 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 18:57:27.884 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 18:57:27.885 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 18:57:27.886 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 18:57:27.891 +04:00 [DBG] Connection id "0HMPMLSMLNGTT", Request id "0HMPMLSMLNGTT:00000003": started reading request body.
2023-04-06 18:57:27.893 +04:00 [DBG] Connection id "0HMPMLSMLNGTT", Request id "0HMPMLSMLNGTT:00000003": done reading request body.
2023-04-06 18:57:27.896 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 18:57:27.897 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:57:27.899 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:57:27.900 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 18:57:27.904 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:57:27.911 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:27.913 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 18:57:27.917 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 18:57:27.921 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:27.922 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:27.922 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:27.924 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:27.925 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:27.926 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:27.927 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:27.929 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 18:57:27.932 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 18:57:27.937 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.953 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.955 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.957 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.958 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.959 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.960 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.962 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.963 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.965 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.966 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.967 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.968 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.969 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.971 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.972 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.974 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.975 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.976 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.977 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.979 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.981 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.982 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.983 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.984 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.985 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.987 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.988 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.989 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.990 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.991 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.993 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.994 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.995 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.997 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.998 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:27.999 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.000 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.001 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.003 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.004 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.007 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.009 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.010 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.012 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 77ms reading results.
2023-04-06 18:57:28.013 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.014 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:57:28.021 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 18:57:28.026 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 18:57:28.047 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 18:57:28.053 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:28.055 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:57:28.055 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:28.057 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.058 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.059 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 18:57:28.067 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 18:57:28.071 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.085 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.088 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.113 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.115 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 44ms reading results.
2023-04-06 18:57:28.116 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.117 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:28.123 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt.Date == DateTime.Now.Date && (int)t.TransactionType == 0)'
2023-04-06 18:57:28.134 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromIban (string), 1], [Property: TransactionEntity.AccountFromId (Guid?), 2], [Property: TransactionEntity.AccountToIban (string), 3], [Property: TransactionEntity.AccountToId (Guid?), 4], [Property: TransactionEntity.CreatedAt (DateTime) Required, 5], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 6], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 7], [Property: TransactionEntity.Fee (decimal) Required, 8], [Property: TransactionEntity.ReceivedAmount (decimal) Required, 9], [Property: TransactionEntity.TransactionType (TransactionType) Required, 10], [Property: TransactionEntity.WithDrawnAmount (decimal) Required, 11] }
        SELECT t.Id, t.AccountFromIban, t.AccountFromId, t.AccountToIban, t.AccountToId, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.ReceivedAmount, t.TransactionType, t.WithDrawnAmount
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (CONVERT(date, t.CreatedAt) == CONVERT(date, GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 18:57:28.141 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:28.142 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:57:28.143 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:28.145 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.146 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.147 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 18:57:28.156 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 18:57:28.159 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.160 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 18:57:28.162 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.163 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:28.175 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.233 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.251 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.256 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 18:57:28.259 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 18:57:28.301 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 18:57:28.354 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 18:57:28.358 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.360 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.362 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 18:57:28.367 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 18:57:28.370 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:28.371 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 18:57:28.375 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:57:28.376 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 18:57:28.387 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 18:57:28.393 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.394 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 18:57:28.398 +04:00 [DBG] Committing transaction.
2023-04-06 18:57:28.401 +04:00 [DBG] Committed transaction.
2023-04-06 18:57:28.403 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.404 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:28.407 +04:00 [DBG] Disposing transaction.
2023-04-06 18:57:28.411 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.414 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.415 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:28.418 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 18:57:28.420 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:28.422 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:28.423 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:28.424 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:28.424 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:28.425 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:28.433 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 552.598ms
2023-04-06 18:57:28.434 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:57:28.435 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:28.436 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:28.438 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:57:28.439 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 578.3845ms
2023-04-06 18:57:37.013 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" received FIN.
2023-04-06 18:57:37.014 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" is closed. The last processed stream ID was 3.
2023-04-06 18:57:37.014 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTT completed.
2023-04-06 18:57:37.015 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" sending FIN because: "The client closed the connection."
2023-04-06 18:57:37.028 +04:00 [DBG] Connection id "0HMPMLSMLNGTT" stopped.
2023-04-06 18:57:57.457 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" accepted.
2023-04-06 18:57:57.459 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" started.
2023-04-06 18:57:57.460 +04:00 [DBG] Connection 0HMPMLSMLNGTU established using the following protocol: "Tls12"
2023-04-06 18:57:57.462 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:57.463 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:57.463 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.464 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.465 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:57.466 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:57:57.467 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:57.467 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:57.468 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:57.469 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:57.470 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:57.470 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:57.471 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:57.472 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:57:57.472 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 9.9572ms
2023-04-06 18:57:57.473 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.3788ms
2023-04-06 18:57:57.474 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:57.476 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.476 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.478 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.479 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:57.480 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:57.481 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:57.482 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:57.482 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:57.483 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:57.484 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.484 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:57.486 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:57.487 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:57.489 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:57.491 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:57.492 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:57.494 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:57.496 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:57.497 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:57.499 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:57.500 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:57.501 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:57.501 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:57.502 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:57.503 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.504 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.505 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:57.512 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:57.514 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.515 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.517 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.518 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.519 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 18:57:57.520 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.521 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:57:57.522 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:57.524 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:57.525 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:57.526 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:57.527 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:57.528 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:57.530 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 35.9661ms
2023-04-06 18:57:57.531 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.531 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:57:57.532 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:57.533 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.534 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.535 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:57:57.536 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:57:57.537 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.539 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 64.2611ms
2023-04-06 18:57:57.540 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:57:57.542 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:57:57.543 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:57:57.545 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:57:57.545 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:57:57.546 +04:00 [DBG] Authorization was successful.
2023-04-06 18:57:57.547 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.548 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:57:57.550 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:57:57.551 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:57:57.552 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:57:57.553 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:57:57.554 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:57:57.556 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:57.556 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:57:57.558 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:57:57.561 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:57:57.562 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:57:57.563 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:57:57.563 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:57:57.564 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:57:57.565 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.566 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.567 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:57.571 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:57:57.574 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.575 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.576 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:57:57.578 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.579 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 18:57:57.580 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.581 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:57:57.583 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:57:57.584 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:57:57.585 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:57:57.586 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:57:57.586 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:57:57.587 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:57:57.588 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 32.9047ms
2023-04-06 18:57:57.590 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:57:57.591 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:57:57.592 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:57:57.593 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 18:57:57.594 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 62.5987ms
2023-04-06 18:58:07.053 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" received FIN.
2023-04-06 18:58:07.055 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" is closed. The last processed stream ID was 7.
2023-04-06 18:58:07.055 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTU completed.
2023-04-06 18:58:07.056 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" sending FIN because: "The client closed the connection."
2023-04-06 18:58:07.069 +04:00 [DBG] Connection id "0HMPMLSMLNGTU" stopped.
2023-04-06 18:58:23.929 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" accepted.
2023-04-06 18:58:23.930 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" started.
2023-04-06 18:58:23.942 +04:00 [DBG] Connection 0HMPMLSMLNGTV established using the following protocol: "Tls12"
2023-04-06 18:58:23.944 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 18:58:23.945 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 18:58:23.946 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:23.947 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:23.948 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:23.949 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:23.949 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:23.950 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.3040ms
2023-04-06 18:58:23.952 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26
2023-04-06 18:58:23.952 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 18:58:23.953 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 18:58:23.955 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:58:23.956 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:23.956 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:23.957 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:23.958 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:58:23.959 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:58:23.960 +04:00 [DBG] Authorization was successful.
2023-04-06 18:58:23.962 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:58:23.963 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 18:58:23.964 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:23.966 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:23.967 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:23.969 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:23.969 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:23.971 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 18:58:23.973 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 18:58:23.973 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 18:58:23.975 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 18:58:23.976 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 18:58:23.978 +04:00 [DBG] Connection id "0HMPMLSMLNGTV", Request id "0HMPMLSMLNGTV:00000003": started reading request body.
2023-04-06 18:58:23.979 +04:00 [DBG] Connection id "0HMPMLSMLNGTV", Request id "0HMPMLSMLNGTV:00000003": done reading request body.
2023-04-06 18:58:23.980 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 18:58:23.981 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:58:23.982 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:58:23.983 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 18:58:23.984 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 18:58:23.986 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:23.987 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:23.988 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:23.989 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:58:23.989 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:58:23.990 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:23.991 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:23.992 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:23.993 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 18:58:23.996 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 18:58:23.998 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:23.999 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.000 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.001 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.002 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.003 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.004 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.005 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.006 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.007 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.009 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.010 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.011 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.012 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.014 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.015 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.016 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.017 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.019 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.020 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.021 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.022 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.023 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.025 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.025 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.027 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.029 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.030 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.030 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.032 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.033 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.034 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.035 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.036 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.037 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.038 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.039 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.040 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.041 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.042 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.043 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.045 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.046 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.047 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.048 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 50ms reading results.
2023-04-06 18:58:24.049 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.050 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:24.052 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:24.052 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 18:58:24.053 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:58:24.054 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.055 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.056 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 18:58:24.063 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 18:58:24.066 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.067 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.068 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.069 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.070 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 18:58:24.071 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.072 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:24.074 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:24.075 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 18:58:24.076 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:58:24.077 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.078 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.079 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 18:58:24.083 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 18:58:24.085 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.087 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.088 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 2ms reading results.
2023-04-06 18:58:24.089 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.090 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:24.092 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.095 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.096 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.097 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 18:58:24.098 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 18:58:24.099 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 18:58:24.101 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 18:58:24.101 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.102 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.103 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 18:58:24.104 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 18:58:24.105 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:24.106 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 18:58:24.107 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:58:24.108 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 18:58:24.115 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 18:58:24.119 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.120 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 18:58:24.121 +04:00 [DBG] Committing transaction.
2023-04-06 18:58:24.122 +04:00 [DBG] Committed transaction.
2023-04-06 18:58:24.123 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.124 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:24.125 +04:00 [DBG] Disposing transaction.
2023-04-06 18:58:24.125 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.127 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.129 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:24.130 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 18:58:24.131 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:24.133 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:24.134 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:24.134 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:24.135 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:24.136 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:24.137 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 166.2467ms
2023-04-06 18:58:24.138 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 18:58:24.139 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:24.140 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:24.141 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:58:24.142 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26 - 200 - application/json;+charset=utf-8 190.6875ms
2023-04-06 18:58:25.531 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:25.532 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:25.533 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.533 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.535 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:25.536 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:25.537 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:25.538 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:25.539 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:25.540 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:25.541 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:25.542 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:25.543 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:25.544 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:25.545 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.6054ms
2023-04-06 18:58:25.546 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.8055ms
2023-04-06 18:58:25.549 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:25.549 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.551 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.552 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.553 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:25.554 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:25.555 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:25.556 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:58:25.559 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:58:25.562 +04:00 [DBG] Authorization was successful.
2023-04-06 18:58:25.563 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.564 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:58:25.566 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:25.567 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:25.568 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:25.570 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:25.571 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:25.573 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:25.575 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:25.578 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:25.580 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:25.582 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:25.583 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 18:58:25.584 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:25.585 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:58:25.586 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.587 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.589 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:25.596 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:25.600 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.601 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.603 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.604 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.606 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 18:58:25.608 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.610 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:58:25.611 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:25.614 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:25.615 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:25.616 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:25.617 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:25.619 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:25.621 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 47.4399ms
2023-04-06 18:58:25.622 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:25.622 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.623 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.624 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:25.626 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:58:25.627 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.629 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.631 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-04-06 18:58:25.632 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:25.633 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 84.1298ms
2023-04-06 18:58:25.634 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:25.636 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:25.637 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:58:25.638 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:58:25.639 +04:00 [DBG] Authorization was successful.
2023-04-06 18:58:25.640 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.641 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:58:25.643 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:25.645 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:25.646 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:25.648 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:25.650 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:25.652 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:25.654 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:25.655 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:25.658 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:25.659 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:25.660 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:58:25.661 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:25.662 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:58:25.663 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.665 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.666 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:25.671 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:25.673 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.675 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.676 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:25.678 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.679 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 18:58:25.680 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.681 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:25.683 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:25.684 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:25.685 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:25.686 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:25.686 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:25.688 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:25.689 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 36.4959ms
2023-04-06 18:58:25.690 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:25.691 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:25.691 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:25.692 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:58:25.694 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 71.3192ms
2023-04-06 18:58:27.097 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" received FIN.
2023-04-06 18:58:27.098 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" is closed. The last processed stream ID was 11.
2023-04-06 18:58:27.098 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGTV completed.
2023-04-06 18:58:27.099 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" sending FIN because: "The client closed the connection."
2023-04-06 18:58:27.111 +04:00 [DBG] Connection id "0HMPMLSMLNGTV" stopped.
2023-04-06 18:58:43.440 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" accepted.
2023-04-06 18:58:43.441 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" started.
2023-04-06 18:58:43.443 +04:00 [DBG] Connection 0HMPMLSMLNGU0 established using the following protocol: "Tls12"
2023-04-06 18:58:43.445 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-06 18:58:43.446 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 18:58:43.447 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:43.448 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:43.450 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:43.451 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:43.452 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:43.453 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 7.4847ms
2023-04-06 18:58:43.454 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 48
2023-04-06 18:58:43.454 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 18:58:43.455 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-06 18:58:43.456 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:58:43.457 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:43.458 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:43.459 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:43.460 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-06 18:58:43.461 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:58:43.462 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:58:43.464 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:43.465 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:43.466 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:43.468 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:43.469 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:43.470 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:43.471 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:43.472 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 18:58:43.473 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-06 18:58:43.474 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 18:58:43.475 +04:00 [DBG] Connection id "0HMPMLSMLNGU0", Request id "0HMPMLSMLNGU0:00000003": started reading request body.
2023-04-06 18:58:43.476 +04:00 [DBG] Connection id "0HMPMLSMLNGU0", Request id "0HMPMLSMLNGU0:00000003": done reading request body.
2023-04-06 18:58:43.477 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-06 18:58:43.478 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:58:43.479 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:58:43.481 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 18:58:43.482 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 18:58:43.483 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:43.485 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:43.486 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:43.486 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:58:43.487 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 18:58:43.488 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:43.489 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:43.490 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:43.491 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 18:58:43.496 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 18:58:43.498 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:43.499 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:43.500 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:43.501 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:43.502 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 18:58:43.503 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:43.504 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:43.505 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:43.507 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:43.508 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:43.509 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:43.510 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:43.511 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:43.512 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 42.3434ms
2023-04-06 18:58:43.513 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 18:58:43.514 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:43.515 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:43.517 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:58:43.518 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 48 - 200 - application/json;+charset=utf-8 64.0976ms
2023-04-06 18:58:46.802 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:46.802 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:46.803 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.804 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.805 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:46.806 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 18:58:46.806 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:46.807 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:46.808 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:46.809 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:46.811 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:46.812 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:46.813 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:46.814 +04:00 [DBG] The request is a preflight request.
2023-04-06 18:58:46.814 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.6195ms
2023-04-06 18:58:46.815 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.8258ms
2023-04-06 18:58:46.816 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:46.818 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.819 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.821 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.822 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:46.823 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:46.823 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:46.824 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:58:46.825 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:58:46.826 +04:00 [DBG] Authorization was successful.
2023-04-06 18:58:46.827 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.828 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:58:46.830 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:46.831 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:46.832 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:46.834 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:46.835 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:46.836 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:46.838 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:46.839 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:46.842 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:46.843 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:46.844 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:58:46.845 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:46.846 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 18:58:46.847 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.848 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.850 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:46.855 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:46.858 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.860 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.862 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.863 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.864 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 18:58:46.866 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.867 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 18:58:46.869 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:46.870 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:46.871 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:46.872 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:46.872 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:46.874 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:46.875 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 38.6093ms
2023-04-06 18:58:46.876 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.877 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 18:58:46.878 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:46.879 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.880 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.882 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 18:58:46.883 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 18:58:46.884 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.885 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 69.3683ms
2023-04-06 18:58:46.886 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 18:58:46.888 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 18:58:46.889 +04:00 [INF] CORS policy execution successful.
2023-04-06 18:58:46.890 +04:00 [DBG] Successfully validated the token.
2023-04-06 18:58:46.891 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 18:58:46.892 +04:00 [DBG] Authorization was successful.
2023-04-06 18:58:46.892 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.894 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 18:58:46.896 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 18:58:46.897 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 18:58:46.898 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 18:58:46.900 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 18:58:46.901 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 18:58:46.902 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:46.903 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 18:58:46.904 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 18:58:46.906 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 18:58:46.906 +04:00 [DBG] Creating DbConnection.
2023-04-06 18:58:46.907 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 18:58:46.908 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 18:58:46.910 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 18:58:46.911 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.912 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.913 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:46.917 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 18:58:46.919 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.921 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.922 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 18:58:46.923 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.924 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 18:58:46.925 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.926 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 18:58:46.928 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 18:58:46.930 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 18:58:46.931 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 18:58:46.932 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 18:58:46.933 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 18:58:46.934 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 18:58:46.935 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 33.0424ms
2023-04-06 18:58:46.936 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 18:58:46.937 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 18:58:46.938 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 18:58:46.940 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 18:58:46.941 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 64.1222ms
2023-04-06 18:58:47.109 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" received FIN.
2023-04-06 18:58:47.110 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" is closed. The last processed stream ID was 11.
2023-04-06 18:58:47.111 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGU0 completed.
2023-04-06 18:58:47.112 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" sending FIN because: "The client closed the connection."
2023-04-06 18:58:47.119 +04:00 [DBG] Connection id "0HMPMLSMLNGU0" stopped.
2023-04-06 19:02:02.346 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" accepted.
2023-04-06 19:02:02.348 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" started.
2023-04-06 19:02:02.354 +04:00 [DBG] Connection 0HMPMLSMLNGU1 established using the following protocol: "Tls12"
2023-04-06 19:02:02.356 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 19:02:02.356 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 19:02:02.358 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.358 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.359 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 19:02:02.360 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 19:02:02.361 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:02.362 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:02.362 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:02.363 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:02.363 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:02.364 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:02.365 +04:00 [DBG] The request is a preflight request.
2023-04-06 19:02:02.365 +04:00 [DBG] The request is a preflight request.
2023-04-06 19:02:02.366 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.1010ms
2023-04-06 19:02:02.367 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.8726ms
2023-04-06 19:02:02.378 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 19:02:02.379 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.380 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.381 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.382 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:02.382 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:02.383 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:02.384 +04:00 [DBG] Successfully validated the token.
2023-04-06 19:02:02.384 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 19:02:02.386 +04:00 [DBG] Authorization was successful.
2023-04-06 19:02:02.386 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.387 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 19:02:02.389 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 19:02:02.390 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 19:02:02.391 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 19:02:02.392 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 19:02:02.393 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 19:02:02.394 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 19:02:02.395 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 19:02:02.397 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 19:02:02.399 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:02.399 +04:00 [DBG] Creating DbConnection.
2023-04-06 19:02:02.400 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 19:02:02.401 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:02.402 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 19:02:02.403 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.404 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.404 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 19:02:02.409 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 19:02:02.411 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.412 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.413 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.414 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.415 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-06 19:02:02.416 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.417 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:02.419 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 19:02:02.420 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 19:02:02.421 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 19:02:02.422 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 19:02:02.422 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 19:02:02.424 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 19:02:02.425 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.6139ms
2023-04-06 19:02:02.426 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.427 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 19:02:02.427 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 19:02:02.428 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.429 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.430 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 19:02:02.431 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 19:02:02.432 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.434 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 55.3861ms
2023-04-06 19:02:02.434 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:02.436 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:02.437 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:02.438 +04:00 [DBG] Successfully validated the token.
2023-04-06 19:02:02.439 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 19:02:02.440 +04:00 [DBG] Authorization was successful.
2023-04-06 19:02:02.441 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.442 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 19:02:02.444 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 19:02:02.445 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 19:02:02.446 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 19:02:02.447 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 19:02:02.449 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 19:02:02.450 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 19:02:02.451 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 19:02:02.452 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 19:02:02.454 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:02.454 +04:00 [DBG] Creating DbConnection.
2023-04-06 19:02:02.455 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 19:02:02.455 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:02.457 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 19:02:02.458 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.459 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.460 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 19:02:02.463 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 19:02:02.466 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.467 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.468 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:02.469 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.470 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 19:02:02.471 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.472 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:02.473 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 19:02:02.475 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 19:02:02.476 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 19:02:02.477 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 19:02:02.477 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 19:02:02.479 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 19:02:02.480 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 29.629ms
2023-04-06 19:02:02.481 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 19:02:02.482 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 19:02:02.483 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:02.484 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 19:02:02.485 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 58.0466ms
2023-04-06 19:02:07.299 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" received FIN.
2023-04-06 19:02:07.301 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" is closed. The last processed stream ID was 7.
2023-04-06 19:02:07.301 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGU1 completed.
2023-04-06 19:02:07.302 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" sending FIN because: "The client closed the connection."
2023-04-06 19:02:07.315 +04:00 [DBG] Connection id "0HMPMLSMLNGU1" stopped.
2023-04-06 19:02:10.352 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" accepted.
2023-04-06 19:02:10.353 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" started.
2023-04-06 19:02:10.354 +04:00 [DBG] Connection 0HMPMLSMLNGU2 established using the following protocol: "Tls12"
2023-04-06 19:02:10.356 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 19:02:10.357 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:10.358 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 19:02:10.359 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:10.360 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:10.361 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:10.361 +04:00 [DBG] The request is a preflight request.
2023-04-06 19:02:10.362 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.1393ms
2023-04-06 19:02:10.363 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 28
2023-04-06 19:02:10.364 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:10.365 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:10.366 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:10.367 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:10.368 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:10.369 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:10.370 +04:00 [DBG] Successfully validated the token.
2023-04-06 19:02:10.370 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 19:02:10.371 +04:00 [DBG] Authorization was successful.
2023-04-06 19:02:10.372 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:10.373 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 19:02:10.375 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 19:02:10.376 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 19:02:10.377 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 19:02:10.379 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 19:02:10.380 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 19:02:10.381 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:10.383 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:10.384 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:10.385 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 19:02:10.386 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 19:02:10.387 +04:00 [DBG] Connection id "0HMPMLSMLNGU2", Request id "0HMPMLSMLNGU2:00000003": started reading request body.
2023-04-06 19:02:10.388 +04:00 [DBG] Connection id "0HMPMLSMLNGU2", Request id "0HMPMLSMLNGU2:00000003": done reading request body.
2023-04-06 19:02:10.389 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 19:02:10.390 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:10.391 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:10.392 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:10.393 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:10.395 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 19:02:10.396 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:10.397 +04:00 [DBG] Creating DbConnection.
2023-04-06 19:02:10.397 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 19:02:10.398 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 19:02:10.399 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 19:02:10.400 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.401 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.402 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:10.404 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:10.406 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.407 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.409 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.410 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.411 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.413 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.414 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.415 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.417 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.418 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.419 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.420 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.421 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.422 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.424 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.425 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.426 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.427 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.428 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.430 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.431 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.432 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.433 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.434 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.435 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.436 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.437 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.439 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.440 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.442 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.443 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.444 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.445 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.447 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.448 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.449 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.451 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.452 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.453 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.454 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.455 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.457 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.458 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.459 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.461 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 55ms reading results.
2023-04-06 19:02:10.462 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.463 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:10.465 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:10.465 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:10.466 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:10.467 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.468 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.469 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:10.477 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:10.479 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.480 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.481 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:10.482 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.483 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 19:02:10.484 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.485 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:10.487 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:10.487 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:10.488 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:10.490 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.491 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.492 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:10.496 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:10.499 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.500 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 19:02:10.501 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.502 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:10.515 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 134.085ms
2023-04-06 19:02:10.517 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:10.544 +04:00 [ERR] Cashout limit is 10000 per day
BankSystem.Atm.Exceptions.CashOutLimitExceededException: Cashout limit is 10000 per day
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 86
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 19:02:10.616 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 19:02:10.617 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:10.618 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 19:02:10.620 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 28 - 1 - application/json 256.5746ms
2023-04-06 19:02:17.319 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" received FIN.
2023-04-06 19:02:17.320 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" is closed. The last processed stream ID was 3.
2023-04-06 19:02:17.320 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGU2 completed.
2023-04-06 19:02:17.321 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" sending FIN because: "The client closed the connection."
2023-04-06 19:02:17.335 +04:00 [DBG] Connection id "0HMPMLSMLNGU2" stopped.
2023-04-06 19:02:18.400 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" accepted.
2023-04-06 19:02:18.401 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" started.
2023-04-06 19:02:18.402 +04:00 [DBG] Connection 0HMPMLSMLNGU3 established using the following protocol: "Tls12"
2023-04-06 19:02:18.404 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 19:02:18.404 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:18.405 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 19:02:18.406 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:18.407 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:18.408 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:18.409 +04:00 [DBG] The request is a preflight request.
2023-04-06 19:02:18.409 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 5.8505ms
2023-04-06 19:02:18.411 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 28
2023-04-06 19:02:18.411 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:18.412 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:18.413 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:18.414 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:18.415 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:18.415 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:18.416 +04:00 [DBG] Successfully validated the token.
2023-04-06 19:02:18.416 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 19:02:18.417 +04:00 [DBG] Authorization was successful.
2023-04-06 19:02:18.418 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:18.419 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 19:02:18.420 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 19:02:18.421 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 19:02:18.422 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 19:02:18.424 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 19:02:18.426 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 19:02:18.427 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:18.428 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:18.429 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:18.430 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 19:02:18.431 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 19:02:18.432 +04:00 [DBG] Connection id "0HMPMLSMLNGU3", Request id "0HMPMLSMLNGU3:00000003": started reading request body.
2023-04-06 19:02:18.433 +04:00 [DBG] Connection id "0HMPMLSMLNGU3", Request id "0HMPMLSMLNGU3:00000003": done reading request body.
2023-04-06 19:02:18.434 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 19:02:18.435 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:18.436 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:18.437 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:18.438 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:18.440 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 19:02:18.442 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:18.443 +04:00 [DBG] Creating DbConnection.
2023-04-06 19:02:18.443 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 19:02:18.444 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 19:02:18.445 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 19:02:18.446 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.447 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.448 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:18.451 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:18.453 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.454 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.455 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.457 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.458 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.459 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.460 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.461 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.462 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.464 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.465 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.466 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.467 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.468 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.469 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.470 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.471 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.473 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.475 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.476 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.477 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.479 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.480 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.481 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.482 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.483 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.484 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.485 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.486 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.487 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.489 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.490 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.492 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.493 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.494 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.495 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.496 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.497 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.498 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.499 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.501 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.502 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.503 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.504 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.505 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 52ms reading results.
2023-04-06 19:02:18.508 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.509 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 19:02:18.511 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:18.512 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:18.513 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:18.514 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.515 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.516 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:18.523 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:18.526 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.527 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.529 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:18.530 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.531 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 19:02:18.532 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.534 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 19:02:18.535 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:18.536 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:18.537 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 19:02:18.539 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.540 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.541 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:18.545 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:18.547 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.548 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 0ms reading results.
2023-04-06 19:02:18.550 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.551 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:18.553 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 126.0171ms
2023-04-06 19:02:18.554 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:18.555 +04:00 [ERR] Cashout limit is 10000 per day
BankSystem.Atm.Exceptions.CashOutLimitExceededException: Cashout limit is 10000 per day
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 86
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 19:02:18.563 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 19:02:18.564 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:18.565 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 19:02:18.567 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 28 - 1 - application/json 155.9801ms
2023-04-06 19:02:24.240 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 19:02:24.241 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:24.243 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 19:02:24.243 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:24.244 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:24.245 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:24.245 +04:00 [DBG] The request is a preflight request.
2023-04-06 19:02:24.246 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 5.9281ms
2023-04-06 19:02:24.247 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26
2023-04-06 19:02:24.248 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:24.250 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 19:02:24.251 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:24.252 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 19:02:24.253 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 19:02:24.253 +04:00 [INF] CORS policy execution successful.
2023-04-06 19:02:24.254 +04:00 [DBG] Successfully validated the token.
2023-04-06 19:02:24.255 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 19:02:24.256 +04:00 [DBG] Authorization was successful.
2023-04-06 19:02:24.257 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:24.258 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 19:02:24.259 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 19:02:24.260 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 19:02:24.261 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 19:02:24.263 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 19:02:24.264 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 19:02:24.265 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:24.267 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 19:02:24.268 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:24.269 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 19:02:24.270 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 19:02:24.271 +04:00 [DBG] Connection id "0HMPMLSMLNGU3", Request id "0HMPMLSMLNGU3:00000007": started reading request body.
2023-04-06 19:02:24.273 +04:00 [DBG] Connection id "0HMPMLSMLNGU3", Request id "0HMPMLSMLNGU3:00000007": done reading request body.
2023-04-06 19:02:24.274 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 19:02:24.275 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:24.276 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:24.277 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 19:02:24.278 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 19:02:24.280 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 19:02:24.282 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:24.282 +04:00 [DBG] Creating DbConnection.
2023-04-06 19:02:24.283 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 19:02:24.284 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:24.284 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 19:02:24.285 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.286 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.287 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:24.290 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 19:02:24.292 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.293 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.294 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.295 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.296 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.297 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.298 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.299 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.300 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.301 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.302 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.303 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.304 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.305 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.306 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.308 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.309 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.310 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.311 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.312 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.314 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.315 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.317 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.318 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.319 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.320 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.321 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.322 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.324 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.325 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.326 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.327 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.329 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.330 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.331 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.332 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.333 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.334 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.335 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.336 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.337 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.338 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.340 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.341 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.342 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 50ms reading results.
2023-04-06 19:02:24.344 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.345 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 19:02:24.346 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:24.347 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:24.347 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:24.349 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.350 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.351 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:24.358 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 19:02:24.360 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.361 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.362 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.363 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.364 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-06 19:02:24.365 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.366 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:24.367 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:24.368 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:24.369 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:24.370 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.371 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.372 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:24.377 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 19:02:24.379 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.380 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 0ms reading results.
2023-04-06 19:02:24.381 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.382 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 19:02:24.383 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.384 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.385 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.386 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 19:02:24.387 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 19:02:24.388 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 19:02:24.390 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 19:02:24.391 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.392 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.394 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 19:02:24.394 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 19:02:24.395 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 19:02:24.396 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 19:02:24.397 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 19:02:24.398 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 19:02:24.405 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 19:02:24.409 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.411 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 19:02:24.412 +04:00 [DBG] Committing transaction.
2023-04-06 19:02:24.425 +04:00 [DBG] Committed transaction.
2023-04-06 19:02:24.426 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.427 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 19:02:24.429 +04:00 [DBG] Disposing transaction.
2023-04-06 19:02:24.430 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.431 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.433 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 19:02:24.434 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 19:02:24.435 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 19:02:24.438 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 19:02:24.440 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 19:02:24.441 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 19:02:24.442 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 19:02:24.444 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 19:02:24.446 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 180.0549ms
2023-04-06 19:02:24.447 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 19:02:24.448 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 19:02:24.449 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 19:02:24.450 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 19:02:24.451 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26 - 200 - application/json;+charset=utf-8 203.9949ms
2023-04-06 19:02:27.339 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" received FIN.
2023-04-06 19:02:27.341 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" is closed. The last processed stream ID was 7.
2023-04-06 19:02:27.341 +04:00 [DBG] The connection queue processing loop for 0HMPMLSMLNGU3 completed.
2023-04-06 19:02:27.343 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" sending FIN because: "The client closed the connection."
2023-04-06 19:02:27.354 +04:00 [DBG] Connection id "0HMPMLSMLNGU3" stopped.
2023-04-06 21:14:40.942 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:14:41.036 +04:00 [DBG] Hosting starting
2023-04-06 21:14:41.063 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:14:41.070 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:14:41.084 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:14:41.090 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:14:41.095 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:14:41.100 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:14:41.103 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:14:41.105 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:14:41.107 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:14:41.110 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:14:41.114 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:14:41.118 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:14:41.119 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:14:41.306 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:14:41.308 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:14:41.309 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:14:41.310 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:14:41.311 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:14:41.312 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:14:41.313 +04:00 [INF] Hosting environment: Development
2023-04-06 21:14:41.313 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:14:41.314 +04:00 [DBG] Hosting started
2023-04-06 21:14:41.379 +04:00 [DBG] Connection id "0HMPMO9KDLN5C" accepted.
2023-04-06 21:14:41.379 +04:00 [DBG] Connection id "0HMPMO9KDLN5D" accepted.
2023-04-06 21:14:41.384 +04:00 [DBG] Connection id "0HMPMO9KDLN5C" received FIN.
2023-04-06 21:14:41.384 +04:00 [DBG] Connection id "0HMPMO9KDLN5D" received FIN.
2023-04-06 21:14:41.384 +04:00 [DBG] Connection id "0HMPMO9KDLN5C" started.
2023-04-06 21:14:41.384 +04:00 [DBG] Connection id "0HMPMO9KDLN5D" started.
2023-04-06 21:14:41.405 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:14:41.405 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:14:41.435 +04:00 [DBG] Connection id "0HMPMO9KDLN5C" stopped.
2023-04-06 21:14:41.435 +04:00 [DBG] Connection id "0HMPMO9KDLN5D" stopped.
2023-04-06 21:14:41.438 +04:00 [DBG] Connection id "0HMPMO9KDLN5D" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:14:41.438 +04:00 [DBG] Connection id "0HMPMO9KDLN5C" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:14:45.449 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" accepted.
2023-04-06 21:14:45.451 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" started.
2023-04-06 21:14:45.504 +04:00 [DBG] Connection 0HMPMO9KDLN5E established using the following protocol: "Tls12"
2023-04-06 21:14:45.590 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:14:45.623 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:14:45.652 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:14:45.654 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:14:45.897 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:14:45.921 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:14:45.925 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 338.2210ms
2023-04-06 21:14:45.952 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:14:45.960 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 7.7472ms
2023-04-06 21:14:45.982 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:14:47.090 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 1107.2792ms
2023-04-06 21:14:47.177 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:14:47.187 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:14:47.190 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:14:47.318 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 140.3312ms
2023-04-06 21:14:47.888 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" received FIN.
2023-04-06 21:14:47.891 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5E completed.
2023-04-06 21:14:47.894 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" is closed. The last processed stream ID was 7.
2023-04-06 21:14:47.895 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" sending FIN because: "The client closed the connection."
2023-04-06 21:14:47.903 +04:00 [DBG] Connection id "0HMPMO9KDLN5E" stopped.
2023-04-06 21:15:04.821 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" accepted.
2023-04-06 21:15:04.823 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" started.
2023-04-06 21:15:04.828 +04:00 [DBG] Connection 0HMPMO9KDLN5F established using the following protocol: "Tls12"
2023-04-06 21:15:04.830 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-06 21:15:04.834 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 21:15:04.836 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:15:04.838 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:04.842 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:04.843 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:04.845 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:15:04.846 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 16.2474ms
2023-04-06 21:15:04.848 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 48
2023-04-06 21:15:04.850 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 21:15:04.853 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-06 21:15:04.855 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:15:04.856 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:04.858 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:04.860 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:04.893 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-06 21:15:04.901 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:15:04.946 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:15:04.950 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:15:04.952 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:15:04.954 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:15:04.956 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:15:04.957 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:15:04.960 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:05.088 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:15:05.108 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:05.117 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 21:15:05.120 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-06 21:15:05.123 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:15:05.128 +04:00 [DBG] Connection id "0HMPMO9KDLN5F", Request id "0HMPMO9KDLN5F:00000003": started reading request body.
2023-04-06 21:15:05.130 +04:00 [DBG] Connection id "0HMPMO9KDLN5F", Request id "0HMPMO9KDLN5F:00000003": done reading request body.
2023-04-06 21:15:05.134 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-06 21:15:05.136 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:15:05.138 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:15:05.139 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 21:15:05.148 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:15:05.544 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:15:05.545 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:15:05.827 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:15:05.914 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-06 21:15:05.985 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:15:06.122 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:15:06.154 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:15:06.157 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:15:06.183 +04:00 [DBG] Created DbConnection. (23ms).
2023-04-06 21:15:06.190 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (37ms).
2023-04-06 21:15:06.200 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (47ms).
2023-04-06 21:15:06.204 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:06.391 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:06.399 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 21:15:06.444 +04:00 [INF] Executed DbCommand (47ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 21:15:06.476 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:06.515 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:06.523 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:06.535 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:06.541 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 90ms reading results.
2023-04-06 21:15:06.546 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:06.551 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-04-06 21:15:06.639 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:15:06.643 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:15:06.644 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:15:06.644 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:15:06.646 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:15:06.648 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:15:06.660 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 1699.5228ms
2023-04-06 21:15:06.662 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:15:06.665 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:15:06.670 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:06.674 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-04-06 21:15:06.676 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 48 - 200 - application/json;+charset=utf-8 1828.3563ms
2023-04-06 21:15:09.829 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:15:09.830 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:15:09.831 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:15:09.832 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:15:09.833 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:15:09.835 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:15:09.836 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:09.837 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:09.838 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:09.838 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:09.839 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:09.840 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:09.841 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:15:09.841 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:15:09.843 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 13.0190ms
2023-04-06 21:15:09.843 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 13.8447ms
2023-04-06 21:15:09.845 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:15:09.846 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:15:09.847 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:15:09.849 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:09.850 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:09.851 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:09.852 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:09.888 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:15:09.891 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:15:09.897 +04:00 [DBG] Authorization was successful.
2023-04-06 21:15:09.898 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:09.903 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:15:09.906 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:15:09.907 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:15:09.908 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:15:09.910 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:15:09.911 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:15:09.913 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:09.915 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:09.930 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:15:09.934 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-06 21:15:09.937 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:15:09.945 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:15:09.950 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:15:09.953 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:15:09.954 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:15:09.956 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2023-04-06 21:15:09.957 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2023-04-06 21:15:09.959 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:09.961 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:09.963 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:15:09.973 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:15:09.976 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:09.977 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:09.979 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:09.981 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:09.982 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:15:09.984 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:09.985 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:15:09.987 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:15:09.990 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:15:09.991 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:15:09.992 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:15:09.993 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:15:09.994 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:15:09.999 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 86.0308ms
2023-04-06 21:15:10.001 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:10.001 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:15:10.002 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:15:10.003 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:15:10.004 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.004 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:15:10.006 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:15:10.007 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:10.008 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 162.7123ms
2023-04-06 21:15:10.009 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:15:10.010 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:15:10.011 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:15:10.016 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:15:10.017 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:15:10.019 +04:00 [DBG] Authorization was successful.
2023-04-06 21:15:10.022 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:10.023 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:15:10.025 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:15:10.027 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:15:10.028 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:15:10.031 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:15:10.032 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:15:10.034 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:10.037 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:15:10.091 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:15:10.097 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:15:10.098 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:15:10.099 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:15:10.100 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:15:10.101 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:15:10.103 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.104 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.105 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:15:10.108 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:15:10.112 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:10.113 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:10.115 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:15:10.117 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.118 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:15:10.119 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.121 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:15:10.122 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:15:10.125 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:15:10.126 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:15:10.127 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:15:10.129 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:15:10.130 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:15:10.132 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 97.734ms
2023-04-06 21:15:10.134 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:15:10.135 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:15:10.136 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:15:10.137 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:15:10.139 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 137.9491ms
2023-04-06 21:15:14.905 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" received FIN.
2023-04-06 21:15:14.906 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" is closed. The last processed stream ID was 11.
2023-04-06 21:15:14.906 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5F completed.
2023-04-06 21:15:14.908 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" sending FIN because: "The client closed the connection."
2023-04-06 21:15:14.911 +04:00 [DBG] Connection id "0HMPMO9KDLN5F" stopped.
2023-04-06 21:16:40.383 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" accepted.
2023-04-06 21:16:40.385 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" started.
2023-04-06 21:16:40.392 +04:00 [DBG] Connection 0HMPMO9KDLN5G established using the following protocol: "Tls12"
2023-04-06 21:16:40.394 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:16:40.395 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:16:40.396 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:16:40.397 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:40.398 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:40.399 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:40.400 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:16:40.401 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 7.4101ms
2023-04-06 21:16:40.403 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:16:40.404 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:16:40.404 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:16:40.406 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:16:40.407 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:40.407 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:40.408 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:40.410 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:16:40.410 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:16:40.412 +04:00 [DBG] Authorization was successful.
2023-04-06 21:16:40.413 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:16:40.418 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:16:40.420 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:16:40.422 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:16:40.423 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:16:40.425 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:16:40.427 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:16:40.428 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:16:40.431 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:16:40.433 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:16:40.435 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:16:40.437 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:16:40.442 +04:00 [DBG] Connection id "0HMPMO9KDLN5G", Request id "0HMPMO9KDLN5G:00000003": started reading request body.
2023-04-06 21:16:40.444 +04:00 [DBG] Connection id "0HMPMO9KDLN5G", Request id "0HMPMO9KDLN5G:00000003": done reading request body.
2023-04-06 21:16:40.449 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:16:40.450 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:16:40.452 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:16:40.453 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:16:40.460 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:16:40.468 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:16:40.471 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:16:40.476 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:16:40.479 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:40.480 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:16:40.481 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:16:40.482 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:16:40.483 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:16:40.484 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.485 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.485 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:16:40.490 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:16:40.494 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.509 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.511 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.512 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.513 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.515 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.517 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.518 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.519 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.521 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.522 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.523 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.524 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.525 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.526 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.527 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.528 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.529 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.530 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.532 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.533 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.534 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.535 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.537 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.538 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.539 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.540 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.541 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.542 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.543 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.545 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.547 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.548 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.549 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.550 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.553 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.554 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.555 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.556 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.557 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.558 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.561 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.562 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.564 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.566 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 74ms reading results.
2023-04-06 21:16:40.567 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.568 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:40.576 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:16:40.583 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:16:40.604 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:16:40.611 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:40.612 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:16:40.613 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:16:40.614 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.616 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.617 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:16:40.631 +04:00 [INF] Executed DbCommand (14ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:16:40.635 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.646 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.649 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.678 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.679 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 45ms reading results.
2023-04-06 21:16:40.682 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.683 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:40.690 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt.Date == DateTime.Now.Date && (int)t.TransactionType == 0)'
2023-04-06 21:16:40.700 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromIban (string), 1], [Property: TransactionEntity.AccountFromId (Guid?), 2], [Property: TransactionEntity.AccountToIban (string), 3], [Property: TransactionEntity.AccountToId (Guid?), 4], [Property: TransactionEntity.CreatedAt (DateTime) Required, 5], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 6], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 7], [Property: TransactionEntity.Fee (decimal) Required, 8], [Property: TransactionEntity.ReceivedAmount (decimal) Required, 9], [Property: TransactionEntity.TransactionType (TransactionType) Required, 10], [Property: TransactionEntity.WithDrawnAmount (decimal) Required, 11] }
        SELECT t.Id, t.AccountFromIban, t.AccountFromId, t.AccountToIban, t.AccountToId, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.ReceivedAmount, t.TransactionType, t.WithDrawnAmount
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (CONVERT(date, t.CreatedAt) == CONVERT(date, GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:16:40.706 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:40.707 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:16:40.708 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:16:40.709 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.710 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.711 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:16:40.718 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:16:40.724 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.742 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.744 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 22ms reading results.
2023-04-06 21:16:40.746 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.748 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:40.759 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.776 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.790 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.794 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:16:40.797 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:16:40.827 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:16:40.884 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:16:40.886 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.887 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.889 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:16:40.896 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:16:40.900 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:40.902 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:16:40.905 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:16:40.907 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:16:40.928 +04:00 [INF] Executed DbCommand (22ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:16:40.936 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.937 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:16:40.942 +04:00 [DBG] Committing transaction.
2023-04-06 21:16:40.946 +04:00 [DBG] Committed transaction.
2023-04-06 21:16:40.948 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.950 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:40.953 +04:00 [DBG] Disposing transaction.
2023-04-06 21:16:40.956 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.959 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.961 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:40.965 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:16:40.966 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:16:40.968 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:16:40.969 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:16:40.970 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:16:40.970 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:16:40.972 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:16:40.978 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 550.367ms
2023-04-06 21:16:40.980 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:16:40.981 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:16:40.982 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:40.983 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:16:40.984 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 581.2408ms
2023-04-06 21:16:45.735 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:16:45.735 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:16:45.736 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.737 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.738 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:16:45.740 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:16:45.741 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:45.742 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:45.743 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:45.744 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:45.745 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:45.746 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:45.747 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:16:45.748 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:16:45.749 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.8810ms
2023-04-06 21:16:45.750 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.9976ms
2023-04-06 21:16:45.752 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:16:45.753 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.754 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.756 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.757 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:45.758 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:45.759 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:45.761 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:16:45.762 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:16:45.763 +04:00 [DBG] Authorization was successful.
2023-04-06 21:16:45.764 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.766 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:16:45.768 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:16:45.769 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:16:45.771 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:16:45.773 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:16:45.775 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:16:45.777 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:16:45.778 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:16:45.780 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:16:45.784 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:45.785 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:16:45.786 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:16:45.787 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:16:45.788 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:16:45.790 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.791 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.793 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:16:45.807 +04:00 [INF] Executed DbCommand (14ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:16:45.810 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.812 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.814 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.816 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.817 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:16:45.819 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.820 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:45.822 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:16:45.824 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:16:45.825 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:16:45.826 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:16:45.826 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:16:45.828 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:16:45.829 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 52.633ms
2023-04-06 21:16:45.831 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:16:45.831 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.832 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.833 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:16:45.834 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:16:45.835 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.837 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.839 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-04-06 21:16:45.840 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:16:45.841 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 88.4623ms
2023-04-06 21:16:45.842 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:16:45.843 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:16:45.845 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:16:45.845 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:16:45.847 +04:00 [DBG] Authorization was successful.
2023-04-06 21:16:45.848 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.849 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:16:45.851 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:16:45.853 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:16:45.855 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:16:45.857 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:16:45.858 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:16:45.860 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:16:45.861 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:16:45.863 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:16:45.865 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:16:45.866 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:16:45.866 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:16:45.867 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:16:45.868 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:16:45.869 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.870 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.871 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:16:45.876 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:16:45.878 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.879 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.881 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:16:45.883 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.884 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:16:45.885 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.886 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:16:45.888 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:16:45.890 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:16:45.890 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:16:45.891 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:16:45.892 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:16:45.893 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:16:45.894 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.6794ms
2023-04-06 21:16:45.895 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:16:45.896 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:16:45.897 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:16:45.898 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:16:45.899 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 68.4543ms
2023-04-06 21:16:50.065 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" received FIN.
2023-04-06 21:16:50.067 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" is closed. The last processed stream ID was 11.
2023-04-06 21:16:50.067 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5G completed.
2023-04-06 21:16:50.068 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" sending FIN because: "The client closed the connection."
2023-04-06 21:16:50.074 +04:00 [DBG] Connection id "0HMPMO9KDLN5G" stopped.
2023-04-06 21:17:12.100 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" accepted.
2023-04-06 21:17:12.101 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" started.
2023-04-06 21:17:12.107 +04:00 [DBG] Connection 0HMPMO9KDLN5H established using the following protocol: "Tls12"
2023-04-06 21:17:12.108 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:17:12.109 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:12.110 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:12.111 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:12.112 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:12.113 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:12.114 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:12.115 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.4661ms
2023-04-06 21:17:12.116 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:17:12.117 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:12.118 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:12.119 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:12.120 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:12.121 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:12.122 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:12.123 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:12.123 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:12.124 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:12.125 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:12.126 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:17:12.128 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:12.129 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:12.130 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:12.132 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:12.133 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:12.134 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:17:12.136 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:17:12.137 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:17:12.139 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:17:12.140 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:17:12.141 +04:00 [DBG] Connection id "0HMPMO9KDLN5H", Request id "0HMPMO9KDLN5H:00000003": started reading request body.
2023-04-06 21:17:12.142 +04:00 [DBG] Connection id "0HMPMO9KDLN5H", Request id "0HMPMO9KDLN5H:00000003": done reading request body.
2023-04-06 21:17:12.143 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:17:12.144 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:12.145 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:12.146 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:17:12.148 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:12.150 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:12.152 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:12.153 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:12.153 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:12.154 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:12.155 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:12.156 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.157 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.158 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:17:12.162 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:17:12.165 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.166 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.167 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.169 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.170 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.171 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.173 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.174 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.175 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.177 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.178 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.180 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.182 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.183 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.185 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.186 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.187 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.188 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.190 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.191 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.193 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.194 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.195 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.197 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.199 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.200 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.201 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.203 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.204 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.205 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.207 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.208 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.209 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.210 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.211 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.213 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.215 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.216 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.217 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.218 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.219 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.221 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.222 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.223 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.224 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 59ms reading results.
2023-04-06 21:17:12.225 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.226 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:12.228 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:12.229 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:17:12.230 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:12.232 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.233 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.234 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:17:12.242 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:17:12.245 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.247 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.248 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.250 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.251 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:17:12.252 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.253 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:12.255 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:12.256 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:17:12.257 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:17:12.258 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.259 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.260 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:17:12.266 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:17:12.269 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.270 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.271 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.273 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-06 21:17:12.274 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.275 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:17:12.277 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.280 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.282 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.283 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:17:12.284 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:17:12.286 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:17:12.287 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:17:12.288 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.290 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.291 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:17:12.292 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:17:12.293 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:12.294 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:17:12.295 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:12.297 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:17:12.306 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:17:12.309 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.310 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 21:17:12.312 +04:00 [DBG] Committing transaction.
2023-04-06 21:17:12.314 +04:00 [DBG] Committed transaction.
2023-04-06 21:17:12.314 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.316 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:17:12.317 +04:00 [DBG] Disposing transaction.
2023-04-06 21:17:12.317 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.319 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.321 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:12.322 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:17:12.323 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:12.326 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:12.326 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:12.327 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:12.328 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:12.329 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:12.330 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 195.8662ms
2023-04-06 21:17:12.332 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:12.333 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:12.334 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:12.335 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:17:12.336 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 219.8239ms
2023-04-06 21:17:14.213 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:14.214 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:14.215 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.216 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.217 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:14.218 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:14.219 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:14.219 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:14.220 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:14.221 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:14.222 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:14.223 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:14.224 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:14.224 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:14.225 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.7358ms
2023-04-06 21:17:14.226 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.4946ms
2023-04-06 21:17:14.227 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:14.228 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.229 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.231 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.232 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:14.233 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:14.233 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:14.234 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:14.235 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:14.236 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:14.237 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.238 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:17:14.239 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:14.240 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:14.241 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:14.243 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:14.244 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:14.245 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:14.246 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:14.248 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:14.250 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:14.251 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:14.251 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:14.252 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:14.253 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:14.254 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.255 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.256 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:14.261 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:14.263 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.265 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.266 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.267 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.268 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:17:14.270 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.271 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:17:14.273 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:14.275 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:14.275 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:14.276 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:14.277 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:14.278 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:14.279 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.0781ms
2023-04-06 21:17:14.281 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.281 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:14.282 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:14.283 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.284 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.285 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:17:14.286 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:17:14.288 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.289 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 61.5941ms
2023-04-06 21:17:14.290 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:14.291 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:14.292 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:14.293 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:14.294 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:14.295 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:14.296 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.297 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:17:14.298 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:14.300 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:14.301 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:14.303 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:14.304 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:14.305 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:14.306 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:14.307 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:14.309 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:14.309 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:14.310 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:14.311 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:14.312 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:14.313 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.314 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.315 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:14.318 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:14.320 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.322 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.323 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:14.324 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.325 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:17:14.326 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.327 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:14.328 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:14.330 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:14.331 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:14.332 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:14.333 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:14.334 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:14.335 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.034ms
2023-04-06 21:17:14.336 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:14.337 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:14.338 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:14.339 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:17:14.340 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 58.7586ms
2023-04-06 21:17:15.075 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" received FIN.
2023-04-06 21:17:15.076 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" is closed. The last processed stream ID was 11.
2023-04-06 21:17:15.076 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5H completed.
2023-04-06 21:17:15.077 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" sending FIN because: "The client closed the connection."
2023-04-06 21:17:15.090 +04:00 [DBG] Connection id "0HMPMO9KDLN5H" stopped.
2023-04-06 21:17:23.756 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" accepted.
2023-04-06 21:17:23.757 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" started.
2023-04-06 21:17:23.759 +04:00 [DBG] Connection 0HMPMO9KDLN5I established using the following protocol: "Tls12"
2023-04-06 21:17:23.761 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:17:23.761 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:23.763 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:23.764 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:23.765 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:23.766 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:23.767 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:23.768 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.8733ms
2023-04-06 21:17:23.769 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:17:23.770 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:23.771 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:17:23.772 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:23.773 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:23.773 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:23.774 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:23.775 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:23.776 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:23.777 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:23.778 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:23.779 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:17:23.781 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:23.782 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:23.784 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:23.786 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:23.787 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:23.789 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:17:23.791 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:17:23.792 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:17:23.794 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:17:23.795 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:17:23.797 +04:00 [DBG] Connection id "0HMPMO9KDLN5I", Request id "0HMPMO9KDLN5I:00000003": started reading request body.
2023-04-06 21:17:23.798 +04:00 [DBG] Connection id "0HMPMO9KDLN5I", Request id "0HMPMO9KDLN5I:00000003": done reading request body.
2023-04-06 21:17:23.799 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:17:23.800 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:23.801 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:23.802 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:17:23.804 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:17:23.806 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:23.807 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:23.809 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:23.809 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:23.811 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:23.812 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:17:23.814 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.815 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.816 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:17:23.821 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:17:23.824 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.827 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.828 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.830 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.831 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.833 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.835 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.836 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.838 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.839 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.840 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.841 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.843 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.844 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.845 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.847 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.848 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.849 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.850 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.852 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.853 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.854 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.855 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.857 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.858 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.859 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.860 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.862 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.863 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.864 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.865 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.867 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.868 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.869 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.870 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.872 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.873 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.874 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.875 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.877 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.878 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.879 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.881 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 57ms reading results.
2023-04-06 21:17:23.882 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.883 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:23.884 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:23.885 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:17:23.886 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:17:23.887 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.888 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.889 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:17:23.897 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:17:23.900 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.901 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.903 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.905 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.906 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:17:23.907 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.908 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:23.910 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:23.910 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:17:23.912 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:23.913 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.914 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.915 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:17:23.919 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:17:23.923 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.924 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.925 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.926 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.927 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:17:23.929 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.930 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:17:23.932 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.933 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.934 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.935 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:17:23.937 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:17:23.938 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:17:23.939 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:17:23.940 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.941 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.942 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:17:23.943 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:17:23.944 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:23.945 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:17:23.947 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:23.948 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:17:23.954 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:17:23.957 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.958 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 0ms reading results.
2023-04-06 21:17:23.959 +04:00 [DBG] Committing transaction.
2023-04-06 21:17:23.961 +04:00 [DBG] Committed transaction.
2023-04-06 21:17:23.962 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.963 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:17:23.964 +04:00 [DBG] Disposing transaction.
2023-04-06 21:17:23.965 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.966 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.968 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:23.970 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:17:23.971 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:23.973 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:23.974 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:23.974 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:23.975 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:23.976 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:23.977 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 188.3964ms
2023-04-06 21:17:23.978 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:17:23.979 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:23.980 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:23.982 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:17:23.983 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 213.8307ms
2023-04-06 21:17:25.089 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" received FIN.
2023-04-06 21:17:25.091 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" is closed. The last processed stream ID was 3.
2023-04-06 21:17:25.091 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5I completed.
2023-04-06 21:17:25.092 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" sending FIN because: "The client closed the connection."
2023-04-06 21:17:25.098 +04:00 [DBG] Connection id "0HMPMO9KDLN5I" stopped.
2023-04-06 21:17:25.461 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" accepted.
2023-04-06 21:17:25.462 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" started.
2023-04-06 21:17:25.465 +04:00 [DBG] Connection 0HMPMO9KDLN5J established using the following protocol: "Tls12"
2023-04-06 21:17:25.466 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:25.466 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:25.467 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.467 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.468 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:25.469 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:17:25.469 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:25.470 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:25.471 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:25.472 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:25.473 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:25.474 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:25.475 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:25.475 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:17:25.476 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.1254ms
2023-04-06 21:17:25.477 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.7869ms
2023-04-06 21:17:25.478 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:25.479 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.480 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.482 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.482 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:25.483 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:25.484 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:25.484 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:25.485 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:25.486 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:25.487 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.487 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:17:25.489 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:25.490 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:25.492 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:25.493 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:25.495 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:25.496 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:25.498 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:25.499 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:25.500 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:25.501 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:25.502 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:25.503 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:25.504 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:25.505 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.506 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.507 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:25.511 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:25.514 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.515 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.517 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.518 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.519 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:17:25.520 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.522 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (2ms).
2023-04-06 21:17:25.523 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:25.525 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:25.526 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:25.527 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:25.528 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:25.529 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:25.530 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.1986ms
2023-04-06 21:17:25.531 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.531 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:17:25.533 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:25.533 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.534 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.535 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:17:25.536 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:17:25.537 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.538 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 60.6028ms
2023-04-06 21:17:25.539 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:17:25.541 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:17:25.541 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:17:25.542 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:17:25.543 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:17:25.544 +04:00 [DBG] Authorization was successful.
2023-04-06 21:17:25.544 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.545 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:17:25.547 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:17:25.548 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:17:25.550 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:17:25.552 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:17:25.553 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:17:25.554 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:25.555 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:17:25.557 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:17:25.558 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:17:25.559 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:17:25.560 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:17:25.561 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:17:25.562 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:17:25.563 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.565 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.566 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:25.568 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:17:25.570 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.571 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.572 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:17:25.574 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.575 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:17:25.576 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.577 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:17:25.578 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:17:25.580 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:17:25.581 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:17:25.582 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:17:25.583 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:17:25.584 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:17:25.585 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.8728ms
2023-04-06 21:17:25.586 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:17:25.587 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:17:25.588 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:17:25.589 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:17:25.590 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 58.6284ms
2023-04-06 21:17:35.108 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" received FIN.
2023-04-06 21:17:35.109 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" is closed. The last processed stream ID was 7.
2023-04-06 21:17:35.109 +04:00 [DBG] The connection queue processing loop for 0HMPMO9KDLN5J completed.
2023-04-06 21:17:35.111 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" sending FIN because: "The client closed the connection."
2023-04-06 21:17:35.123 +04:00 [DBG] Connection id "0HMPMO9KDLN5J" stopped.
2023-04-06 21:29:19.555 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:29:19.659 +04:00 [DBG] Hosting starting
2023-04-06 21:29:19.698 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:29:19.707 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:29:19.728 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:29:19.737 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:29:19.745 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:29:19.750 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:29:19.755 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:29:19.758 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:29:19.760 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:29:19.764 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:29:19.767 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:29:19.771 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:29:19.774 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:29:19.937 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:29:19.938 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:29:19.939 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:29:19.940 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:29:19.941 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:29:19.943 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:29:19.944 +04:00 [INF] Hosting environment: Development
2023-04-06 21:29:19.945 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:29:19.946 +04:00 [DBG] Hosting started
2023-04-06 21:29:20.376 +04:00 [DBG] Connection id "0HMPMOHQCEDGO" accepted.
2023-04-06 21:29:20.376 +04:00 [DBG] Connection id "0HMPMOHQCEDGP" accepted.
2023-04-06 21:29:20.378 +04:00 [DBG] Connection id "0HMPMOHQCEDGO" started.
2023-04-06 21:29:20.378 +04:00 [DBG] Connection id "0HMPMOHQCEDGP" started.
2023-04-06 21:29:20.386 +04:00 [DBG] Connection id "0HMPMOHQCEDGP" received FIN.
2023-04-06 21:29:20.386 +04:00 [DBG] Connection id "0HMPMOHQCEDGO" received FIN.
2023-04-06 21:29:20.397 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:29:20.397 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:29:20.404 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" accepted.
2023-04-06 21:29:20.442 +04:00 [DBG] Connection id "0HMPMOHQCEDGO" stopped.
2023-04-06 21:29:20.442 +04:00 [DBG] Connection id "0HMPMOHQCEDGP" stopped.
2023-04-06 21:29:20.442 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" started.
2023-04-06 21:29:20.445 +04:00 [DBG] Connection id "0HMPMOHQCEDGP" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:29:20.445 +04:00 [DBG] Connection id "0HMPMOHQCEDGO" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:29:20.493 +04:00 [DBG] Connection 0HMPMOHQCEDGQ established using the following protocol: "Tls12"
2023-04-06 21:29:20.547 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:29:20.568 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:29:20.590 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:29:20.593 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:29:20.772 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:29:20.793 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:29:20.798 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 251.1397ms
2023-04-06 21:29:20.851 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:29:20.851 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:29:20.861 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 8.8213ms
2023-04-06 21:29:20.881 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 30.2093ms
2023-04-06 21:29:21.173 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:29:21.175 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:29:21.177 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:29:21.301 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 127.4648ms
2023-04-06 21:29:26.211 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" received FIN.
2023-04-06 21:29:26.214 +04:00 [DBG] The connection queue processing loop for 0HMPMOHQCEDGQ completed.
2023-04-06 21:29:26.216 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" is closed. The last processed stream ID was 7.
2023-04-06 21:29:26.218 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" sending FIN because: "The client closed the connection."
2023-04-06 21:29:26.227 +04:00 [DBG] Connection id "0HMPMOHQCEDGQ" stopped.
2023-04-06 21:29:36.250 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" accepted.
2023-04-06 21:29:36.253 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" started.
2023-04-06 21:29:36.259 +04:00 [DBG] Connection 0HMPMOHQCEDGR established using the following protocol: "Tls12"
2023-04-06 21:29:36.261 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:36.261 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:36.266 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:36.266 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:36.268 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:29:36.269 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:29:36.272 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:36.272 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:36.275 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:36.275 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:36.276 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:36.277 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:36.279 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:29:36.279 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:29:36.281 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 19.7161ms
2023-04-06 21:29:36.281 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 19.6574ms
2023-04-06 21:29:36.284 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:36.287 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:36.290 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:29:36.292 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:36.293 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:36.294 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:36.295 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:36.463 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:29:36.465 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:29:36.471 +04:00 [DBG] Authorization was successful.
2023-04-06 21:29:36.474 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:36.496 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:29:36.500 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:29:36.502 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:29:36.503 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:29:36.505 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:29:36.507 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:29:36.509 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:36.635 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:29:36.657 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:37.039 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:29:37.041 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:29:37.318 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:29:37.395 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-06 21:29:37.438 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:29:37.565 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:29:37.595 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:29:37.598 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:29:37.622 +04:00 [DBG] Created DbConnection. (21ms).
2023-04-06 21:29:37.629 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (34ms).
2023-04-06 21:29:37.639 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (45ms).
2023-04-06 21:29:37.643 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:37.815 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:37.825 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:37.870 +04:00 [INF] Executed DbCommand (47ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:37.895 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:37.926 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:37.935 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:37.946 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:37.952 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 75ms reading results.
2023-04-06 21:29:37.956 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:37.961 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-06 21:29:37.965 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:29:37.970 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:29:37.971 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:29:37.972 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:29:37.974 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:29:37.975 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:29:37.990 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:37.990 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 1479.637ms
2023-04-06 21:29:37.991 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:37.993 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:37.994 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:29:37.996 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:37.997 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:29:37.997 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:37.999 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:37.999 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:38.001 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.003 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:29:38.004 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-04-06 21:29:38.004 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:29:38.005 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 1721.1863ms
2023-04-06 21:29:38.007 +04:00 [DBG] Authorization was successful.
2023-04-06 21:29:38.008 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.009 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:29:38.011 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:29:38.012 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:29:38.013 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:29:38.015 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:29:38.016 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:29:38.018 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.020 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.029 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:29:38.035 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:29:38.036 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:29:38.036 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:29:38.037 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:29:38.038 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:29:38.039 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.041 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.042 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.046 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.051 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.053 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.054 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.055 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:29:38.057 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.058 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:29:38.059 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:29:38.061 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:29:38.062 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:29:38.063 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:29:38.064 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:29:38.065 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:29:38.066 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 48.1452ms
2023-04-06 21:29:38.068 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.069 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:29:38.070 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.071 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:29:38.073 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 82.8419ms
2023-04-06 21:29:38.295 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:38.296 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:38.296 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:29:38.298 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.299 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:38.300 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:38.301 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:38.304 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:29:38.304 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:29:38.306 +04:00 [DBG] Authorization was successful.
2023-04-06 21:29:38.307 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.308 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:29:38.310 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:29:38.311 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:29:38.312 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:29:38.313 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:29:38.315 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:29:38.316 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.320 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.363 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:29:38.366 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:29:38.367 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:29:38.368 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:29:38.369 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:29:38.370 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:29:38.371 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.372 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.373 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.376 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.378 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.380 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.381 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.383 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.384 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:29:38.385 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.386 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:29:38.388 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:29:38.390 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:29:38.391 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:29:38.392 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:29:38.392 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:29:38.393 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:29:38.395 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 78.9101ms
2023-04-06 21:29:38.396 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.396 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:29:38.397 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:29:38.398 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:29:38.399 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.400 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:29:38.401 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:29:38.403 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.404 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 109.4347ms
2023-04-06 21:29:38.405 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:29:38.406 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:29:38.407 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:29:38.408 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:29:38.408 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:29:38.409 +04:00 [DBG] Authorization was successful.
2023-04-06 21:29:38.410 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.411 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:29:38.412 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:29:38.414 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:29:38.415 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:29:38.416 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:29:38.418 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:29:38.419 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.420 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:29:38.422 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:29:38.425 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:29:38.426 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:29:38.426 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:29:38.427 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:29:38.428 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:29:38.429 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.430 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.431 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.434 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:29:38.437 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.438 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.439 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:29:38.440 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.442 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:29:38.443 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.444 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:29:38.445 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:29:38.447 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:29:38.447 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:29:38.448 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:29:38.449 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:29:38.450 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:29:38.452 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 32.4677ms
2023-04-06 21:29:38.453 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:29:38.454 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:29:38.455 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:29:38.456 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:29:38.458 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 61.1410ms
2023-04-06 21:29:46.234 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" received FIN.
2023-04-06 21:29:46.236 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" is closed. The last processed stream ID was 11.
2023-04-06 21:29:46.236 +04:00 [DBG] The connection queue processing loop for 0HMPMOHQCEDGR completed.
2023-04-06 21:29:46.238 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" sending FIN because: "The client closed the connection."
2023-04-06 21:29:46.247 +04:00 [DBG] Connection id "0HMPMOHQCEDGR" stopped.
2023-04-06 21:30:20.941 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" accepted.
2023-04-06 21:30:20.942 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" started.
2023-04-06 21:30:20.947 +04:00 [DBG] Connection 0HMPMOHQCEDGS established using the following protocol: "Tls12"
2023-04-06 21:30:20.949 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:30:20.949 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:30:20.952 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 2.5791ms
2023-04-06 21:30:20.960 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 10.7874ms
2023-04-06 21:30:21.014 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:30:21.015 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:30:21.017 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:30:21.022 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 7.5739ms
2023-04-06 21:30:21.269 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" received FIN.
2023-04-06 21:30:21.295 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" is closed. The last processed stream ID was 5.
2023-04-06 21:30:21.295 +04:00 [DBG] The connection queue processing loop for 0HMPMOHQCEDGS completed.
2023-04-06 21:30:21.296 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" sending FIN because: "The client closed the connection."
2023-04-06 21:30:21.303 +04:00 [DBG] Connection id "0HMPMOHQCEDGS" stopped.
2023-04-06 21:30:29.572 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" accepted.
2023-04-06 21:30:29.573 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" started.
2023-04-06 21:30:29.576 +04:00 [DBG] Connection 0HMPMOHQCEDGT established using the following protocol: "Tls12"
2023-04-06 21:30:29.578 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:30:29.578 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:30:29.579 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:30:29.581 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:30:29.581 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:30:29.582 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:30:29.583 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:30:29.584 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.4425ms
2023-04-06 21:30:29.586 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:30:29.587 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:30:29.588 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:30:29.589 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:30:29.590 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:30:29.591 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:30:29.592 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:30:29.593 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:30:29.593 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:30:29.595 +04:00 [DBG] Authorization was successful.
2023-04-06 21:30:29.595 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:30:29.604 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:30:29.606 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:30:29.607 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:30:29.608 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:30:29.610 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:30:29.611 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:30:29.612 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:30:29.614 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:30:29.625 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:30:29.628 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:30:29.631 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:30:29.640 +04:00 [DBG] Connection id "0HMPMOHQCEDGT", Request id "0HMPMOHQCEDGT:00000003": started reading request body.
2023-04-06 21:30:29.642 +04:00 [DBG] Connection id "0HMPMOHQCEDGT", Request id "0HMPMOHQCEDGT:00000003": done reading request body.
2023-04-06 21:30:29.647 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:30:29.648 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:30:29.650 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:30:29.652 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:30:29.669 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:30:29.676 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:30:29.679 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:30:29.685 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:30:29.690 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:30:29.691 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:30:29.691 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:30:29.692 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:30:29.693 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:30:29.694 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.695 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.696 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:30:29.702 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:30:29.707 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.723 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.725 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.726 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.727 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.728 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.729 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.730 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.732 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.733 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.735 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.737 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.738 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.739 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.740 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.742 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.743 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.745 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.746 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.747 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.748 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.750 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.752 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.753 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.756 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.757 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.758 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.760 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.761 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.763 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.764 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.765 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.768 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.769 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.770 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.771 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.773 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.774 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.775 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.776 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.780 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.782 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.784 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.786 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 80ms reading results.
2023-04-06 21:30:29.787 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.788 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:30:29.796 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:30:29.805 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:30:29.833 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:30:29.841 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:30:29.842 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:30:29.843 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:30:29.844 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.845 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.846 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:30:29.861 +04:00 [INF] Executed DbCommand (14ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:30:29.865 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.878 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.881 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:30:29.909 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.911 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 47ms reading results.
2023-04-06 21:30:29.913 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:29.914 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:30:29.917 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 305.1906ms
2023-04-06 21:30:29.919 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:30:29.926 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:30:30.000 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:30:30.002 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:30:30.003 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:30:30.005 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 418.7001ms
2023-04-06 21:30:31.273 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" received FIN.
2023-04-06 21:30:31.274 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" is closed. The last processed stream ID was 3.
2023-04-06 21:30:31.275 +04:00 [DBG] The connection queue processing loop for 0HMPMOHQCEDGT completed.
2023-04-06 21:30:31.276 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" sending FIN because: "The client closed the connection."
2023-04-06 21:30:31.290 +04:00 [DBG] Connection id "0HMPMOHQCEDGT" stopped.
2023-04-06 21:31:20.085 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:31:20.198 +04:00 [DBG] Hosting starting
2023-04-06 21:31:20.267 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:31:20.276 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:31:20.289 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:31:20.297 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:31:20.306 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:31:20.315 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:31:20.319 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:31:20.323 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:31:20.327 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:31:20.332 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:31:20.338 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:31:20.347 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:31:20.349 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:31:20.566 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:31:20.567 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:31:20.568 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:31:20.569 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:31:20.570 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:31:20.571 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:31:20.572 +04:00 [INF] Hosting environment: Development
2023-04-06 21:31:20.573 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:31:20.574 +04:00 [DBG] Hosting started
2023-04-06 21:31:20.955 +04:00 [DBG] Connection id "0HMPMOIUAC3NM" accepted.
2023-04-06 21:31:20.958 +04:00 [DBG] Connection id "0HMPMOIUAC3NM" started.
2023-04-06 21:31:20.959 +04:00 [DBG] Connection id "0HMPMOIUAC3NN" accepted.
2023-04-06 21:31:20.961 +04:00 [DBG] Connection id "0HMPMOIUAC3NN" started.
2023-04-06 21:31:20.979 +04:00 [DBG] Connection id "0HMPMOIUAC3NM" received FIN.
2023-04-06 21:31:20.979 +04:00 [DBG] Connection id "0HMPMOIUAC3NN" received FIN.
2023-04-06 21:31:20.999 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:31:20.999 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:31:21.058 +04:00 [DBG] Connection id "0HMPMOIUAC3NN" stopped.
2023-04-06 21:31:21.058 +04:00 [DBG] Connection id "0HMPMOIUAC3NM" stopped.
2023-04-06 21:31:21.063 +04:00 [DBG] Connection id "0HMPMOIUAC3NN" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:31:21.063 +04:00 [DBG] Connection id "0HMPMOIUAC3NM" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:31:22.195 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" accepted.
2023-04-06 21:31:22.198 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" started.
2023-04-06 21:31:22.305 +04:00 [DBG] Connection 0HMPMOIUAC3NO established using the following protocol: "Tls12"
2023-04-06 21:31:22.409 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:31:22.447 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:31:22.480 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:31:22.483 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:31:22.905 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:31:22.960 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:31:23.212 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 654.2885ms
2023-04-06 21:31:26.919 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" accepted.
2023-04-06 21:31:26.921 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" started.
2023-04-06 21:31:26.925 +04:00 [DBG] Connection 0HMPMOIUAC3NP established using the following protocol: "Tls12"
2023-04-06 21:31:26.928 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:31:26.928 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:31:26.950 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 22.1024ms
2023-04-06 21:31:26.977 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 48.4125ms
2023-04-06 21:31:27.041 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:31:27.042 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:31:27.043 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:31:27.204 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 162.6417ms
2023-04-06 21:31:29.748 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" accepted.
2023-04-06 21:31:29.750 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" started.
2023-04-06 21:31:29.756 +04:00 [DBG] Connection 0HMPMOIUAC3NQ established using the following protocol: "Tls12"
2023-04-06 21:31:29.758 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:31:29.763 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:29.765 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:31:29.768 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:29.771 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:29.772 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:29.773 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:31:29.775 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 16.9790ms
2023-04-06 21:31:29.777 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:31:29.780 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:29.784 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:29.785 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:29.786 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:29.787 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:29.787 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:30.046 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:31:30.048 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:31:30.057 +04:00 [DBG] Authorization was successful.
2023-04-06 21:31:30.061 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:30.096 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:31:30.101 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:31:30.102 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:31:30.104 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:31:30.106 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:31:30.107 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:31:30.109 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:31:30.396 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:31:30.441 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:31:30.462 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:31:30.467 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:31:30.470 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:31:30.486 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ", Request id "0HMPMOIUAC3NQ:00000003": started reading request body.
2023-04-06 21:31:30.489 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ", Request id "0HMPMOIUAC3NQ:00000003": done reading request body.
2023-04-06 21:31:30.496 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:31:30.498 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:30.500 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:30.501 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:31:30.517 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:31.108 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:31:31.111 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:31:31.342 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" received FIN.
2023-04-06 21:31:31.342 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" received FIN.
2023-04-06 21:31:31.345 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" sending FIN because: "The client closed the connection."
2023-04-06 21:31:31.345 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NP completed.
2023-04-06 21:31:31.348 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" is closed. The last processed stream ID was 1.
2023-04-06 21:31:31.348 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" is closed. The last processed stream ID was 5.
2023-04-06 21:31:31.349 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NO completed.
2023-04-06 21:31:31.350 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" sending FIN because: "The client closed the connection."
2023-04-06 21:31:31.352 +04:00 [DBG] Connection id "0HMPMOIUAC3NO" stopped.
2023-04-06 21:31:31.357 +04:00 [DBG] Connection id "0HMPMOIUAC3NP" stopped.
2023-04-06 21:31:31.517 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:31:31.581 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:31:31.705 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:31:31.737 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:31.740 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:31:31.774 +04:00 [DBG] Created DbConnection. (32ms).
2023-04-06 21:31:31.782 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (46ms).
2023-04-06 21:31:31.785 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (49ms).
2023-04-06 21:31:31.790 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.066 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.074 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:31:32.117 +04:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:31:32.149 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.184 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.187 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.188 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.190 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.191 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.193 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.195 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.196 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.197 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.198 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.199 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.200 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.201 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.203 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.204 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.205 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.206 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.207 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.209 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.210 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.211 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.212 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.213 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.214 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.215 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.217 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.218 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.219 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.220 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.221 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.223 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.225 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.226 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.228 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.229 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.230 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.231 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.233 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.234 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.235 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.240 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.242 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.247 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.253 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 128ms reading results.
2023-04-06 21:31:32.257 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.263 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-04-06 21:31:32.284 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:31:32.330 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:31:32.447 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:31:32.469 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:32.471 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:31:32.476 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-04-06 21:31:32.477 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.479 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.483 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:31:32.513 +04:00 [INF] Executed DbCommand (32ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:31:32.522 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.553 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.562 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:32.597 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.599 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 83ms reading results.
2023-04-06 21:31:32.602 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.603 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:31:32.727 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 2616.6647ms
2023-04-06 21:31:32.730 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:32.815 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:31:32.912 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:31:32.917 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:32.919 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:31:32.920 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 3143.1855ms
2023-04-06 21:31:41.349 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" received FIN.
2023-04-06 21:31:41.350 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" is closed. The last processed stream ID was 3.
2023-04-06 21:31:41.351 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NQ completed.
2023-04-06 21:31:41.352 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" sending FIN because: "The client closed the connection."
2023-04-06 21:31:41.367 +04:00 [DBG] Connection id "0HMPMOIUAC3NQ" stopped.
2023-04-06 21:31:48.813 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" accepted.
2023-04-06 21:31:48.814 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" started.
2023-04-06 21:31:48.818 +04:00 [DBG] Connection 0HMPMOIUAC3NR established using the following protocol: "Tls12"
2023-04-06 21:31:48.820 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:31:48.820 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:31:48.821 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.823 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.823 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:31:48.825 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:31:48.826 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:48.827 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:48.829 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:48.829 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:48.830 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:48.831 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:48.832 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:31:48.833 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:31:48.834 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.1353ms
2023-04-06 21:31:48.835 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 15.1169ms
2023-04-06 21:31:48.837 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:31:48.838 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.839 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.841 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:48.842 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:48.843 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:48.844 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:48.847 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:31:48.848 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:31:48.851 +04:00 [DBG] Authorization was successful.
2023-04-06 21:31:48.853 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:48.860 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:31:48.863 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:31:48.865 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:31:48.867 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:31:48.869 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:31:48.870 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:31:48.872 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:31:48.877 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:31:48.900 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:31:48.904 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-06 21:31:48.907 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:31:48.918 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:31:48.922 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:48.923 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:31:48.924 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:31:48.925 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:31:48.926 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:31:48.927 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:48.928 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:48.929 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:31:48.935 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:31:48.940 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:48.951 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:48.953 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:48.954 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:48.955 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 17ms reading results.
2023-04-06 21:31:48.957 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:48.958 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:31:48.962 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:31:48.967 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:31:48.968 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:31:48.968 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:31:48.970 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:31:48.972 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:31:48.986 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 114.6027ms
2023-04-06 21:31:48.988 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:31:48.989 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:48.989 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.990 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:31:48.991 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:31:48.992 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:48.994 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:48.995 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:31:48.996 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:48.997 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 160.4513ms
2023-04-06 21:31:48.998 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:49.000 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:49.004 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:31:49.005 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:31:49.007 +04:00 [DBG] Authorization was successful.
2023-04-06 21:31:49.009 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:49.010 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:31:49.013 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:31:49.014 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:31:49.016 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:31:49.018 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:31:49.019 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:31:49.021 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:31:49.023 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:31:49.082 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:31:49.087 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:49.088 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:31:49.089 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:31:49.090 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:31:49.091 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:31:49.093 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:49.094 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:49.095 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:31:49.099 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:31:49.102 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:49.103 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:49.105 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:49.106 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:49.107 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:31:49.109 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:49.110 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:31:49.112 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:31:49.114 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:31:49.115 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:31:49.116 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:31:49.117 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:31:49.118 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:31:49.119 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 98.6823ms
2023-04-06 21:31:49.120 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:31:49.122 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:31:49.123 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:49.125 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:31:49.126 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 138.2117ms
2023-04-06 21:31:51.369 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" received FIN.
2023-04-06 21:31:51.370 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" is closed. The last processed stream ID was 7.
2023-04-06 21:31:51.371 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NR completed.
2023-04-06 21:31:51.372 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" sending FIN because: "The client closed the connection."
2023-04-06 21:31:51.385 +04:00 [DBG] Connection id "0HMPMOIUAC3NR" stopped.
2023-04-06 21:31:57.168 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" accepted.
2023-04-06 21:31:57.170 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" started.
2023-04-06 21:31:57.172 +04:00 [DBG] Connection 0HMPMOIUAC3NS established using the following protocol: "Tls12"
2023-04-06 21:31:57.174 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:31:57.175 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:57.176 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:31:57.177 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:57.178 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:57.179 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:57.180 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:31:57.180 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.4925ms
2023-04-06 21:31:57.183 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:31:57.184 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:57.185 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:31:57.187 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:57.188 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:31:57.188 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:31:57.189 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:31:57.190 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:31:57.191 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:31:57.192 +04:00 [DBG] Authorization was successful.
2023-04-06 21:31:57.193 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:57.194 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:31:57.196 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:31:57.197 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:31:57.199 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:31:57.201 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:31:57.202 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:31:57.204 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:31:57.206 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:31:57.207 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:31:57.209 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:31:57.210 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:31:57.212 +04:00 [DBG] Connection id "0HMPMOIUAC3NS", Request id "0HMPMOIUAC3NS:00000003": started reading request body.
2023-04-06 21:31:57.214 +04:00 [DBG] Connection id "0HMPMOIUAC3NS", Request id "0HMPMOIUAC3NS:00000003": done reading request body.
2023-04-06 21:31:57.215 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:31:57.217 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:57.218 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:57.219 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:31:57.221 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:31:57.224 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:31:57.226 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:57.227 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:31:57.228 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:31:57.229 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:31:57.230 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:31:57.232 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.234 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.235 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:31:57.239 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:31:57.241 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.243 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.244 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.245 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.246 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.248 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.250 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.252 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.253 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.254 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.256 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.258 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.259 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.261 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.263 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.264 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.266 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.268 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.269 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.271 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.272 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.274 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.275 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.277 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.279 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.280 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.282 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.284 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.286 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.287 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.288 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.289 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.291 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.292 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.294 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.296 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.297 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.298 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.300 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.301 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.303 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.304 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.305 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.307 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.308 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 67ms reading results.
2023-04-06 21:31:57.310 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.311 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:31:57.313 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:31:57.314 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:31:57.316 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:31:57.317 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.318 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.319 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:31:57.326 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:31:57.329 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.330 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.332 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:31:57.334 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.335 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:31:57.336 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.337 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:31:57.417 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 213.0577ms
2023-04-06 21:31:57.419 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:31:57.470 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:31:57.479 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:31:57.480 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:31:57.484 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-04-06 21:31:57.485 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 301.8604ms
2023-04-06 21:32:01.383 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" received FIN.
2023-04-06 21:32:01.384 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" is closed. The last processed stream ID was 3.
2023-04-06 21:32:01.385 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NS completed.
2023-04-06 21:32:01.386 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" sending FIN because: "The client closed the connection."
2023-04-06 21:32:01.399 +04:00 [DBG] Connection id "0HMPMOIUAC3NS" stopped.
2023-04-06 21:32:19.500 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" accepted.
2023-04-06 21:32:19.501 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" started.
2023-04-06 21:32:19.503 +04:00 [DBG] Connection 0HMPMOIUAC3NT established using the following protocol: "Tls12"
2023-04-06 21:32:19.505 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:32:19.510 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:32:19.511 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:32:19.512 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:32:19.512 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:32:19.513 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:32:19.514 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:32:19.515 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 9.9886ms
2023-04-06 21:32:19.516 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:32:19.517 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:32:19.518 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:32:19.519 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:32:19.520 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:32:19.522 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:32:19.523 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:32:19.524 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:32:19.524 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:32:19.525 +04:00 [DBG] Authorization was successful.
2023-04-06 21:32:19.525 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:32:19.526 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:32:19.528 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:32:19.529 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:32:19.529 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:32:19.532 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:32:19.533 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:32:19.534 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:32:19.537 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:32:19.538 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:32:19.539 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:32:19.540 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:32:19.541 +04:00 [DBG] Connection id "0HMPMOIUAC3NT", Request id "0HMPMOIUAC3NT:00000003": started reading request body.
2023-04-06 21:32:19.543 +04:00 [DBG] Connection id "0HMPMOIUAC3NT", Request id "0HMPMOIUAC3NT:00000003": done reading request body.
2023-04-06 21:32:19.544 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:32:19.544 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:32:19.545 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:32:19.546 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:32:19.547 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:32:19.549 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:32:19.551 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:32:19.552 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:32:19.553 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:32:19.554 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:32:19.556 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:32:19.557 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.558 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.559 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:32:19.563 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:32:19.566 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.567 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.570 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.572 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.573 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.574 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.575 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.577 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.578 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.579 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.581 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.583 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.584 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.586 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.587 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.589 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.591 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.593 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.595 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.596 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.597 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.598 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.600 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.602 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.603 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.604 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.606 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.607 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.608 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.610 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.611 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.612 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.613 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.615 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.617 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.619 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.620 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.621 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.623 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.624 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.626 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.627 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.629 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.630 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.632 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 66ms reading results.
2023-04-06 21:32:19.634 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.635 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:32:19.637 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:32:19.638 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:32:19.639 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:32:19.640 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.641 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.642 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:32:19.651 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:32:19.653 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.655 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.656 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:32:19.658 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.659 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:32:19.661 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:32:19.662 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:33:00.864 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 41330.1085ms
2023-04-06 21:33:00.866 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:00.909 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:33:00.919 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:33:00.925 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:00.926 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:33:00.927 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 41410.9333ms
2023-04-06 21:33:02.711 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" accepted.
2023-04-06 21:33:02.712 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" started.
2023-04-06 21:33:02.714 +04:00 [DBG] Connection 0HMPMOIUAC3NU established using the following protocol: "Tls12"
2023-04-06 21:33:02.716 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:33:02.721 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:02.722 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:33:02.723 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:02.724 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:02.725 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:02.725 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:33:02.726 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 9.7208ms
2023-04-06 21:33:02.727 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:33:02.728 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:02.729 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:02.731 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:02.732 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:02.733 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:02.733 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:02.734 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:33:02.735 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:33:02.736 +04:00 [DBG] Authorization was successful.
2023-04-06 21:33:02.736 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:02.738 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:33:02.739 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:33:02.741 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:33:02.742 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:33:02.744 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:33:02.745 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:33:02.746 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:02.748 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:02.749 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:02.750 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:33:02.752 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:33:02.753 +04:00 [DBG] Connection id "0HMPMOIUAC3NU", Request id "0HMPMOIUAC3NU:00000003": started reading request body.
2023-04-06 21:33:02.754 +04:00 [DBG] Connection id "0HMPMOIUAC3NU", Request id "0HMPMOIUAC3NU:00000003": done reading request body.
2023-04-06 21:33:02.756 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:33:02.757 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:02.759 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:02.760 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:02.762 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:02.765 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:33:02.767 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:02.769 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:33:02.770 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:33:02.771 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:33:02.772 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-06 21:33:02.774 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.775 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.777 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:02.780 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:02.782 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.783 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.784 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.785 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.786 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.787 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.788 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.790 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.791 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.795 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.796 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.797 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.799 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.800 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.802 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.803 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.804 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.805 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.806 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.807 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.808 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.809 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.810 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.813 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.814 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.815 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.817 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.818 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.820 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.822 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.824 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.826 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.827 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.828 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.830 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.831 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.833 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.835 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.836 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.836 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 54ms reading results.
2023-04-06 21:33:02.838 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.839 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:33:02.841 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:02.842 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:33:02.843 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:33:02.844 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.845 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.846 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:02.854 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:02.859 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.860 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.862 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:02.864 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.866 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-04-06 21:33:02.867 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:02.868 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:33:05.022 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 2276.1412ms
2023-04-06 21:33:05.025 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:05.075 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:33:05.084 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:33:05.085 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:05.086 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:33:05.089 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 2361.3534ms
2023-04-06 21:33:06.458 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" received FIN.
2023-04-06 21:33:06.458 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" received FIN.
2023-04-06 21:33:06.459 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" is closed. The last processed stream ID was 3.
2023-04-06 21:33:06.460 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" is closed. The last processed stream ID was 3.
2023-04-06 21:33:06.461 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NU completed.
2023-04-06 21:33:06.460 +04:00 [DBG] The connection queue processing loop for 0HMPMOIUAC3NT completed.
2023-04-06 21:33:06.467 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" sending FIN because: "The client closed the connection."
2023-04-06 21:33:06.468 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" sending FIN because: "The client closed the connection."
2023-04-06 21:33:06.473 +04:00 [DBG] Connection id "0HMPMOIUAC3NU" stopped.
2023-04-06 21:33:06.473 +04:00 [DBG] Connection id "0HMPMOIUAC3NT" stopped.
2023-04-06 21:33:10.727 +04:00 [DBG] Connection id "0HMPMOIUAC3NV" accepted.
2023-04-06 21:33:10.728 +04:00 [DBG] Connection id "0HMPMOIUAC3NV" started.
2023-04-06 21:33:10.730 +04:00 [DBG] Connection 0HMPMOIUAC3NV established using the following protocol: "Tls12"
2023-04-06 21:33:10.733 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:33:10.734 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:10.735 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:33:10.736 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:10.737 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:10.738 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:10.739 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:33:10.740 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 7.1637ms
2023-04-06 21:33:10.742 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:33:10.743 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:10.743 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:10.745 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:10.746 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:10.746 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:10.747 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:10.748 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:33:10.749 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:33:10.750 +04:00 [DBG] Authorization was successful.
2023-04-06 21:33:10.751 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:10.752 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:33:10.754 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:33:10.755 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:33:10.756 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:33:10.758 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:33:10.759 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:33:10.760 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:10.761 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:10.763 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:10.764 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:33:10.766 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:33:10.767 +04:00 [DBG] Connection id "0HMPMOIUAC3NV", Request id "0HMPMOIUAC3NV:00000003": started reading request body.
2023-04-06 21:33:10.768 +04:00 [DBG] Connection id "0HMPMOIUAC3NV", Request id "0HMPMOIUAC3NV:00000003": done reading request body.
2023-04-06 21:33:10.769 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:33:10.770 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:10.771 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:10.772 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:10.774 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:10.775 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:33:10.777 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:10.778 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:33:10.778 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:33:10.779 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:33:10.781 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:33:10.782 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.783 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.784 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:10.787 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:10.789 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.791 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.793 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.796 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.798 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.799 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.800 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.801 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.803 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.804 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.805 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.806 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.807 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.808 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.809 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.810 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.813 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.815 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.816 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.817 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.818 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.820 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.821 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.823 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.824 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.826 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.827 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.829 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.830 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.831 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.833 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.835 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.836 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.837 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.838 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.839 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.841 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.842 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.844 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 54ms reading results.
2023-04-06 21:33:10.845 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.846 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:33:10.848 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:10.849 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:33:10.850 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:33:10.851 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.852 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.853 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:10.860 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:10.863 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.865 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.866 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:10.867 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.868 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:33:10.870 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:10.871 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:33:10.950 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 190.127ms
2023-04-06 21:33:10.952 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:11.009 +04:00 [ERR] Not enough money on account
BankSystem.Atm.Exceptions.NotEnoughMoneyOnAccountException: Not enough money on account
   at BankSystem.Atm.Services.CashoutService.ValidateCashOutAsync(AccountEntity account, Decimal totalPayment) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 74
   at BankSystem.Atm.Services.CashoutService.PerformCashOutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Services\CashoutService.cs:line 105
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-06 21:33:11.019 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:33:11.020 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:11.022 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:33:11.023 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 2 - application/json 281.7405ms
2023-04-06 21:33:21.054 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:33:21.156 +04:00 [DBG] Hosting starting
2023-04-06 21:33:21.208 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:33:21.214 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:33:21.223 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:33:21.228 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:33:21.233 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:33:21.238 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:33:21.241 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:33:21.244 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:33:21.246 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:33:21.250 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:33:21.255 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:33:21.260 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:33:21.261 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:33:21.460 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:33:21.462 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:33:21.492 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:33:21.494 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:33:21.494 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:33:21.496 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:33:21.496 +04:00 [INF] Hosting environment: Development
2023-04-06 21:33:21.498 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:33:21.499 +04:00 [DBG] Hosting started
2023-04-06 21:33:21.501 +04:00 [DBG] Connection id "0HMPMOK27VR8V" accepted.
2023-04-06 21:33:21.503 +04:00 [DBG] Connection id "0HMPMOK27VR8V" started.
2023-04-06 21:33:21.511 +04:00 [DBG] Connection id "0HMPMOK27VR8V" received FIN.
2023-04-06 21:33:21.518 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:33:21.566 +04:00 [DBG] Connection id "0HMPMOK27VR8V" stopped.
2023-04-06 21:33:21.569 +04:00 [DBG] Connection id "0HMPMOK27VR8V" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:33:21.992 +04:00 [DBG] Connection id "0HMPMOK27VR90" accepted.
2023-04-06 21:33:21.995 +04:00 [DBG] Connection id "0HMPMOK27VR90" started.
2023-04-06 21:33:22.066 +04:00 [DBG] Connection 0HMPMOK27VR90 established using the following protocol: "Tls12"
2023-04-06 21:33:22.157 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:33:22.193 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:33:22.219 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:33:22.220 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:33:22.389 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:33:22.413 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:33:22.417 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 262.8318ms
2023-04-06 21:33:22.435 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:33:22.443 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 6.9070ms
2023-04-06 21:33:22.459 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:33:22.504 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 45.5214ms
2023-04-06 21:33:22.602 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:33:22.603 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:33:22.605 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:33:22.751 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 149.5647ms
2023-04-06 21:33:25.829 +04:00 [DBG] Connection id "0HMPMOK27VR91" accepted.
2023-04-06 21:33:25.830 +04:00 [DBG] Connection id "0HMPMOK27VR91" started.
2023-04-06 21:33:25.838 +04:00 [DBG] Connection 0HMPMOK27VR91 established using the following protocol: "Tls12"
2023-04-06 21:33:25.841 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:33:25.848 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:25.849 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:33:25.852 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:25.855 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:25.856 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:25.858 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:33:25.859 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 18.7000ms
2023-04-06 21:33:25.861 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:33:25.863 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:25.866 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:33:25.868 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:25.869 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:33:25.870 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:33:25.871 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:33:26.078 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:33:26.082 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:33:26.090 +04:00 [DBG] Authorization was successful.
2023-04-06 21:33:26.094 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:33:26.116 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:33:26.121 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:33:26.123 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:33:26.125 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:33:26.126 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:33:26.128 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:33:26.131 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:26.283 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:33:26.306 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:33:26.320 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:26.325 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:33:26.329 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:33:26.340 +04:00 [DBG] Connection id "0HMPMOK27VR91", Request id "0HMPMOK27VR91:00000003": started reading request body.
2023-04-06 21:33:26.342 +04:00 [DBG] Connection id "0HMPMOK27VR91", Request id "0HMPMOK27VR91:00000003": done reading request body.
2023-04-06 21:33:26.348 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:33:26.349 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:26.351 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:26.352 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:33:26.364 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:33:26.798 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:33:26.800 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:33:27.175 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:33:27.212 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:33:27.339 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:33:27.375 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:27.380 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:33:27.412 +04:00 [DBG] Created DbConnection. (30ms).
2023-04-06 21:33:27.420 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (44ms).
2023-04-06 21:33:27.424 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (51ms).
2023-04-06 21:33:27.429 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.635 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.643 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:27.677 +04:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:33:27.704 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.740 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.742 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.744 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.745 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.746 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.747 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.748 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.750 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.751 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.753 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.755 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.757 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.758 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.759 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.760 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.761 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.763 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.764 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.765 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.766 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.767 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.768 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.770 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.772 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.773 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.774 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.776 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.777 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.778 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.779 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.780 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.782 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.783 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.784 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.786 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.788 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.789 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.790 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.797 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.798 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:27.803 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.809 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 126ms reading results.
2023-04-06 21:33:27.813 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.818 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-06 21:33:27.839 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:33:27.879 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:33:27.952 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:33:27.968 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:33:27.969 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:33:27.974 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-06 21:33:27.975 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.977 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:27.981 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:28.007 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:33:28.017 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:28.050 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:28.058 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:33:28.100 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:28.103 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 92ms reading results.
2023-04-06 21:33:28.105 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:33:28.106 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:33:52.255 +04:00 [DBG] Connection id "0HMPMOK27VR90" received FIN.
2023-04-06 21:34:50.827 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:34:50.992 +04:00 [DBG] Hosting starting
2023-04-06 21:34:51.039 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:34:51.047 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:34:51.053 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:34:51.058 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:34:51.063 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:34:51.069 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:34:51.073 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:34:51.076 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:34:51.078 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:34:51.084 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:34:51.089 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:34:51.094 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:34:51.096 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:34:51.305 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:34:51.306 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:34:51.307 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:34:51.308 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:34:51.308 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:34:51.310 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:34:51.310 +04:00 [INF] Hosting environment: Development
2023-04-06 21:34:51.311 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:34:51.312 +04:00 [DBG] Hosting started
2023-04-06 21:34:51.450 +04:00 [DBG] Connection id "0HMPMOKT1QB7P" accepted.
2023-04-06 21:34:51.453 +04:00 [DBG] Connection id "0HMPMOKT1QB7P" started.
2023-04-06 21:34:51.465 +04:00 [DBG] Connection id "0HMPMOKT1QB7P" received FIN.
2023-04-06 21:34:51.472 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:34:51.514 +04:00 [DBG] Connection id "0HMPMOKT1QB7P" stopped.
2023-04-06 21:34:51.517 +04:00 [DBG] Connection id "0HMPMOKT1QB7P" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:34:51.816 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" accepted.
2023-04-06 21:34:51.819 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" started.
2023-04-06 21:34:51.879 +04:00 [DBG] Connection 0HMPMOKT1QB7Q established using the following protocol: "Tls12"
2023-04-06 21:34:51.957 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:34:51.985 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:34:52.010 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:34:52.012 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:34:52.197 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:34:52.220 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:34:52.224 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 269.1569ms
2023-04-06 21:34:52.241 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:34:52.249 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 7.0283ms
2023-04-06 21:34:52.268 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:34:52.321 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 52.6437ms
2023-04-06 21:34:52.429 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:34:52.431 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:34:52.432 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:34:52.562 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 132.1549ms
2023-04-06 21:34:56.630 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" received FIN.
2023-04-06 21:34:56.634 +04:00 [DBG] The connection queue processing loop for 0HMPMOKT1QB7Q completed.
2023-04-06 21:34:56.636 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" is closed. The last processed stream ID was 7.
2023-04-06 21:34:56.638 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" sending FIN because: "The client closed the connection."
2023-04-06 21:34:56.647 +04:00 [DBG] Connection id "0HMPMOKT1QB7Q" stopped.
2023-04-06 21:34:59.027 +04:00 [DBG] Connection id "0HMPMOKT1QB7R" accepted.
2023-04-06 21:34:59.028 +04:00 [DBG] Connection id "0HMPMOKT1QB7R" started.
2023-04-06 21:34:59.035 +04:00 [DBG] Connection 0HMPMOKT1QB7R established using the following protocol: "Tls12"
2023-04-06 21:34:59.038 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:34:59.043 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:34:59.045 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:34:59.048 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:34:59.051 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:34:59.053 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:34:59.054 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:34:59.056 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 18.1246ms
2023-04-06 21:34:59.058 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:34:59.060 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:34:59.063 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:34:59.065 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:34:59.066 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:34:59.067 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:34:59.068 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:34:59.330 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:34:59.333 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:34:59.342 +04:00 [DBG] Authorization was successful.
2023-04-06 21:34:59.345 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:34:59.372 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:34:59.375 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:34:59.376 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:34:59.378 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:34:59.380 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:34:59.382 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:34:59.384 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:34:59.551 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:34:59.579 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:34:59.597 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:34:59.600 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:34:59.603 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:34:59.612 +04:00 [DBG] Connection id "0HMPMOKT1QB7R", Request id "0HMPMOKT1QB7R:00000003": started reading request body.
2023-04-06 21:34:59.614 +04:00 [DBG] Connection id "0HMPMOKT1QB7R", Request id "0HMPMOKT1QB7R:00000003": done reading request body.
2023-04-06 21:34:59.619 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:34:59.621 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:34:59.622 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:34:59.624 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:34:59.640 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:35:00.148 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:35:00.150 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:35:00.516 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:35:00.586 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:35:00.709 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:35:00.740 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:35:00.742 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:35:00.775 +04:00 [DBG] Created DbConnection. (30ms).
2023-04-06 21:35:00.783 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (44ms).
2023-04-06 21:35:00.785 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (48ms).
2023-04-06 21:35:00.791 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.054 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.062 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:35:01.106 +04:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:35:01.135 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.165 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.167 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.168 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.170 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.171 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.173 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.174 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.176 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.177 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.179 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.181 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.182 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.184 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.185 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.186 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.188 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.189 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.191 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.192 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.194 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.196 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.198 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.199 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.200 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.202 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.203 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.205 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.206 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.208 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.210 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.212 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.213 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.215 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.216 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.218 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.219 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.221 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.223 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.224 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.226 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.231 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.233 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.239 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.247 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 133ms reading results.
2023-04-06 21:35:01.251 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.258 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-04-06 21:35:01.282 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:35:01.336 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:35:01.449 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:35:01.474 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:35:01.475 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:35:01.479 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-06 21:35:01.481 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.483 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.487 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:35:01.517 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:35:01.528 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.556 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.562 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:35:01.594 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.597 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 76ms reading results.
2023-04-06 21:35:01.598 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:35:01.600 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:35:58.809 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:35:58.972 +04:00 [DBG] Hosting starting
2023-04-06 21:35:59.054 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:35:59.066 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:35:59.080 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:35:59.098 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:35:59.107 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:35:59.124 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:35:59.134 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:35:59.139 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:35:59.145 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:35:59.152 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:35:59.163 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:35:59.172 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:35:59.175 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:35:59.370 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:35:59.371 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:35:59.373 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:35:59.374 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:35:59.375 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:35:59.376 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:35:59.376 +04:00 [INF] Hosting environment: Development
2023-04-06 21:35:59.377 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:35:59.378 +04:00 [DBG] Hosting started
2023-04-06 21:35:59.394 +04:00 [DBG] Connection id "0HMPMOLH9P2U0" received FIN.
2023-04-06 21:35:59.400 +04:00 [DBG] Connection id "0HMPMOLH9P2U0" accepted.
2023-04-06 21:35:59.402 +04:00 [DBG] Connection id "0HMPMOLH9P2U0" started.
2023-04-06 21:35:59.418 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:35:59.462 +04:00 [DBG] Connection id "0HMPMOLH9P2U0" stopped.
2023-04-06 21:35:59.465 +04:00 [DBG] Connection id "0HMPMOLH9P2U0" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:35:59.971 +04:00 [DBG] Connection id "0HMPMOLH9P2U1" accepted.
2023-04-06 21:35:59.975 +04:00 [DBG] Connection id "0HMPMOLH9P2U1" started.
2023-04-06 21:36:00.052 +04:00 [DBG] Connection 0HMPMOLH9P2U1 established using the following protocol: "Tls12"
2023-04-06 21:36:00.131 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:36:00.153 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:36:00.175 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:36:00.178 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:36:00.365 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:36:00.386 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:36:00.390 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 260.5492ms
2023-04-06 21:36:00.412 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:36:00.419 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 6.5754ms
2023-04-06 21:36:00.436 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:36:00.478 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 41.4019ms
2023-04-06 21:36:00.575 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:36:00.576 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:36:00.577 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:36:00.750 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 175.4412ms
2023-04-06 21:36:02.457 +04:00 [DBG] Connection id "0HMPMOLH9P2U2" accepted.
2023-04-06 21:36:02.458 +04:00 [DBG] Connection id "0HMPMOLH9P2U2" started.
2023-04-06 21:36:02.465 +04:00 [DBG] Connection 0HMPMOLH9P2U2 established using the following protocol: "Tls12"
2023-04-06 21:36:02.468 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:36:02.473 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:02.474 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:36:02.476 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:02.479 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:02.480 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:02.482 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:36:02.483 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 15.7028ms
2023-04-06 21:36:02.485 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:36:02.487 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:02.490 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:02.492 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:36:02.493 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:02.495 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:02.496 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:02.733 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:36:02.736 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:36:02.743 +04:00 [DBG] Authorization was successful.
2023-04-06 21:36:02.747 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:36:02.772 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:36:02.776 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:36:02.778 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:36:02.780 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:36:02.781 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:36:02.783 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:36:02.786 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:36:02.983 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:36:03.014 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:36:03.029 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:36:03.033 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:36:03.037 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:36:03.055 +04:00 [DBG] Connection id "0HMPMOLH9P2U2", Request id "0HMPMOLH9P2U2:00000003": started reading request body.
2023-04-06 21:36:03.057 +04:00 [DBG] Connection id "0HMPMOLH9P2U2", Request id "0HMPMOLH9P2U2:00000003": done reading request body.
2023-04-06 21:36:03.067 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:36:03.069 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:03.071 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:03.072 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:36:03.083 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:03.491 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:36:03.493 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:36:03.817 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:36:03.877 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:36:04.015 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:36:04.045 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:04.048 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:36:04.087 +04:00 [DBG] Created DbConnection. (37ms).
2023-04-06 21:36:04.098 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (52ms).
2023-04-06 21:36:04.101 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (57ms).
2023-04-06 21:36:04.105 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.350 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.358 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:36:04.399 +04:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:36:04.427 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.456 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.458 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.460 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.461 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.462 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.463 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.465 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.466 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.467 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.468 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.470 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.472 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.474 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.476 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.477 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.479 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.480 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.481 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.483 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.484 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.485 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.486 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.487 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.489 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.490 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.491 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.493 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.494 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.495 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.496 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.497 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.498 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.499 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.500 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.502 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.504 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.505 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.506 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.508 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.509 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.513 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.514 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.519 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.525 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 119ms reading results.
2023-04-06 21:36:04.530 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.535 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-04-06 21:36:04.555 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:36:04.597 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:36:04.671 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:36:04.688 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:04.690 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:36:04.694 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-04-06 21:36:04.695 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.697 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.700 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:36:04.728 +04:00 [INF] Executed DbCommand (30ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:36:04.737 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.766 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.772 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:04.801 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.805 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 74ms reading results.
2023-04-06 21:36:04.806 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:04.807 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:36:49.196 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-06 21:36:49.305 +04:00 [DBG] Hosting starting
2023-04-06 21:36:49.335 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-06 21:36:49.341 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-06 21:36:49.347 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-06 21:36:49.353 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-06 21:36:49.357 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-06 21:36:49.364 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-06 21:36:49.367 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:36:49.370 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-06 21:36:49.372 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-06 21:36:49.376 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-06 21:36:49.382 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-06 21:36:49.386 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-06 21:36:49.388 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-06 21:36:49.527 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-06 21:36:49.529 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-06 21:36:49.530 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-06 21:36:49.531 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-06 21:36:49.532 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-06 21:36:49.533 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-06 21:36:49.534 +04:00 [INF] Hosting environment: Development
2023-04-06 21:36:49.535 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-06 21:36:49.536 +04:00 [DBG] Hosting started
2023-04-06 21:36:49.700 +04:00 [DBG] Connection id "0HMPMOM09HCAO" received FIN.
2023-04-06 21:36:49.700 +04:00 [DBG] Connection id "0HMPMOM09HCAP" received FIN.
2023-04-06 21:36:49.706 +04:00 [DBG] Connection id "0HMPMOM09HCAP" accepted.
2023-04-06 21:36:49.706 +04:00 [DBG] Connection id "0HMPMOM09HCAO" accepted.
2023-04-06 21:36:49.708 +04:00 [DBG] Connection id "0HMPMOM09HCAP" started.
2023-04-06 21:36:49.708 +04:00 [DBG] Connection id "0HMPMOM09HCAO" started.
2023-04-06 21:36:49.720 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:36:49.720 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-06 21:36:49.747 +04:00 [DBG] Connection id "0HMPMOM09HCAP" stopped.
2023-04-06 21:36:49.747 +04:00 [DBG] Connection id "0HMPMOM09HCAO" stopped.
2023-04-06 21:36:49.750 +04:00 [DBG] Connection id "0HMPMOM09HCAP" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:36:49.750 +04:00 [DBG] Connection id "0HMPMOM09HCAO" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-06 21:36:51.271 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" accepted.
2023-04-06 21:36:51.272 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" started.
2023-04-06 21:36:51.311 +04:00 [DBG] Connection 0HMPMOM09HCAQ established using the following protocol: "Tls12"
2023-04-06 21:36:51.367 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-06 21:36:51.384 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-06 21:36:51.410 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-06 21:36:51.412 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:36:51.570 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-06 21:36:51.582 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-06 21:36:51.585 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 219.5524ms
2023-04-06 21:36:51.640 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-06 21:36:51.647 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 5.9386ms
2023-04-06 21:36:51.662 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-06 21:36:51.684 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 21.7685ms
2023-04-06 21:36:51.806 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-06 21:36:51.808 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-06 21:36:51.809 +04:00 [DBG] Request did not match any endpoints
2023-04-06 21:36:51.921 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 114.1860ms
2023-04-06 21:36:53.487 +04:00 [DBG] Connection id "0HMPMOM09HCAR" accepted.
2023-04-06 21:36:53.488 +04:00 [DBG] Connection id "0HMPMOM09HCAR" started.
2023-04-06 21:36:53.495 +04:00 [DBG] Connection 0HMPMOM09HCAR established using the following protocol: "Tls12"
2023-04-06 21:36:53.498 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:36:53.502 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:53.503 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:36:53.505 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:53.507 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:53.508 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:53.509 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:36:53.511 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 13.2247ms
2023-04-06 21:36:53.513 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:36:53.514 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:53.517 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:36:53.518 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:36:53.519 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:53.520 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:53.521 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:53.627 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:36:53.629 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:36:53.635 +04:00 [DBG] Authorization was successful.
2023-04-06 21:36:53.638 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:36:53.654 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:36:53.659 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:36:53.660 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:36:53.662 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:36:53.665 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:36:53.666 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:36:53.668 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:36:53.739 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-06 21:36:53.757 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:36:53.764 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:36:53.767 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:36:53.769 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:36:53.778 +04:00 [DBG] Connection id "0HMPMOM09HCAR", Request id "0HMPMOM09HCAR:00000003": started reading request body.
2023-04-06 21:36:53.780 +04:00 [DBG] Connection id "0HMPMOM09HCAR", Request id "0HMPMOM09HCAR:00000003": done reading request body.
2023-04-06 21:36:53.784 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:36:53.786 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:53.787 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:53.788 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:36:53.797 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:36:54.104 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-06 21:36:54.106 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-06 21:36:54.373 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:36:54.392 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" received FIN.
2023-04-06 21:36:54.414 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-06 21:36:54.423 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAQ completed.
2023-04-06 21:36:54.427 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" is closed. The last processed stream ID was 7.
2023-04-06 21:36:54.428 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" sending FIN because: "The client closed the connection."
2023-04-06 21:36:54.436 +04:00 [DBG] Connection id "0HMPMOM09HCAQ" stopped.
2023-04-06 21:36:54.518 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:36:54.541 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:54.544 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:36:54.561 +04:00 [DBG] Created DbConnection. (14ms).
2023-04-06 21:36:54.567 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (25ms).
2023-04-06 21:36:54.570 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (29ms).
2023-04-06 21:36:54.575 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.697 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.704 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:36:54.731 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:36:54.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.782 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.784 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.785 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.787 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.788 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.789 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.791 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.795 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.797 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.798 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.799 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.800 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.801 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.803 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.804 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.805 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.806 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.807 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.809 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.810 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.813 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.815 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.816 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.817 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.818 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.820 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.822 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.824 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.826 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.828 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.829 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.830 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.832 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.833 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.837 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.839 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:54.843 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.848 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 111ms reading results.
2023-04-06 21:36:54.852 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.856 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-06 21:36:54.871 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .FirstOrDefault(a => a.Cards
        .Any(c => c.Id == __cardId_0))'
2023-04-06 21:36:54.906 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-04-06 21:36:54.968 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE EXISTS (
                SELECT 1
                FROM Cards AS c
                WHERE ((a.Id != NULL) && (a.Id == c.AccountId)) && (c.Id == @__cardId_0))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:36:54.982 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:54.983 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:36:54.986 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:36:54.987 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.989 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:54.993 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:36:55.011 +04:00 [INF] Executed DbCommand (20ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:36:55.020 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.049 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.055 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.095 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.097 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 83ms reading results.
2023-04-06 21:36:55.099 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.100 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:36:55.108 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt.Date == DateTime.Now.Date && (int)t.TransactionType == 0)'
2023-04-06 21:36:55.121 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromIban (string), 1], [Property: TransactionEntity.AccountFromId (Guid?), 2], [Property: TransactionEntity.AccountToIban (string), 3], [Property: TransactionEntity.AccountToId (Guid?), 4], [Property: TransactionEntity.CreatedAt (DateTime) Required, 5], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 6], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 7], [Property: TransactionEntity.Fee (decimal) Required, 8], [Property: TransactionEntity.ReceivedAmount (decimal) Required, 9], [Property: TransactionEntity.TransactionType (TransactionType) Required, 10], [Property: TransactionEntity.WithDrawnAmount (decimal) Required, 11] }
        SELECT t.Id, t.AccountFromIban, t.AccountFromId, t.AccountToIban, t.AccountToId, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.ReceivedAmount, t.TransactionType, t.WithDrawnAmount
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (CONVERT(date, t.CreatedAt) == CONVERT(date, GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-06 21:36:55.128 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:55.129 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:36:55.131 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:36:55.132 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.133 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.134 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:36:55.142 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:36:55.148 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.167 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.168 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.170 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.171 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.172 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 27ms reading results.
2023-04-06 21:36:55.173 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.174 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:36:55.186 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.203 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.218 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.223 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:36:55.226 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:36:55.262 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:36:55.310 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:36:55.314 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.315 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.317 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:36:55.324 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:36:55.326 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:55.328 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:36:55.332 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-06 21:36:55.334 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:36:55.362 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:36:55.368 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.370 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:36:55.374 +04:00 [DBG] Committing transaction.
2023-04-06 21:36:55.379 +04:00 [DBG] Committed transaction.
2023-04-06 21:36:55.381 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.382 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:36:55.385 +04:00 [DBG] Disposing transaction.
2023-04-06 21:36:55.388 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.392 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.395 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:55.399 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:36:55.406 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:36:55.409 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:36:55.410 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:36:55.412 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:36:55.414 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:36:55.416 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:36:55.436 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 1766.206ms
2023-04-06 21:36:55.437 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:36:55.440 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:36:55.446 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:55.448 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:36:55.450 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 1937.0743ms
2023-04-06 21:36:56.801 +04:00 [DBG] Connection id "0HMPMOM09HCAR" received FIN.
2023-04-06 21:36:56.804 +04:00 [DBG] Connection id "0HMPMOM09HCAR" is closed. The last processed stream ID was 3.
2023-04-06 21:36:56.804 +04:00 [DBG] Connection id "0HMPMOM09HCAR" sending FIN because: "The client closed the connection."
2023-04-06 21:36:56.807 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAR completed.
2023-04-06 21:36:56.808 +04:00 [DBG] Connection id "0HMPMOM09HCAR" stopped.
2023-04-06 21:36:58.475 +04:00 [DBG] Connection id "0HMPMOM09HCAS" accepted.
2023-04-06 21:36:58.477 +04:00 [DBG] Connection id "0HMPMOM09HCAS" started.
2023-04-06 21:36:58.479 +04:00 [DBG] Connection 0HMPMOM09HCAS established using the following protocol: "Tls12"
2023-04-06 21:36:58.481 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:36:58.481 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:36:58.481 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.483 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.483 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:36:58.484 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:36:58.485 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:58.486 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:58.487 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:58.487 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:58.488 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:58.489 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:58.490 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:36:58.491 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:36:58.492 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.9631ms
2023-04-06 21:36:58.492 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.6701ms
2023-04-06 21:36:58.494 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:36:58.495 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.496 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.497 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.498 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:58.498 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:58.499 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:58.501 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:36:58.502 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:36:58.504 +04:00 [DBG] Authorization was successful.
2023-04-06 21:36:58.505 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.509 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:36:58.512 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:36:58.513 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:36:58.515 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:36:58.517 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:36:58.518 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:36:58.519 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:36:58.523 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:36:58.534 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:36:58.537 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-06 21:36:58.539 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:36:58.548 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:36:58.551 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:58.552 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:36:58.554 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-06 21:36:58.554 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:36:58.556 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:36:58.557 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.557 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.558 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:36:58.565 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:36:58.570 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.580 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.581 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.583 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.584 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 16ms reading results.
2023-04-06 21:36:58.586 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.587 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:36:58.588 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:36:58.591 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:36:58.592 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:36:58.594 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:36:58.596 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:36:58.597 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:36:58.599 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 79.2803ms
2023-04-06 21:36:58.600 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.600 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:36:58.601 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:36:58.602 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.603 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.604 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:36:58.605 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:36:58.606 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.607 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 113.1261ms
2023-04-06 21:36:58.608 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:36:58.610 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:36:58.611 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:36:58.614 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:36:58.615 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:36:58.617 +04:00 [DBG] Authorization was successful.
2023-04-06 21:36:58.618 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.619 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:36:58.620 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:36:58.621 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:36:58.623 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:36:58.626 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:36:58.627 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:36:58.629 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:36:58.630 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:36:58.671 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:36:58.677 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:36:58.678 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:36:58.679 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:36:58.679 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:36:58.681 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:36:58.682 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.683 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.684 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:36:58.686 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:36:58.688 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.690 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.692 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:36:58.693 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.694 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:36:58.696 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.696 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:36:58.698 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:36:58.700 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:36:58.700 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:36:58.702 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:36:58.702 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:36:58.703 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:36:58.704 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 75.2779ms
2023-04-06 21:36:58.706 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:36:58.707 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:36:58.708 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:36:58.709 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:36:58.710 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 110.1868ms
2023-04-06 21:37:06.810 +04:00 [DBG] Connection id "0HMPMOM09HCAS" received FIN.
2023-04-06 21:37:06.811 +04:00 [DBG] Connection id "0HMPMOM09HCAS" is closed. The last processed stream ID was 7.
2023-04-06 21:37:06.811 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAS completed.
2023-04-06 21:37:06.813 +04:00 [DBG] Connection id "0HMPMOM09HCAS" sending FIN because: "The client closed the connection."
2023-04-06 21:37:06.829 +04:00 [DBG] Connection id "0HMPMOM09HCAS" stopped.
2023-04-06 21:37:39.036 +04:00 [DBG] Connection id "0HMPMOM09HCAT" accepted.
2023-04-06 21:37:39.037 +04:00 [DBG] Connection id "0HMPMOM09HCAT" started.
2023-04-06 21:37:39.039 +04:00 [DBG] Connection 0HMPMOM09HCAT established using the following protocol: "Tls12"
2023-04-06 21:37:39.041 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:37:39.042 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:37:39.043 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:37:39.044 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:39.045 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:39.046 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:39.047 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:37:39.048 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 7.1749ms
2023-04-06 21:37:39.049 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:37:39.050 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:37:39.051 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:37:39.053 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:37:39.054 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:39.055 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:39.057 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:39.062 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:37:39.063 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:37:39.064 +04:00 [DBG] Authorization was successful.
2023-04-06 21:37:39.065 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:37:39.066 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:37:39.069 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:37:39.070 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:37:39.071 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:37:39.073 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:37:39.074 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:37:39.076 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:37:39.078 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:37:39.080 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:37:39.082 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:37:39.083 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:37:39.085 +04:00 [DBG] Connection id "0HMPMOM09HCAT", Request id "0HMPMOM09HCAT:00000003": started reading request body.
2023-04-06 21:37:39.086 +04:00 [DBG] Connection id "0HMPMOM09HCAT", Request id "0HMPMOM09HCAT:00000003": done reading request body.
2023-04-06 21:37:39.087 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:37:39.088 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:37:39.090 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:37:39.092 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:37:39.094 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:37:39.096 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:37:39.098 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:39.099 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:37:39.099 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:37:39.100 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:37:39.101 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:37:39.103 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.104 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.105 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:37:39.108 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:37:39.110 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.112 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.113 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.114 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.116 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.117 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.118 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.119 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.120 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.122 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.124 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.125 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.127 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.128 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.129 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.131 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.132 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.134 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.135 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.136 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.137 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.139 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.140 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.141 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.143 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.144 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.145 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.146 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.147 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.148 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.149 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.150 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.152 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.154 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.155 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.156 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.157 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.158 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.160 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.161 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.163 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.164 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.165 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.166 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.167 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 56ms reading results.
2023-04-06 21:37:39.168 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.170 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:39.171 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:39.172 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:37:39.173 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:37:39.174 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.176 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.177 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:37:39.183 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:37:39.187 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.188 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.190 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.191 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.192 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:37:39.194 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.195 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:39.197 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:39.198 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:37:39.199 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:37:39.200 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.202 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.203 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:37:39.207 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:37:39.211 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.212 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.213 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.215 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.216 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.218 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.219 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 8ms reading results.
2023-04-06 21:37:39.220 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.221 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:39.223 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.225 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.227 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.229 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:37:39.230 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:37:39.231 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:37:39.233 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:37:39.234 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.235 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.236 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:37:39.237 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:37:39.238 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:39.238 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:37:39.240 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:37:39.241 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:37:39.247 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:37:39.252 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.253 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 0ms reading results.
2023-04-06 21:37:39.254 +04:00 [DBG] Committing transaction.
2023-04-06 21:37:39.255 +04:00 [DBG] Committed transaction.
2023-04-06 21:37:39.256 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.257 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:39.259 +04:00 [DBG] Disposing transaction.
2023-04-06 21:37:39.260 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.262 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.263 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:39.265 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:37:39.266 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:37:39.268 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:37:39.269 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:37:39.269 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:37:39.270 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:37:39.271 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:37:39.272 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 196.5538ms
2023-04-06 21:37:39.274 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:37:39.275 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:37:39.276 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:39.277 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:37:39.278 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 229.4510ms
2023-04-06 21:37:40.718 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:37:40.718 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:37:40.719 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.719 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.720 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:37:40.721 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:37:40.722 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:40.724 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:40.724 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:40.725 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:40.726 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:40.728 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:40.728 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:37:40.729 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:37:40.730 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.7117ms
2023-04-06 21:37:40.731 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.8594ms
2023-04-06 21:37:40.733 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:37:40.734 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.735 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.736 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.737 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:40.738 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:40.740 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:40.741 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:37:40.742 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:37:40.744 +04:00 [DBG] Authorization was successful.
2023-04-06 21:37:40.745 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.746 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:37:40.747 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:37:40.749 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:37:40.750 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:37:40.752 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:37:40.753 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:37:40.755 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:37:40.759 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:37:40.761 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:37:40.763 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:40.764 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:37:40.765 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:37:40.765 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:37:40.767 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:37:40.768 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.769 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.770 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:37:40.774 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:37:40.777 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.778 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.779 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.781 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.782 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:37:40.783 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.784 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:40.785 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:37:40.787 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:37:40.788 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:37:40.789 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:37:40.790 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:37:40.791 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:37:40.793 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 37.4836ms
2023-04-06 21:37:40.794 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.794 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:37:40.795 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:37:40.796 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.797 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.798 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:37:40.799 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:37:40.800 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.801 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 68.3233ms
2023-04-06 21:37:40.802 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:37:40.804 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:37:40.805 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:37:40.806 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:37:40.806 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:37:40.807 +04:00 [DBG] Authorization was successful.
2023-04-06 21:37:40.808 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.809 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:37:40.811 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:37:40.813 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:37:40.814 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:37:40.816 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:37:40.817 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:37:40.818 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:37:40.820 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:37:40.821 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:37:40.823 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:37:40.824 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:37:40.825 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:37:40.825 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:37:40.827 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:37:40.828 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.829 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.830 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:37:40.833 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:37:40.835 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.836 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.837 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:37:40.838 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.839 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:37:40.841 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.842 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:37:40.843 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:37:40.845 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:37:40.846 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:37:40.846 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:37:40.847 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:37:40.848 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:37:40.849 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.8811ms
2023-04-06 21:37:40.850 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:37:40.851 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:37:40.852 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:37:40.853 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:37:40.854 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 60.1201ms
2023-04-06 21:37:54.379 +04:00 [DBG] Connection id "0HMPMOM09HCAT" received FIN.
2023-04-06 21:37:54.380 +04:00 [DBG] Connection id "0HMPMOM09HCAT" is closed. The last processed stream ID was 11.
2023-04-06 21:37:54.381 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAT completed.
2023-04-06 21:37:54.382 +04:00 [DBG] Connection id "0HMPMOM09HCAT" sending FIN because: "The client closed the connection."
2023-04-06 21:37:54.393 +04:00 [DBG] Connection id "0HMPMOM09HCAT" stopped.
2023-04-06 21:38:29.548 +04:00 [DBG] Connection id "0HMPMOM09HCAU" accepted.
2023-04-06 21:38:29.550 +04:00 [DBG] Connection id "0HMPMOM09HCAU" started.
2023-04-06 21:38:29.552 +04:00 [DBG] Connection 0HMPMOM09HCAU established using the following protocol: "Tls12"
2023-04-06 21:38:29.553 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-06 21:38:29.554 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 21:38:29.555 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:38:29.556 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:29.556 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:29.557 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:29.558 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:38:29.559 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 5.3470ms
2023-04-06 21:38:29.560 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 45
2023-04-06 21:38:29.561 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-06 21:38:29.562 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-06 21:38:29.563 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:38:29.564 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:29.565 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:29.566 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:29.567 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-06 21:38:29.568 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:38:29.571 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:38:29.573 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:38:29.575 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:38:29.577 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:38:29.578 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:38:29.579 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:38:29.580 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:29.582 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:29.583 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 21:38:29.584 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-06 21:38:29.585 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:38:29.587 +04:00 [DBG] Connection id "0HMPMOM09HCAU", Request id "0HMPMOM09HCAU:00000003": started reading request body.
2023-04-06 21:38:29.588 +04:00 [DBG] Connection id "0HMPMOM09HCAU", Request id "0HMPMOM09HCAU:00000003": done reading request body.
2023-04-06 21:38:29.591 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-06 21:38:29.593 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:38:29.594 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:38:29.595 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-06 21:38:29.598 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-06 21:38:29.602 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:38:29.605 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-06 21:38:29.606 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-06 21:38:29.611 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-06 21:38:29.615 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:29.615 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:38:29.616 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:38:29.617 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:38:29.618 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:38:29.619 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:29.620 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:29.622 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 21:38:29.628 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-06 21:38:29.630 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:29.631 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:29.632 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:29.634 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:29.635 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:38:29.636 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:29.637 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:38:29.647 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:38:29.650 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:38:29.650 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:38:29.651 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:38:29.652 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:38:29.653 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:38:29.654 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 73.8557ms
2023-04-06 21:38:29.655 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-06 21:38:29.656 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:38:29.657 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:29.659 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:38:29.660 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 45 - 200 - application/json;+charset=utf-8 100.4124ms
2023-04-06 21:38:30.629 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:38:30.629 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:38:30.631 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.631 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.632 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:38:30.633 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:38:30.634 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:30.635 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:30.636 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:30.636 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:30.637 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:30.638 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:30.638 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:38:30.639 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:38:30.640 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.6464ms
2023-04-06 21:38:30.641 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.1033ms
2023-04-06 21:38:30.642 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:38:30.644 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.645 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.647 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.647 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:30.648 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:30.649 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:30.650 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:38:30.650 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:38:30.652 +04:00 [DBG] Authorization was successful.
2023-04-06 21:38:30.653 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.653 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:38:30.655 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:38:30.657 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:38:30.658 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:38:30.660 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:38:30.661 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:38:30.662 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:30.663 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:30.665 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:38:30.666 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:30.667 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:38:30.668 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:38:30.669 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:38:30.670 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:38:30.671 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.673 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.674 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:38:30.678 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:38:30.681 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.683 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.684 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.685 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.685 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:38:30.687 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.687 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:38:30.688 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:38:30.690 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:38:30.691 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:38:30.692 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:38:30.693 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:38:30.694 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:38:30.695 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 33.2699ms
2023-04-06 21:38:30.697 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.697 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:38:30.698 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:38:30.699 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.700 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.701 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:38:30.702 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:38:30.703 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.704 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 61.7432ms
2023-04-06 21:38:30.705 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:30.706 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:30.707 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:30.708 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:38:30.709 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:38:30.710 +04:00 [DBG] Authorization was successful.
2023-04-06 21:38:30.711 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.712 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:38:30.713 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:38:30.715 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:38:30.716 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:38:30.717 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:38:30.719 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:38:30.720 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:30.721 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:38:30.723 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:38:30.725 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:30.727 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:38:30.727 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:38:30.728 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:38:30.729 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:38:30.730 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.732 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.733 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:38:30.735 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:38:30.737 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.738 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.739 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:30.740 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.742 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:38:30.743 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.744 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:38:30.746 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:38:30.748 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:38:30.748 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:38:30.749 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:38:30.750 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:38:30.751 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:38:30.752 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 32.2362ms
2023-04-06 21:38:30.754 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:38:30.754 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:38:30.756 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:30.757 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:38:30.758 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 61.1772ms
2023-04-06 21:38:59.477 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:38:59.479 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:38:59.481 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:38:59.482 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:59.483 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:59.484 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:59.485 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:38:59.486 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 8.5624ms
2023-04-06 21:38:59.487 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:38:59.488 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:38:59.489 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:38:59.490 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:38:59.492 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:38:59.492 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:38:59.493 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:38:59.494 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:38:59.495 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:38:59.495 +04:00 [DBG] Authorization was successful.
2023-04-06 21:38:59.496 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:38:59.497 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:38:59.498 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:38:59.499 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:38:59.500 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:38:59.502 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:38:59.503 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:38:59.504 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:38:59.505 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:38:59.506 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:38:59.508 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:38:59.510 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:38:59.511 +04:00 [DBG] Connection id "0HMPMOM09HCAU", Request id "0HMPMOM09HCAU:0000000F": started reading request body.
2023-04-06 21:38:59.512 +04:00 [DBG] Connection id "0HMPMOM09HCAU", Request id "0HMPMOM09HCAU:0000000F": done reading request body.
2023-04-06 21:38:59.513 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:38:59.513 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:38:59.514 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:38:59.515 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:38:59.516 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:38:59.518 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:38:59.519 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:59.520 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:38:59.521 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:38:59.523 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:38:59.523 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:38:59.525 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.526 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.527 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:38:59.529 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:38:59.531 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.532 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.533 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.534 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.535 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.536 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.538 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.539 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.540 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.541 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.543 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.544 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.545 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.546 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.547 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.548 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.550 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.551 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.553 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.554 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.555 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.557 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.558 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.560 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.561 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.563 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.564 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.565 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.566 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.566 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.567 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.569 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.571 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.572 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.574 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.575 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.576 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.578 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.579 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.580 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.582 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.583 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.584 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.586 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.587 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 56ms reading results.
2023-04-06 21:38:59.588 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.590 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:38:59.591 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:59.593 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:38:59.594 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:38:59.595 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.596 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.597 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:38:59.602 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:38:59.605 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.606 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.608 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.609 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.611 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:38:59.612 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.613 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:38:59.614 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:59.615 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:38:59.616 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:38:59.617 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.619 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.620 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:38:59.624 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:38:59.627 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.628 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.629 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.630 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 2ms reading results.
2023-04-06 21:38:59.631 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.632 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:38:59.634 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.635 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.636 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.637 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:38:59.638 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:38:59.639 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:38:59.640 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:38:59.641 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.643 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.644 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:38:59.645 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:38:59.645 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:38:59.646 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:38:59.647 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:38:59.648 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:38:59.654 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:38:59.657 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.659 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 21:38:59.660 +04:00 [DBG] Committing transaction.
2023-04-06 21:38:59.661 +04:00 [DBG] Committed transaction.
2023-04-06 21:38:59.662 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.663 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:38:59.664 +04:00 [DBG] Disposing transaction.
2023-04-06 21:38:59.666 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.667 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.669 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:38:59.671 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:38:59.672 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:38:59.674 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:38:59.675 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:38:59.676 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:38:59.677 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:38:59.678 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:38:59.679 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 175.4093ms
2023-04-06 21:38:59.680 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:38:59.681 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:38:59.682 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:38:59.683 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:38:59.684 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 197.3632ms
2023-04-06 21:39:00.883 +04:00 [DBG] Connection id "0HMPMOM09HCAU" received FIN.
2023-04-06 21:39:00.885 +04:00 [DBG] Connection id "0HMPMOM09HCAU" is closed. The last processed stream ID was 15.
2023-04-06 21:39:00.885 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAU completed.
2023-04-06 21:39:00.886 +04:00 [DBG] Connection id "0HMPMOM09HCAU" sending FIN because: "The client closed the connection."
2023-04-06 21:39:00.896 +04:00 [DBG] Connection id "0HMPMOM09HCAU" stopped.
2023-04-06 21:39:03.743 +04:00 [DBG] Connection id "0HMPMOM09HCAV" accepted.
2023-04-06 21:39:03.745 +04:00 [DBG] Connection id "0HMPMOM09HCAV" started.
2023-04-06 21:39:03.746 +04:00 [DBG] Connection 0HMPMOM09HCAV established using the following protocol: "Tls12"
2023-04-06 21:39:03.748 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:03.748 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:03.749 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.749 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.750 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:39:03.751 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:39:03.752 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:03.754 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:03.755 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:03.755 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:03.756 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:03.757 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:03.758 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:39:03.759 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:39:03.760 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.7704ms
2023-04-06 21:39:03.760 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.3779ms
2023-04-06 21:39:03.762 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:03.763 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.764 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.765 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.766 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:03.766 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:03.767 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:03.768 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:03.768 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:03.771 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:03.771 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.773 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:03.774 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:03.775 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:03.777 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:03.778 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:03.780 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:03.783 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:03.787 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:03.799 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:03.801 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:03.802 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:03.803 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:03.803 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:39:03.804 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:39:03.805 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.806 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.807 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:03.810 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:03.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.813 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.814 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.815 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.816 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-06 21:39:03.817 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.818 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:39:03.819 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:03.821 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:03.821 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:03.823 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:03.823 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:03.825 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:03.826 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 43.7457ms
2023-04-06 21:39:03.827 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.828 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:03.828 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:03.829 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.830 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.831 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:03.832 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:39:03.833 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.834 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 72.3663ms
2023-04-06 21:39:03.835 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:03.836 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:03.837 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:03.838 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:03.838 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:03.839 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:03.840 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.841 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:03.843 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:03.844 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:03.845 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:03.846 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:03.847 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:03.849 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:03.851 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:03.852 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:03.854 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:03.855 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:03.855 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:03.856 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:39:03.857 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:39:03.859 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.860 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.860 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:03.863 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:03.865 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.866 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.867 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:03.868 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.869 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-06 21:39:03.870 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.871 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:39:03.873 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:03.875 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:03.876 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:03.877 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:03.877 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:03.878 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:03.879 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.8164ms
2023-04-06 21:39:03.881 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:03.882 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:03.883 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:03.884 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:39:03.885 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 57.8088ms
2023-04-06 21:39:04.558 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:04.560 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:04.561 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:04.563 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.564 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:04.565 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:04.566 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:04.566 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:04.567 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:04.568 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:04.569 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.570 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:04.572 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:04.573 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:04.574 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:04.576 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:04.577 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:04.579 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:04.580 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:04.581 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:04.583 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:04.583 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:04.584 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:04.585 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:39:04.586 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:39:04.586 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.587 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.588 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:04.591 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:04.594 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.595 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.597 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.598 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.599 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:39:04.600 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.601 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:39:04.613 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:04.615 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:04.615 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:04.616 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:04.617 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:04.618 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:04.619 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 40.3744ms
2023-04-06 21:39:04.620 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.620 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:04.621 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:04.622 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:04.623 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.624 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:04.626 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:39:04.627 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.628 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 69.7719ms
2023-04-06 21:39:04.628 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:04.630 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:04.630 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:04.631 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:04.633 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:04.634 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:04.634 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.635 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:04.637 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:04.638 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:04.639 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:04.641 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:04.643 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:04.644 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:04.645 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:04.647 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:04.648 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:04.649 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:04.649 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:04.650 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:39:04.651 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:39:04.652 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.653 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.654 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:04.658 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:04.661 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.662 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.663 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:04.664 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.665 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:39:04.666 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.667 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:39:04.668 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:04.671 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:04.672 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:04.673 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:04.674 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:04.675 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:04.676 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 32.1272ms
2023-04-06 21:39:04.677 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:04.678 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:04.679 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:04.680 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:39:04.681 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 60.4955ms
2023-04-06 21:39:06.886 +04:00 [DBG] Connection id "0HMPMOM09HCAV" received FIN.
2023-04-06 21:39:06.887 +04:00 [DBG] Connection id "0HMPMOM09HCAV" is closed. The last processed stream ID was 11.
2023-04-06 21:39:06.887 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCAV completed.
2023-04-06 21:39:06.888 +04:00 [DBG] Connection id "0HMPMOM09HCAV" sending FIN because: "The client closed the connection."
2023-04-06 21:39:06.902 +04:00 [DBG] Connection id "0HMPMOM09HCAV" stopped.
2023-04-06 21:39:47.813 +04:00 [DBG] Connection id "0HMPMOM09HCB0" accepted.
2023-04-06 21:39:47.814 +04:00 [DBG] Connection id "0HMPMOM09HCB0" started.
2023-04-06 21:39:47.816 +04:00 [DBG] Connection 0HMPMOM09HCB0 established using the following protocol: "Tls12"
2023-04-06 21:39:47.818 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:47.818 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:47.818 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.819 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.820 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:39:47.821 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:39:47.822 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:47.823 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:47.825 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:47.826 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:47.827 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:47.827 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:47.828 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:39:47.829 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:39:47.829 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.8070ms
2023-04-06 21:39:47.830 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.5824ms
2023-04-06 21:39:47.831 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:47.833 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.834 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.835 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.836 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:47.837 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:47.838 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:47.838 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:47.839 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:47.840 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:47.841 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.842 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:47.844 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:47.845 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:47.846 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:47.847 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:47.848 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:47.850 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:47.852 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:47.854 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:47.856 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:47.857 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:47.858 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:47.859 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:39:47.860 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:39:47.862 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.863 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.864 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:47.869 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:47.871 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.872 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.874 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.875 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.876 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:39:47.878 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.879 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:39:47.880 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:47.883 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:47.883 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:47.884 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:47.885 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:47.886 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:47.887 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 37.0019ms
2023-04-06 21:39:47.889 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.889 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:39:47.890 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:47.891 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.892 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.893 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:39:47.894 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:39:47.896 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.898 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 66.4636ms
2023-04-06 21:39:47.899 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:39:47.900 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:39:47.901 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:39:47.902 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:39:47.903 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:39:47.904 +04:00 [DBG] Authorization was successful.
2023-04-06 21:39:47.905 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.905 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:39:47.907 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:39:47.909 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:39:47.910 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:39:47.912 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:39:47.913 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:39:47.915 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:47.916 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:39:47.918 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:39:47.920 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:39:47.921 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:39:47.921 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:39:47.923 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:39:47.924 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:39:47.925 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.927 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.928 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:47.930 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:39:47.933 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.934 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.935 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:39:47.937 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.938 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:39:47.939 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.940 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:39:47.942 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:39:47.944 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:39:47.945 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:39:47.946 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:39:47.947 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:39:47.948 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:39:47.949 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.1978ms
2023-04-06 21:39:47.950 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:39:47.951 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:39:47.952 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:39:47.954 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:39:47.955 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 66.1352ms
2023-04-06 21:39:57.027 +04:00 [DBG] Connection id "0HMPMOM09HCB0" received FIN.
2023-04-06 21:39:57.028 +04:00 [DBG] Connection id "0HMPMOM09HCB0" is closed. The last processed stream ID was 7.
2023-04-06 21:39:57.028 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCB0 completed.
2023-04-06 21:39:57.029 +04:00 [DBG] Connection id "0HMPMOM09HCB0" sending FIN because: "The client closed the connection."
2023-04-06 21:39:57.042 +04:00 [DBG] Connection id "0HMPMOM09HCB0" stopped.
2023-04-06 21:40:20.572 +04:00 [DBG] Connection id "0HMPMOM09HCB1" accepted.
2023-04-06 21:40:20.574 +04:00 [DBG] Connection id "0HMPMOM09HCB1" started.
2023-04-06 21:40:20.576 +04:00 [DBG] Connection 0HMPMOM09HCB1 established using the following protocol: "Tls12"
2023-04-06 21:40:20.577 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:40:20.578 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:40:20.579 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:40:20.580 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:20.581 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:20.582 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:20.583 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:40:20.584 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.5952ms
2023-04-06 21:40:20.585 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:40:20.586 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:40:20.587 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:40:20.589 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:40:20.590 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:20.591 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:20.593 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:20.594 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:40:20.594 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:40:20.595 +04:00 [DBG] Authorization was successful.
2023-04-06 21:40:20.596 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:40:20.597 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:40:20.599 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:40:20.600 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:40:20.601 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:40:20.602 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:40:20.603 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:40:20.604 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:40:20.606 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:40:20.607 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:40:20.608 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:40:20.609 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:40:20.610 +04:00 [DBG] Connection id "0HMPMOM09HCB1", Request id "0HMPMOM09HCB1:00000003": started reading request body.
2023-04-06 21:40:20.611 +04:00 [DBG] Connection id "0HMPMOM09HCB1", Request id "0HMPMOM09HCB1:00000003": done reading request body.
2023-04-06 21:40:20.613 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:40:20.615 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:40:20.616 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:40:20.617 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:40:20.618 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:40:20.619 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:40:20.620 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:20.621 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:40:20.622 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:40:20.623 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:40:20.624 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:40:20.625 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.626 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.627 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:40:20.630 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:40:20.632 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.633 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.634 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.635 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.636 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.637 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.638 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.639 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.642 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.643 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.644 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.645 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.646 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.647 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.648 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.649 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.650 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.652 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.653 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.654 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.655 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.656 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.658 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.659 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.660 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.661 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.663 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.664 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.665 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.666 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.667 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.668 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.669 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.670 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.671 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.673 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.675 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.676 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.677 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.678 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.679 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.680 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.682 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.683 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.684 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 52ms reading results.
2023-04-06 21:40:20.685 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.686 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:40:20.687 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:20.688 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:40:20.690 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:40:20.691 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.693 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.694 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:40:20.700 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:40:20.703 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.704 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.706 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.707 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.709 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:40:20.710 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.710 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:40:20.712 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:20.713 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:40:20.714 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:40:20.715 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.716 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.717 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:40:20.720 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:40:20.724 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.725 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.727 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.727 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.728 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:40:20.730 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.731 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:40:20.732 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.734 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.735 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.736 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:40:20.737 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:40:20.738 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:40:20.739 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:40:20.740 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.742 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.744 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:40:20.745 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:40:20.745 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:20.746 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:40:20.747 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:40:20.748 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:40:20.753 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:40:20.756 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.758 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-06 21:40:20.759 +04:00 [DBG] Committing transaction.
2023-04-06 21:40:20.761 +04:00 [DBG] Committed transaction.
2023-04-06 21:40:20.761 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.763 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:40:20.764 +04:00 [DBG] Disposing transaction.
2023-04-06 21:40:20.765 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.766 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.768 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:20.770 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:40:20.771 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:40:20.773 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:40:20.774 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:40:20.775 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:40:20.775 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:40:20.776 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:40:20.777 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 172.9924ms
2023-04-06 21:40:20.778 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:40:20.780 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:40:20.781 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:20.782 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:40:20.783 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 197.4320ms
2023-04-06 21:40:22.934 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:40:22.935 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:40:22.935 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:40:22.936 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:40:22.937 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:40:22.938 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:40:22.939 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:22.941 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:22.942 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:22.942 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:22.943 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:22.944 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:22.945 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:40:22.945 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:40:22.946 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 11.6556ms
2023-04-06 21:40:22.947 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 12.2259ms
2023-04-06 21:40:22.948 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:40:22.949 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:40:22.950 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:40:22.952 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:22.953 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:22.953 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:22.954 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:22.955 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:40:22.956 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:40:22.957 +04:00 [DBG] Authorization was successful.
2023-04-06 21:40:22.958 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:22.959 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:40:22.961 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:40:22.962 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:40:22.963 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:40:22.965 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:40:22.966 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:40:22.968 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:40:22.969 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:40:22.970 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:40:22.972 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:22.973 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:40:22.974 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:40:22.975 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:40:22.976 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:40:22.977 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:22.977 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:22.979 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:40:22.984 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:40:22.986 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:22.988 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:22.989 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:22.990 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:22.992 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:40:22.993 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:22.994 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:40:22.995 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:40:22.997 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:40:22.998 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:40:22.998 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:40:22.999 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:40:23.000 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:40:23.001 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 33.1349ms
2023-04-06 21:40:23.002 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:23.002 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:40:23.003 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:40:23.004 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:40:23.005 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.005 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:40:23.006 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:40:23.008 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:23.009 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 61.3377ms
2023-04-06 21:40:23.010 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:40:23.011 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:40:23.013 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:40:23.013 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:40:23.014 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:40:23.015 +04:00 [DBG] Authorization was successful.
2023-04-06 21:40:23.015 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:23.016 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:40:23.017 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:40:23.018 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:40:23.020 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:40:23.021 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:40:23.023 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:40:23.025 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:40:23.026 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:40:23.027 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:40:23.029 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:40:23.031 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:40:23.031 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:40:23.032 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:40:23.033 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:40:23.034 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.035 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.036 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:40:23.038 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:40:23.040 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:23.042 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:23.043 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:40:23.044 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.046 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:40:23.047 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.048 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:40:23.049 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:40:23.050 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:40:23.051 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:40:23.052 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:40:23.053 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:40:23.054 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:40:23.055 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.0221ms
2023-04-06 21:40:23.057 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:40:23.058 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:40:23.059 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:40:23.060 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:40:23.062 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 59.3940ms
2023-04-06 21:41:06.607 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:06.608 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:06.608 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.609 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.610 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:41:06.611 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:41:06.612 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:06.612 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:06.613 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:06.614 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:06.614 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:06.615 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:06.616 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:41:06.617 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:41:06.617 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.5931ms
2023-04-06 21:41:06.618 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.0888ms
2023-04-06 21:41:06.619 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:06.620 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.621 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.623 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.625 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:06.626 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:06.627 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:06.627 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:41:06.628 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:41:06.629 +04:00 [DBG] Authorization was successful.
2023-04-06 21:41:06.629 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.630 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:41:06.632 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:41:06.633 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:41:06.634 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:41:06.636 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:41:06.637 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:41:06.639 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:06.640 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:06.642 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:41:06.644 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:06.644 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:41:06.645 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:41:06.646 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:06.647 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:06.647 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.648 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.649 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:06.652 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:06.654 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.655 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.657 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.658 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.659 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-06 21:41:06.660 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.661 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:06.663 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:41:06.664 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:41:06.665 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:41:06.666 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:41:06.666 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:41:06.668 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:41:06.669 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.0872ms
2023-04-06 21:41:06.670 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:06.670 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.671 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.671 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:41:06.673 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:41:06.674 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.675 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.676 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-06 21:41:06.677 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:06.678 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 59.0915ms
2023-04-06 21:41:06.679 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:06.680 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:06.681 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:41:06.682 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:41:06.683 +04:00 [DBG] Authorization was successful.
2023-04-06 21:41:06.683 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.684 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:41:06.685 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:41:06.687 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:41:06.687 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:41:06.691 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:41:06.692 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:41:06.693 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:06.694 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:06.695 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:41:06.697 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:06.698 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:41:06.698 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:41:06.699 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:06.700 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:41:06.701 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.702 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.703 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:06.706 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:06.708 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.709 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.710 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:06.711 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.712 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:41:06.714 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.715 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:06.716 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:41:06.717 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:41:06.718 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:41:06.718 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:41:06.719 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:41:06.721 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:41:06.723 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 30.159ms
2023-04-06 21:41:06.724 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:06.726 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:41:06.726 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:06.727 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:41:06.728 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 58.6952ms
2023-04-06 21:41:13.379 +04:00 [DBG] Connection id "0HMPMOM09HCB1" received FIN.
2023-04-06 21:41:13.380 +04:00 [DBG] Connection id "0HMPMOM09HCB1" is closed. The last processed stream ID was 19.
2023-04-06 21:41:13.380 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCB1 completed.
2023-04-06 21:41:13.381 +04:00 [DBG] Connection id "0HMPMOM09HCB1" sending FIN because: "The client closed the connection."
2023-04-06 21:41:13.392 +04:00 [DBG] Connection id "0HMPMOM09HCB1" stopped.
2023-04-06 21:41:46.948 +04:00 [DBG] Connection id "0HMPMOM09HCB2" accepted.
2023-04-06 21:41:46.949 +04:00 [DBG] Connection id "0HMPMOM09HCB2" started.
2023-04-06 21:41:46.951 +04:00 [DBG] Connection 0HMPMOM09HCB2 established using the following protocol: "Tls12"
2023-04-06 21:41:46.953 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-06 21:41:46.953 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:41:46.954 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:41:46.955 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:46.956 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:46.957 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:46.958 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:41:46.958 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 5.7262ms
2023-04-06 21:41:46.959 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27
2023-04-06 21:41:46.960 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-06 21:41:46.961 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-06 21:41:46.963 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:41:46.963 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:46.964 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:46.965 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:46.966 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:41:46.966 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:41:46.967 +04:00 [DBG] Authorization was successful.
2023-04-06 21:41:46.968 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:41:46.969 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-06 21:41:46.970 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:41:46.971 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:41:46.973 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:41:46.975 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:41:46.976 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:41:46.977 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:41:46.978 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-06 21:41:46.979 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:41:46.980 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-06 21:41:46.982 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-06 21:41:46.983 +04:00 [DBG] Connection id "0HMPMOM09HCB2", Request id "0HMPMOM09HCB2:00000003": started reading request body.
2023-04-06 21:41:46.984 +04:00 [DBG] Connection id "0HMPMOM09HCB2", Request id "0HMPMOM09HCB2:00000003": done reading request body.
2023-04-06 21:41:46.985 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-06 21:41:46.986 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:41:46.987 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:41:46.988 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-06 21:41:46.990 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-06 21:41:46.992 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:41:46.993 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:46.994 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:41:46.995 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:41:46.996 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:46.998 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-06 21:41:46.999 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.000 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.002 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:41:47.018 +04:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-06 21:41:47.021 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.022 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.025 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.027 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.028 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.030 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.031 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.033 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.034 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.035 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.036 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.037 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.038 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.040 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.041 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.042 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.043 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.045 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.046 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.047 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.048 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.051 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.052 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.053 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.054 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.056 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.057 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.058 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.060 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.061 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.062 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.064 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.065 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.066 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.067 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.068 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.069 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.070 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.072 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.073 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.075 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.076 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.077 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 56ms reading results.
2023-04-06 21:41:47.079 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.080 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:41:47.081 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:47.082 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:41:47.083 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:47.084 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.085 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.086 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:41:47.095 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE EXISTS (
    SELECT 1
    FROM [Cards] AS [c]
    WHERE [a].[Id] = [c].[AccountId] AND [c].[Id] = @__cardId_0)
2023-04-06 21:41:47.097 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.098 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.099 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.100 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.102 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:41:47.103 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.104 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:47.106 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:47.107 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-06 21:41:47.108 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:47.109 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.110 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.111 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:41:47.115 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-06 21:41:47.117 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.118 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.119 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.121 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.123 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.125 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-04-06 21:41:47.126 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.127 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:47.128 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.130 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.131 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.132 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-06 21:41:47.133 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-06 21:41:47.134 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-06 21:41:47.135 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-06 21:41:47.135 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.137 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.138 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-06 21:41:47.140 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-06 21:41:47.140 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:47.141 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-06 21:41:47.143 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:47.144 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:41:47.149 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-06 21:41:47.153 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.154 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 0ms reading results.
2023-04-06 21:41:47.155 +04:00 [DBG] Committing transaction.
2023-04-06 21:41:47.157 +04:00 [DBG] Committed transaction.
2023-04-06 21:41:47.158 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.158 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:47.160 +04:00 [DBG] Disposing transaction.
2023-04-06 21:41:47.160 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.162 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.164 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:47.165 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-06 21:41:47.166 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:41:47.168 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:41:47.169 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:41:47.170 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:41:47.170 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:41:47.172 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:41:47.173 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 196.4678ms
2023-04-06 21:41:47.174 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-06 21:41:47.175 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:41:47.176 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:47.177 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:41:47.179 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 27 - 200 - application/json;+charset=utf-8 219.3680ms
2023-04-06 21:41:49.037 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:49.038 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:49.039 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.040 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.041 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:41:49.042 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-06 21:41:49.043 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:49.043 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:49.044 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:49.044 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:49.045 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:49.046 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:49.046 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:41:49.047 +04:00 [DBG] The request is a preflight request.
2023-04-06 21:41:49.048 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.3301ms
2023-04-06 21:41:49.048 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.9134ms
2023-04-06 21:41:49.050 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:49.051 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.052 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.053 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.054 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:49.054 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:49.056 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:49.057 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:41:49.058 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:41:49.059 +04:00 [DBG] Authorization was successful.
2023-04-06 21:41:49.060 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.060 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:41:49.062 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:41:49.063 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:41:49.064 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:41:49.066 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:41:49.067 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:41:49.068 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:49.070 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:49.071 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:41:49.074 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:49.074 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:41:49.075 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:41:49.076 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:49.077 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:41:49.078 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.079 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.080 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:49.084 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:49.086 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.087 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.088 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.091 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.092 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-04-06 21:41:49.094 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.095 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-06 21:41:49.096 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:41:49.098 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:41:49.098 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:41:49.099 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:41:49.099 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:41:49.101 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:41:49.102 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 33.4376ms
2023-04-06 21:41:49.103 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.103 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-06 21:41:49.104 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:41:49.105 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.107 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.107 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-06 21:41:49.108 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-06 21:41:49.110 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.110 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 60.8350ms
2023-04-06 21:41:49.111 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-06 21:41:49.113 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-06 21:41:49.114 +04:00 [INF] CORS policy execution successful.
2023-04-06 21:41:49.115 +04:00 [DBG] Successfully validated the token.
2023-04-06 21:41:49.115 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-06 21:41:49.116 +04:00 [DBG] Authorization was successful.
2023-04-06 21:41:49.117 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.118 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-06 21:41:49.120 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-06 21:41:49.122 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-06 21:41:49.123 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-06 21:41:49.125 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-06 21:41:49.126 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-06 21:41:49.127 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:49.128 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-06 21:41:49.129 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-06 21:41:49.132 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-06 21:41:49.133 +04:00 [DBG] Creating DbConnection.
2023-04-06 21:41:49.133 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-06 21:41:49.134 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-06 21:41:49.135 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-06 21:41:49.136 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.137 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.138 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:49.141 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-06 21:41:49.143 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.145 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.146 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-06 21:41:49.147 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.148 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-06 21:41:49.150 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.151 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-06 21:41:49.153 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-06 21:41:49.156 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-06 21:41:49.157 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-06 21:41:49.158 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-06 21:41:49.158 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-06 21:41:49.160 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-06 21:41:49.162 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 34.6903ms
2023-04-06 21:41:49.163 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-06 21:41:49.164 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-06 21:41:49.165 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-06 21:41:49.166 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-06 21:41:49.167 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 63.8693ms
2023-04-06 21:42:19.880 +04:00 [DBG] Connection id "0HMPMOM09HCB2" received FIN.
2023-04-06 21:42:19.883 +04:00 [DBG] Connection id "0HMPMOM09HCB2" is closed. The last processed stream ID was 11.
2023-04-06 21:42:19.883 +04:00 [DBG] The connection queue processing loop for 0HMPMOM09HCB2 completed.
2023-04-06 21:42:19.884 +04:00 [DBG] Connection id "0HMPMOM09HCB2" sending FIN because: "The client closed the connection."
2023-04-06 21:42:19.895 +04:00 [DBG] Connection id "0HMPMOM09HCB2" stopped.
