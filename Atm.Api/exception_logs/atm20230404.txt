2023-04-04 11:06:07.388 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-04 11:06:07.464 +04:00 [DBG] Hosting starting
2023-04-04 11:06:07.487 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-04 11:06:07.493 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-04 11:06:07.498 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-04 11:06:07.502 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-04 11:06:07.505 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-04 11:06:07.510 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-04 11:06:07.513 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 11:06:07.515 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-04 11:06:07.517 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 11:06:07.520 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-04 11:06:07.523 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-04 11:06:07.527 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-04 11:06:07.528 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-04 11:06:07.630 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-04 11:06:07.631 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-04 11:06:07.632 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-04 11:06:07.633 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-04 11:06:07.634 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-04 11:06:07.634 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-04 11:06:07.635 +04:00 [INF] Hosting environment: Development
2023-04-04 11:06:07.636 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-04 11:06:07.637 +04:00 [DBG] Hosting started
2023-04-04 11:06:07.929 +04:00 [DBG] Connection id "0HMPKRC851VRK" accepted.
2023-04-04 11:06:07.931 +04:00 [DBG] Connection id "0HMPKRC851VRK" started.
2023-04-04 11:06:07.938 +04:00 [DBG] Connection id "0HMPKRC851VRL" accepted.
2023-04-04 11:06:07.939 +04:00 [DBG] Connection id "0HMPKRC851VRL" started.
2023-04-04 11:06:08.003 +04:00 [DBG] Connection id "0HMPKRC851VRL" received FIN.
2023-04-04 11:06:08.003 +04:00 [DBG] Connection id "0HMPKRC851VRK" received FIN.
2023-04-04 11:06:08.009 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 11:06:08.009 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 11:06:08.050 +04:00 [DBG] Connection id "0HMPKRC851VRK" stopped.
2023-04-04 11:06:08.050 +04:00 [DBG] Connection id "0HMPKRC851VRL" stopped.
2023-04-04 11:06:08.053 +04:00 [DBG] Connection id "0HMPKRC851VRL" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 11:06:08.053 +04:00 [DBG] Connection id "0HMPKRC851VRK" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 11:06:08.172 +04:00 [DBG] Connection id "0HMPKRC851VRM" accepted.
2023-04-04 11:06:08.173 +04:00 [DBG] Connection id "0HMPKRC851VRM" started.
2023-04-04 11:06:08.207 +04:00 [DBG] Connection 0HMPKRC851VRM established using the following protocol: "Tls12"
2023-04-04 11:06:08.319 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-04 11:06:08.375 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-04 11:06:08.406 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-04 11:06:08.413 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:06:08.614 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-04 11:06:08.632 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-04 11:06:08.636 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 342.9518ms
2023-04-04 11:06:08.659 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/swagger-ui-standalone-preset.js - -
2023-04-04 11:06:08.659 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-04 11:06:08.659 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/swagger-ui.css - -
2023-04-04 11:06:08.659 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/swagger-ui-bundle.js - -
2023-04-04 11:06:08.661 +04:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-standalone-preset.js'
2023-04-04 11:06:08.663 +04:00 [DBG] No candidates found for the request path '/swagger/swagger-ui.css'
2023-04-04 11:06:08.664 +04:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-bundle.js'
2023-04-04 11:06:08.666 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 7.4691ms
2023-04-04 11:06:08.668 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:06:08.669 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:06:08.672 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:06:08.693 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-04 11:06:08.697 +04:00 [INF] The file /swagger-ui.css was not modified
2023-04-04 11:06:08.697 +04:00 [INF] The file /swagger-ui-standalone-preset.js was not modified
2023-04-04 11:06:08.697 +04:00 [INF] The file /swagger-ui-bundle.js was not modified
2023-04-04 11:06:08.704 +04:00 [DBG] Handled. Status code: 304 File: /swagger-ui-standalone-preset.js
2023-04-04 11:06:08.704 +04:00 [DBG] Handled. Status code: 304 File: /swagger-ui.css
2023-04-04 11:06:08.704 +04:00 [DBG] Handled. Status code: 304 File: /swagger-ui-bundle.js
2023-04-04 11:06:08.706 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/swagger-ui-standalone-preset.js - - - 304 - text/javascript 47.4318ms
2023-04-04 11:06:08.708 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/swagger-ui.css - - - 304 - text/css 48.5952ms
2023-04-04 11:06:08.709 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/swagger-ui-bundle.js - - - 304 - text/javascript 49.9018ms
2023-04-04 11:06:08.723 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 29.9339ms
2023-04-04 11:06:08.982 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-04 11:06:08.984 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-04 11:06:08.985 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:06:09.105 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 122.4766ms
2023-04-04 11:06:11.804 +04:00 [DBG] Connection id "0HMPKRC851VRM" received FIN.
2023-04-04 11:06:11.807 +04:00 [DBG] The connection queue processing loop for 0HMPKRC851VRM completed.
2023-04-04 11:06:11.809 +04:00 [DBG] Connection id "0HMPKRC851VRM" is closed. The last processed stream ID was 13.
2023-04-04 11:06:11.810 +04:00 [DBG] Connection id "0HMPKRC851VRM" sending FIN because: "The client closed the connection."
2023-04-04 11:06:11.813 +04:00 [DBG] Connection id "0HMPKRC851VRM" stopped.
2023-04-04 11:06:21.865 +04:00 [DBG] Connection id "0HMPKRC851VRN" accepted.
2023-04-04 11:06:21.867 +04:00 [DBG] Connection id "0HMPKRC851VRN" started.
2023-04-04 11:06:21.872 +04:00 [DBG] Connection 0HMPKRC851VRN established using the following protocol: "Tls12"
2023-04-04 11:06:21.873 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-04 11:06:21.875 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 11:06:21.877 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:06:21.878 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:21.879 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:21.880 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:21.881 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:06:21.883 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 9.1572ms
2023-04-04 11:06:21.884 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 48
2023-04-04 11:06:21.886 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 11:06:21.889 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-04 11:06:21.890 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:06:21.891 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:21.892 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:21.892 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:21.944 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-04 11:06:21.949 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:06:21.973 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:06:21.977 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:06:21.978 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:06:21.980 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:06:21.982 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:06:21.983 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:06:21.986 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:22.145 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-04 11:06:22.165 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:22.171 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 11:06:22.174 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-04 11:06:22.176 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-04 11:06:22.180 +04:00 [DBG] Connection id "0HMPKRC851VRN", Request id "0HMPKRC851VRN:00000003": started reading request body.
2023-04-04 11:06:22.181 +04:00 [DBG] Connection id "0HMPKRC851VRN", Request id "0HMPKRC851VRN:00000003": done reading request body.
2023-04-04 11:06:22.185 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-04 11:06:22.186 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:06:22.187 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:06:22.188 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 11:06:22.194 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:06:22.541 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-04 11:06:22.543 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-04 11:06:22.823 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:06:22.908 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-04 11:06:22.961 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 11:06:23.071 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 11:06:23.105 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:06:23.107 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:06:23.125 +04:00 [DBG] Created DbConnection. (16ms).
2023-04-04 11:06:23.131 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (26ms).
2023-04-04 11:06:23.140 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (36ms).
2023-04-04 11:06:23.144 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:23.298 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:23.306 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 11:06:23.367 +04:00 [INF] Executed DbCommand (63ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 11:06:23.389 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:23.417 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:23.424 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:23.435 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:23.442 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 68ms reading results.
2023-04-04 11:06:23.446 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:23.451 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-04 11:06:23.546 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:06:23.550 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:06:23.551 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:06:23.551 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:06:23.553 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:06:23.554 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:06:23.564 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 1577.6032ms
2023-04-04 11:06:23.566 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:06:23.569 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:06:23.572 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:23.575 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-04 11:06:23.577 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 48 - 200 - application/json;+charset=utf-8 1693.3600ms
2023-04-04 11:06:26.824 +04:00 [DBG] Connection id "0HMPKRC851VRN" received FIN.
2023-04-04 11:06:26.826 +04:00 [DBG] Connection id "0HMPKRC851VRN" is closed. The last processed stream ID was 3.
2023-04-04 11:06:26.826 +04:00 [DBG] Connection id "0HMPKRC851VRN" sending FIN because: "The client closed the connection."
2023-04-04 11:06:26.829 +04:00 [DBG] The connection queue processing loop for 0HMPKRC851VRN completed.
2023-04-04 11:06:26.830 +04:00 [DBG] Connection id "0HMPKRC851VRN" stopped.
2023-04-04 11:06:31.253 +04:00 [DBG] Connection id "0HMPKRC851VRO" accepted.
2023-04-04 11:06:31.255 +04:00 [DBG] Connection id "0HMPKRC851VRO" started.
2023-04-04 11:06:31.260 +04:00 [DBG] Connection 0HMPKRC851VRO established using the following protocol: "Tls12"
2023-04-04 11:06:31.262 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:06:31.262 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:06:31.263 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.264 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.265 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:06:31.266 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:06:31.266 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:31.267 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:31.268 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:31.269 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:31.269 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:31.270 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:31.271 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:06:31.271 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:06:31.272 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 9.5920ms
2023-04-04 11:06:31.273 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.1866ms
2023-04-04 11:06:31.275 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:06:31.276 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.277 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.278 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.279 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:31.280 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:31.281 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:31.324 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:06:31.327 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:06:31.333 +04:00 [DBG] Authorization was successful.
2023-04-04 11:06:31.335 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.342 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:06:31.344 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:06:31.346 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:06:31.347 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:06:31.349 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:06:31.351 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:06:31.353 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:31.356 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:31.373 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:06:31.376 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-04 11:06:31.380 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 11:06:31.392 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 11:06:31.396 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:06:31.398 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:06:31.399 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-04 11:06:31.400 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-04 11:06:31.402 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-04 11:06:31.403 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.406 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.408 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:06:31.415 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:06:31.418 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.420 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.422 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.424 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.425 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-04-04 11:06:31.427 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.428 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 11:06:31.430 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:06:31.433 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:06:31.434 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:06:31.435 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:06:31.436 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:06:31.438 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:06:31.443 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 90.0868ms
2023-04-04 11:06:31.444 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:06:31.444 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.445 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.446 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:06:31.447 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:06:31.448 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.449 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.451 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-04-04 11:06:31.451 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:06:31.453 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 178.1324ms
2023-04-04 11:06:31.454 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:06:31.455 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:06:31.459 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:06:31.459 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:06:31.462 +04:00 [DBG] Authorization was successful.
2023-04-04 11:06:31.464 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.465 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:06:31.466 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:06:31.467 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:06:31.468 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:06:31.470 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:06:31.471 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:06:31.472 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:31.474 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:06:31.513 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:06:31.519 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:06:31.520 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:06:31.521 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-04 11:06:31.522 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-04 11:06:31.523 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-04 11:06:31.524 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.525 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.526 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:06:31.531 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:06:31.534 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.535 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.537 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:06:31.538 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.539 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-04 11:06:31.540 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.541 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 11:06:31.543 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:06:31.545 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:06:31.546 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:06:31.546 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:06:31.547 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:06:31.548 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:06:31.550 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 77.5567ms
2023-04-04 11:06:31.551 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:06:31.552 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:06:31.553 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:06:31.554 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 11:06:31.555 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 111.3318ms
2023-04-04 11:06:31.831 +04:00 [DBG] Connection id "0HMPKRC851VRO" received FIN.
2023-04-04 11:06:31.833 +04:00 [DBG] Connection id "0HMPKRC851VRO" is closed. The last processed stream ID was 7.
2023-04-04 11:06:31.833 +04:00 [DBG] The connection queue processing loop for 0HMPKRC851VRO completed.
2023-04-04 11:06:31.834 +04:00 [DBG] Connection id "0HMPKRC851VRO" sending FIN because: "The client closed the connection."
2023-04-04 11:06:31.846 +04:00 [DBG] Connection id "0HMPKRC851VRO" stopped.
2023-04-04 11:32:29.756 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-04 11:32:29.817 +04:00 [DBG] Hosting starting
2023-04-04 11:32:29.837 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-04 11:32:29.843 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-04 11:32:29.850 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-04 11:32:29.854 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-04 11:32:29.858 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-04 11:32:29.863 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-04 11:32:29.866 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 11:32:29.869 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-04 11:32:29.871 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 11:32:29.875 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-04 11:32:29.879 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-04 11:32:29.882 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-04 11:32:29.884 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-04 11:32:29.974 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-04 11:32:29.976 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-04 11:32:29.977 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-04 11:32:29.978 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-04 11:32:29.978 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-04 11:32:29.979 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-04 11:32:29.980 +04:00 [INF] Hosting environment: Development
2023-04-04 11:32:29.981 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-04 11:32:29.981 +04:00 [DBG] Hosting started
2023-04-04 11:32:30.321 +04:00 [DBG] Connection id "0HMPKRQVNTVPP" accepted.
2023-04-04 11:32:30.322 +04:00 [DBG] Connection id "0HMPKRQVNTVPP" started.
2023-04-04 11:32:30.333 +04:00 [DBG] Connection id "0HMPKRQVNTVPP" received FIN.
2023-04-04 11:32:30.333 +04:00 [DBG] Connection id "0HMPKRQVNTVPQ" received FIN.
2023-04-04 11:32:30.335 +04:00 [DBG] Connection id "0HMPKRQVNTVPQ" accepted.
2023-04-04 11:32:30.336 +04:00 [DBG] Connection id "0HMPKRQVNTVPQ" started.
2023-04-04 11:32:30.337 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 11:32:30.337 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 11:32:30.365 +04:00 [DBG] Connection id "0HMPKRQVNTVPQ" stopped.
2023-04-04 11:32:30.365 +04:00 [DBG] Connection id "0HMPKRQVNTVPP" stopped.
2023-04-04 11:32:30.368 +04:00 [DBG] Connection id "0HMPKRQVNTVPP" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 11:32:30.368 +04:00 [DBG] Connection id "0HMPKRQVNTVPQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 11:32:30.482 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" accepted.
2023-04-04 11:32:30.484 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" started.
2023-04-04 11:32:30.514 +04:00 [DBG] Connection 0HMPKRQVNTVPR established using the following protocol: "Tls12"
2023-04-04 11:32:30.553 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-04 11:32:30.567 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-04 11:32:30.585 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-04 11:32:30.586 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:32:30.722 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-04 11:32:30.733 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-04 11:32:30.736 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 183.9338ms
2023-04-04 11:32:30.751 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-04 11:32:30.756 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 3.8534ms
2023-04-04 11:32:30.774 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-04 11:32:30.793 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 18.5316ms
2023-04-04 11:32:30.955 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-04 11:32:30.957 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-04 11:32:30.958 +04:00 [DBG] Request did not match any endpoints
2023-04-04 11:32:31.035 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 80.6117ms
2023-04-04 11:32:36.917 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" accepted.
2023-04-04 11:32:36.918 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" started.
2023-04-04 11:32:36.922 +04:00 [DBG] Connection 0HMPKRQVNTVPS established using the following protocol: "Tls12"
2023-04-04 11:32:36.924 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-04 11:32:36.929 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 11:32:36.931 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:32:36.933 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:36.935 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:36.936 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:36.937 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:32:36.939 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 14.3912ms
2023-04-04 11:32:36.940 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 48
2023-04-04 11:32:36.942 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 11:32:36.945 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-04 11:32:36.947 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:32:36.948 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:36.949 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:36.950 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:36.968 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-04 11:32:36.972 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:32:36.988 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:32:36.991 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:32:36.993 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:32:36.994 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:32:36.996 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:32:36.997 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:32:36.999 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:37.072 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-04 11:32:37.090 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:37.097 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 11:32:37.100 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-04 11:32:37.102 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-04 11:32:37.106 +04:00 [DBG] Connection id "0HMPKRQVNTVPS", Request id "0HMPKRQVNTVPS:00000003": started reading request body.
2023-04-04 11:32:37.108 +04:00 [DBG] Connection id "0HMPKRQVNTVPS", Request id "0HMPKRQVNTVPS:00000003": done reading request body.
2023-04-04 11:32:37.111 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-04 11:32:37.113 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:32:37.114 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:32:37.115 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 11:32:37.121 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 11:32:37.468 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-04 11:32:37.471 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-04 11:32:37.719 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:32:37.786 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-04 11:32:37.837 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 11:32:37.936 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 11:32:37.967 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:32:37.969 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:32:37.986 +04:00 [DBG] Created DbConnection. (14ms).
2023-04-04 11:32:37.992 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (23ms).
2023-04-04 11:32:38.001 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (34ms).
2023-04-04 11:32:38.005 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:39.605 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:39.613 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 11:32:39.650 +04:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 11:32:39.673 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:39.712 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:39.719 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:39.731 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:39.737 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 79ms reading results.
2023-04-04 11:32:39.741 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:39.746 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-04 11:32:39.807 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:32:39.811 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:32:39.812 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:32:39.812 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:32:39.814 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:32:39.815 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:32:39.825 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 2825.0179ms
2023-04-04 11:32:39.827 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 11:32:39.830 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:32:39.833 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:39.835 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 11:32:39.836 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 48 - 200 - application/json;+charset=utf-8 2896.2824ms
2023-04-04 11:32:48.334 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:32:48.334 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:32:48.335 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.336 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.337 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:32:48.338 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:32:48.339 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:48.341 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:48.343 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:48.343 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:48.345 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:48.346 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:48.347 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:32:48.347 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:32:48.348 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.3297ms
2023-04-04 11:32:48.349 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 14.4281ms
2023-04-04 11:32:48.361 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:32:48.362 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.364 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.365 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.365 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:48.366 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:48.367 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:48.393 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:32:48.396 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:32:48.401 +04:00 [DBG] Authorization was successful.
2023-04-04 11:32:48.402 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.406 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:32:48.407 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:32:48.408 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:32:48.409 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:32:48.411 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:32:48.412 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:32:48.414 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:48.415 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:48.425 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:32:48.428 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-04 11:32:48.430 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 11:32:48.436 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 11:32:48.439 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:32:48.440 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:32:48.441 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 11:32:48.441 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-04 11:32:48.442 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-04 11:32:48.443 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.445 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.447 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:32:48.452 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:32:48.454 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.455 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.456 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.457 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.458 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-04 11:32:48.460 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.461 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 11:32:48.463 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:32:48.465 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:32:48.465 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:32:48.466 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:32:48.467 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:32:48.468 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:32:48.471 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 57.2681ms
2023-04-04 11:32:48.472 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.472 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:32:48.473 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:32:48.474 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.475 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.476 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:32:48.477 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 11:32:48.478 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.479 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 118.8733ms
2023-04-04 11:32:48.480 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:32:48.481 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:32:48.482 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:32:48.485 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:32:48.485 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:32:48.487 +04:00 [DBG] Authorization was successful.
2023-04-04 11:32:48.488 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.489 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:32:48.490 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:32:48.491 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:32:48.492 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:32:48.494 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:32:48.495 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:32:48.496 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:48.498 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:32:48.537 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:32:48.544 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:32:48.545 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:32:48.547 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-04 11:32:48.548 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2023-04-04 11:32:48.549 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-04 11:32:48.550 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.551 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.552 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:32:48.554 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:32:48.556 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.557 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.557 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:32:48.558 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.559 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-04 11:32:48.562 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.563 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 11:32:48.564 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:32:48.566 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:32:48.566 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:32:48.567 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:32:48.567 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:32:48.569 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:32:48.570 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 73.4809ms
2023-04-04 11:32:48.570 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:32:48.571 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:32:48.572 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:32:48.573 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-04 11:32:48.574 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 101.8566ms
2023-04-04 11:34:43.107 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" is closing.
2023-04-04 11:34:43.108 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" is closed. The last processed stream ID was 7.
2023-04-04 11:34:43.111 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" received FIN.
2023-04-04 11:34:43.112 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" sending FIN because: "The client closed the connection."
2023-04-04 11:34:43.125 +04:00 [DBG] The connection queue processing loop for 0HMPKRQVNTVPR completed.
2023-04-04 11:34:43.128 +04:00 [DBG] Connection id "0HMPKRQVNTVPR" stopped.
2023-04-04 11:35:00.225 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" is closing.
2023-04-04 11:35:00.228 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" is closed. The last processed stream ID was 11.
2023-04-04 11:35:00.230 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" received FIN.
2023-04-04 11:35:00.230 +04:00 [DBG] The connection queue processing loop for 0HMPKRQVNTVPS completed.
2023-04-04 11:35:00.231 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" sending FIN because: "The client closed the connection."
2023-04-04 11:35:00.241 +04:00 [DBG] Connection id "0HMPKRQVNTVPS" stopped.
2023-04-04 11:39:43.231 +04:00 [DBG] Connection id "0HMPKRQVNTVPT" accepted.
2023-04-04 11:39:43.233 +04:00 [DBG] Connection id "0HMPKRQVNTVPT" started.
2023-04-04 11:39:43.235 +04:00 [DBG] Connection 0HMPKRQVNTVPT established using the following protocol: "Tls12"
2023-04-04 11:39:43.236 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:39:43.236 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:39:43.237 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.239 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.240 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:39:43.241 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:39:43.241 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:39:43.242 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:39:43.243 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:39:43.243 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:39:43.244 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:39:43.245 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:39:43.245 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:39:43.246 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:39:43.246 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.0205ms
2023-04-04 11:39:43.247 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.9394ms
2023-04-04 11:39:43.248 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:39:43.249 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.250 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.251 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.252 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:39:43.253 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:39:43.254 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:39:43.255 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:39:43.256 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:39:43.256 +04:00 [DBG] Authorization was successful.
2023-04-04 11:39:43.257 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.258 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:39:43.259 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:39:43.260 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:39:43.261 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:39:43.262 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:39:43.263 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:39:43.264 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:39:43.265 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:39:43.267 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:39:43.269 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:39:43.270 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:39:43.272 +04:00 [DBG] Created DbConnection. (1ms).
2023-04-04 11:39:43.273 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-04 11:39:43.274 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-04 11:39:43.274 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.345 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.346 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:39:43.354 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:39:43.356 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.357 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.358 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.359 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.360 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-04 11:39:43.361 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.362 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 11:39:43.363 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:39:43.365 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:39:43.366 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:39:43.366 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:39:43.367 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:39:43.368 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:39:43.369 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 105.2057ms
2023-04-04 11:39:43.371 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.371 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:39:43.372 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:39:43.373 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.373 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.374 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:39:43.375 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 11:39:43.376 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.378 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 129.1234ms
2023-04-04 11:39:43.379 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:39:43.380 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:39:43.380 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:39:43.381 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:39:43.382 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:39:43.382 +04:00 [DBG] Authorization was successful.
2023-04-04 11:39:43.383 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.384 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:39:43.385 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:39:43.386 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:39:43.388 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:39:43.389 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:39:43.390 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:39:43.391 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:39:43.393 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:39:43.394 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:39:43.396 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:39:43.396 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:39:43.397 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 11:39:43.397 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-04 11:39:43.398 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-04 11:39:43.399 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.400 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.401 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:39:43.403 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:39:43.406 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.407 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.408 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:39:43.409 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.410 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-04 11:39:43.411 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.412 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 11:39:43.413 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:39:43.415 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:39:43.415 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:39:43.416 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:39:43.417 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:39:43.418 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:39:43.419 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 27.1946ms
2023-04-04 11:39:43.420 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:39:43.421 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:39:43.422 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:39:43.423 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-04 11:39:43.424 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 53.3086ms
2023-04-04 11:40:13.156 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:40:13.157 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:40:13.157 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.158 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.159 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:40:13.160 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 11:40:13.161 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:40:13.161 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:40:13.162 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:40:13.163 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:40:13.163 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:40:13.164 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:40:13.165 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:40:13.165 +04:00 [DBG] The request is a preflight request.
2023-04-04 11:40:13.166 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 9.7212ms
2023-04-04 11:40:13.167 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 10.1118ms
2023-04-04 11:40:13.168 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:40:13.169 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.170 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.171 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.172 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:40:13.173 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:40:13.173 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:40:13.174 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:40:13.175 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:40:13.176 +04:00 [DBG] Authorization was successful.
2023-04-04 11:40:13.176 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.177 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:40:13.179 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:40:13.180 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:40:13.180 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:40:13.182 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:40:13.183 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:40:13.184 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:40:13.185 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:40:13.186 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:40:13.188 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:40:13.189 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:40:13.189 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 11:40:13.190 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-04 11:40:13.190 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-04 11:40:13.191 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.192 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.193 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:40:13.195 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:40:13.197 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.198 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.199 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.200 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.201 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-04 11:40:13.202 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.203 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 11:40:13.205 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:40:13.206 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:40:13.207 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:40:13.207 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:40:13.208 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:40:13.209 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:40:13.210 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 26.0708ms
2023-04-04 11:40:13.211 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 11:40:13.212 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.212 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.213 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:40:13.214 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 11:40:13.215 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.216 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.216 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 11:40:13.217 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 11:40:13.218 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 50.2439ms
2023-04-04 11:40:13.219 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 11:40:13.220 +04:00 [INF] CORS policy execution successful.
2023-04-04 11:40:13.221 +04:00 [DBG] Successfully validated the token.
2023-04-04 11:40:13.222 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 11:40:13.223 +04:00 [DBG] Authorization was successful.
2023-04-04 11:40:13.223 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.224 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 11:40:13.225 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 11:40:13.226 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 11:40:13.227 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 11:40:13.229 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 11:40:13.230 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 11:40:13.231 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:40:13.231 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 11:40:13.233 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 11:40:13.234 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 11:40:13.235 +04:00 [DBG] Creating DbConnection.
2023-04-04 11:40:13.235 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 11:40:13.236 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-04 11:40:13.237 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-04 11:40:13.238 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.239 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.240 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:40:13.242 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 11:40:13.245 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.246 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.247 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 11:40:13.248 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.248 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-04-04 11:40:13.249 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.250 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 11:40:13.251 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 11:40:13.253 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 11:40:13.254 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 11:40:13.255 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 11:40:13.255 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 11:40:13.256 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 11:40:13.257 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 26.4513ms
2023-04-04 11:40:13.258 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 11:40:13.259 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 11:40:13.260 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 11:40:13.261 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-04 11:40:13.262 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 50.7909ms
2023-04-04 12:09:18.178 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-04-04 12:09:18.241 +04:00 [DBG] Hosting starting
2023-04-04 12:09:18.259 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-04-04 12:09:18.265 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-04-04 12:09:18.271 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-04-04 12:09:18.275 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-04-04 12:09:18.278 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-04-04 12:09:18.283 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-04-04 12:09:18.286 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 12:09:18.288 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-04-04 12:09:18.290 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-04-04 12:09:18.294 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-04-04 12:09:18.298 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-04-04 12:09:18.302 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-04-04 12:09:18.303 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-04-04 12:09:18.396 +04:00 [INF] Now listening on: https://localhost:7261
2023-04-04 12:09:18.397 +04:00 [INF] Now listening on: http://localhost:5059
2023-04-04 12:09:18.398 +04:00 [DBG] Loaded hosting startup assembly BankSystem.Atm.Api
2023-04-04 12:09:18.398 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-04-04 12:09:18.399 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-04-04 12:09:18.400 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-04-04 12:09:18.401 +04:00 [INF] Hosting environment: Development
2023-04-04 12:09:18.401 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api
2023-04-04 12:09:18.402 +04:00 [DBG] Hosting started
2023-04-04 12:09:18.818 +04:00 [DBG] Connection id "0HMPKSFHTPMJB" accepted.
2023-04-04 12:09:18.820 +04:00 [DBG] Connection id "0HMPKSFHTPMJB" started.
2023-04-04 12:09:18.827 +04:00 [DBG] Connection id "0HMPKSFHTPMJC" received FIN.
2023-04-04 12:09:18.827 +04:00 [DBG] Connection id "0HMPKSFHTPMJB" received FIN.
2023-04-04 12:09:18.829 +04:00 [DBG] Connection id "0HMPKSFHTPMJC" accepted.
2023-04-04 12:09:18.831 +04:00 [DBG] Connection id "0HMPKSFHTPMJC" started.
2023-04-04 12:09:18.833 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 12:09:18.833 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-04-04 12:09:18.851 +04:00 [DBG] Connection id "0HMPKSFHTPMJC" stopped.
2023-04-04 12:09:18.851 +04:00 [DBG] Connection id "0HMPKSFHTPMJB" stopped.
2023-04-04 12:09:18.852 +04:00 [DBG] Connection id "0HMPKSFHTPMJC" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 12:09:18.853 +04:00 [DBG] Connection id "0HMPKSFHTPMJB" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-04-04 12:09:18.965 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" accepted.
2023-04-04 12:09:18.966 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" started.
2023-04-04 12:09:18.998 +04:00 [DBG] Connection 0HMPKSFHTPMJD established using the following protocol: "Tls12"
2023-04-04 12:09:19.033 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-04-04 12:09:19.047 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-04-04 12:09:19.062 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-04-04 12:09:19.064 +04:00 [DBG] Request did not match any endpoints
2023-04-04 12:09:19.184 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-04-04 12:09:19.195 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-04-04 12:09:19.198 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 165.7924ms
2023-04-04 12:09:19.210 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-04-04 12:09:19.214 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 12006 application/javascript;+charset=utf-8 3.7941ms
2023-04-04 12:09:19.232 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-04-04 12:09:19.246 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 13.7813ms
2023-04-04 12:09:19.333 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-04-04 12:09:19.335 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-04-04 12:09:19.336 +04:00 [DBG] Request did not match any endpoints
2023-04-04 12:09:19.416 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 83.1201ms
2023-04-04 12:09:20.797 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" accepted.
2023-04-04 12:09:20.799 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" started.
2023-04-04 12:09:20.804 +04:00 [DBG] Connection 0HMPKSFHTPMJE established using the following protocol: "Tls12"
2023-04-04 12:09:20.808 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/login - -
2023-04-04 12:09:20.811 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 12:09:20.813 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 12:09:20.815 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:20.817 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:20.818 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:20.819 +04:00 [DBG] The request is a preflight request.
2023-04-04 12:09:20.820 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/login - - - 204 - - 12.0142ms
2023-04-04 12:09:20.821 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 48
2023-04-04 12:09:20.823 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-04-04 12:09:20.825 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-04-04 12:09:20.826 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 12:09:20.827 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:20.828 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:20.829 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:20.846 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-04-04 12:09:20.851 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 12:09:20.867 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BankSystem.Atm.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 12:09:20.872 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 12:09:20.873 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 12:09:20.875 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 12:09:20.876 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 12:09:20.877 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 12:09:20.879 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:20.952 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-04-04 12:09:20.969 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:20.975 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 12:09:20.978 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-04-04 12:09:20.980 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-04 12:09:20.984 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:00000003": started reading request body.
2023-04-04 12:09:20.986 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:00000003": done reading request body.
2023-04-04 12:09:20.989 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'
2023-04-04 12:09:20.991 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 12:09:20.992 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 12:09:20.993 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest' ...
2023-04-04 12:09:20.998 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.LoginRequest'.
2023-04-04 12:09:21.282 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-04-04 12:09:21.284 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-04-04 12:09:21.505 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 12:09:21.554 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && c.Pin == __request_Pin_1)'
2023-04-04 12:09:21.598 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 12:09:21.700 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 12:09:21.728 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:21.731 +04:00 [DBG] Creating DbConnection.
2023-04-04 12:09:21.745 +04:00 [DBG] Created DbConnection. (12ms).
2023-04-04 12:09:21.751 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (21ms).
2023-04-04 12:09:21.758 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (29ms).
2023-04-04 12:09:21.762 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:23.330 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:23.338 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 12:09:23.385 +04:00 [INF] Executed DbCommand (47ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-04-04 12:09:23.411 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:23.443 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:23.450 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:23.463 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:23.468 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 77ms reading results.
2023-04-04 12:09:23.472 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:23.477 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-04-04 12:09:23.554 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 12:09:23.558 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 12:09:23.559 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 12:09:23.560 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 12:09:23.561 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 12:09:23.562 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 12:09:23.572 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api) in 2692.2669ms
2023-04-04 12:09:23.574 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (BankSystem.Atm.Api)'
2023-04-04 12:09:23.577 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 12:09:23.580 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:23.582 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 12:09:23.584 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 48 - 200 - application/json;+charset=utf-8 2763.4924ms
2023-04-04 12:09:29.894 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 12:09:29.895 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - -
2023-04-04 12:09:29.896 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 12:09:29.896 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 12:09:29.897 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 12:09:29.898 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 12:09:29.899 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:29.900 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:29.908 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:29.908 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:29.909 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:29.910 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:29.911 +04:00 [DBG] The request is a preflight request.
2023-04-04 12:09:29.911 +04:00 [DBG] The request is a preflight request.
2023-04-04 12:09:29.912 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 17.5577ms
2023-04-04 12:09:29.913 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Card/see-balance - - - 204 - - 18.1048ms
2023-04-04 12:09:29.914 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 12:09:29.915 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 12:09:29.916 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 12:09:29.917 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:29.918 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:29.919 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:29.920 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:29.949 +04:00 [DBG] Successfully validated the token.
2023-04-04 12:09:29.951 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 12:09:29.955 +04:00 [DBG] Authorization was successful.
2023-04-04 12:09:29.956 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:29.961 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 12:09:29.963 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 12:09:29.964 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 12:09:29.966 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 12:09:29.967 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 12:09:29.968 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 12:09:29.970 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:29.972 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:29.982 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 12:09:29.984 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-04-04 12:09:29.986 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-04-04 12:09:29.992 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (string), 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (string), 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 12:09:29.996 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:29.997 +04:00 [DBG] Creating DbConnection.
2023-04-04 12:09:29.998 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 12:09:29.998 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-04 12:09:29.999 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-04 12:09:30.000 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.002 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.003 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:30.008 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:30.011 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.013 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.015 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.016 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.017 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-04 12:09:30.018 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.019 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 12:09:30.020 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 12:09:30.022 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 12:09:30.023 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 12:09:30.023 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 12:09:30.025 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 12:09:30.026 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 12:09:30.030 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 60.475ms
2023-04-04 12:09:30.032 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-04-04 12:09:30.032 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:30.033 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-04-04 12:09:30.034 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 12:09:30.035 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-04-04 12:09:30.036 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.037 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:30.038 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 12:09:30.038 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:30.039 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 125.1170ms
2023-04-04 12:09:30.040 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:30.042 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:30.044 +04:00 [DBG] Successfully validated the token.
2023-04-04 12:09:30.045 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 12:09:30.047 +04:00 [DBG] Authorization was successful.
2023-04-04 12:09:30.049 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:30.050 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api).
2023-04-04 12:09:30.051 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 12:09:30.052 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 12:09:30.053 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 12:09:30.055 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 12:09:30.056 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 12:09:30.057 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:30.060 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (BankSystem.Atm.Api)
2023-04-04 12:09:30.097 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 12:09:30.103 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:30.104 +04:00 [DBG] Creating DbConnection.
2023-04-04 12:09:30.105 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 12:09:30.106 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-04-04 12:09:30.108 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-04-04 12:09:30.109 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.110 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.111 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:30.113 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:30.115 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.116 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.117 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:30.119 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.120 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 4ms reading results.
2023-04-04 12:09:30.121 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.122 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 12:09:30.124 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 12:09:30.126 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 12:09:30.127 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 12:09:30.127 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 12:09:30.128 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 12:09:30.129 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 12:09:30.130 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api) in 73.1866ms
2023-04-04 12:09:30.131 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (BankSystem.Atm.Api)'
2023-04-04 12:09:30.132 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 12:09:30.133 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:30.134 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-04-04 12:09:30.135 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 103.8902ms
2023-04-04 12:09:40.239 +04:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - -
2023-04-04 12:09:40.241 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-04 12:09:40.243 +04:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2023-04-04 12:09:40.243 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:40.244 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:40.245 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:40.246 +04:00 [DBG] The request is a preflight request.
2023-04-04 12:09:40.246 +04:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7261/api/Transaction/cash-out - - - 204 - - 6.9930ms
2023-04-04 12:09:40.248 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26
2023-04-04 12:09:40.249 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-04 12:09:40.249 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-04 12:09:40.251 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:40.252 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:40.252 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:40.253 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:40.254 +04:00 [DBG] Successfully validated the token.
2023-04-04 12:09:40.255 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 12:09:40.255 +04:00 [DBG] Authorization was successful.
2023-04-04 12:09:40.256 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:40.259 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-04 12:09:40.261 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 12:09:40.262 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 12:09:40.263 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 12:09:40.265 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 12:09:40.266 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 12:09:40.267 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-04 12:09:40.268 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-04 12:09:40.270 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-04 12:09:40.271 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-04 12:09:40.272 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-04 12:09:40.277 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:0000000F": started reading request body.
2023-04-04 12:09:40.279 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:0000000F": done reading request body.
2023-04-04 12:09:40.294 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-04 12:09:40.296 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:40.297 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:40.298 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-04 12:09:40.303 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:40.306 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 39.7326ms
2023-04-04 12:09:40.308 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:40.357 +04:00 [ERR] Invalid cash out amount. Please enter amount that is a multiple of 5, except zero such as 5, 10, 15, etc. 
System.ArgumentException: Invalid cash out amount. Please enter amount that is a multiple of 5, except zero such as 5, 10, 15, etc. 
   at BankSystem.Atm.Services.Models.Requests.CashOutRequest.Validate() in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm\Models\Requests\CashOutRequest.cs:line 15
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Controllers\TransactionController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystemMain\BankSystemCopy\Atm.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 46
2023-04-04 12:09:40.423 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26 - 1 - application/json 175.5451ms
2023-04-04 12:09:44.991 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26
2023-04-04 12:09:44.992 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-04-04 12:09:44.994 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-04-04 12:09:44.996 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:44.997 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-04-04 12:09:44.998 +04:00 [DBG] The request has an origin header: 'http://localhost:3000'.
2023-04-04 12:09:44.999 +04:00 [INF] CORS policy execution successful.
2023-04-04 12:09:45.000 +04:00 [DBG] Successfully validated the token.
2023-04-04 12:09:45.001 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-04-04 12:09:45.001 +04:00 [DBG] Authorization was successful.
2023-04-04 12:09:45.002 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:45.003 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(BankSystem.Atm.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api).
2023-04-04 12:09:45.005 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-04-04 12:09:45.006 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-04-04 12:09:45.008 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-04-04 12:09:45.010 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-04-04 12:09:45.011 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-04-04 12:09:45.012 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-04 12:09:45.014 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (BankSystem.Atm.Api)
2023-04-04 12:09:45.015 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-04 12:09:45.016 +04:00 [DBG] Attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-04-04 12:09:45.017 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-04-04 12:09:45.019 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:00000011": started reading request body.
2023-04-04 12:09:45.020 +04:00 [DBG] Connection id "0HMPKSFHTPMJE", Request id "0HMPKSFHTPMJE:00000011": done reading request body.
2023-04-04 12:09:45.021 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'
2023-04-04 12:09:45.022 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:45.023 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:45.025 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest' ...
2023-04-04 12:09:45.027 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'BankSystem.Atm.Services.Models.Requests.CashOutRequest'.
2023-04-04 12:09:45.031 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-04-04 12:09:45.034 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-04-04 12:09:45.038 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-04 12:09:45.042 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:45.043 +04:00 [DBG] Creating DbConnection.
2023-04-04 12:09:45.044 +04:00 [DBG] Created DbConnection. (0ms).
2023-04-04 12:09:45.045 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-04-04 12:09:45.046 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-04-04 12:09:45.047 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.048 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.049 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-04 12:09:45.053 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-04-04 12:09:45.058 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.071 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.074 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.076 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.077 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.078 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.079 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.081 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.082 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.083 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.084 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.086 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.087 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.088 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.090 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.091 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.093 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.094 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.095 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.096 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.097 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.098 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.099 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.100 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.102 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.103 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.104 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.106 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.108 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.109 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.110 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.111 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.112 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.114 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.115 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.116 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.117 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.118 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.121 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.122 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.123 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.127 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.128 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.130 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.131 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 76ms reading results.
2023-04-04 12:09:45.133 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.134 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 12:09:45.144 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .ThenInclude(a => a.UserEntity)
    .Where(c => c.Id == __cardId_0)
    .Select(c => new CardEntityDto{ 
        AccountId = c.Account.Id, 
        AccountOwnerEmail = c.Account.UserEntity.Email, 
        AccountCurrency = c.Account.Currency, 
        AccountIban = c.Account.Iban 
    }
    )
    .FirstOrDefault()'
2023-04-04 12:09:45.157 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntityDto>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntityDto>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                AccountId -> 0
                AccountOwnerEmail -> 1
                AccountCurrency -> 2
                AccountIban -> 3
            SELECT TOP(1) a.Id AS AccountId, a0.Email AS AccountOwnerEmail, a.Currency AS AccountCurrency, a.Iban AS AccountIban
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntityDto>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 12:09:45.161 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:45.162 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-04 12:09:45.163 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-04 12:09:45.164 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.165 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.166 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id] AS [AccountId], [a0].[Email] AS [AccountOwnerEmail], [a].[Currency] AS [AccountCurrency], [a].[Iban] AS [AccountIban]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:45.171 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id] AS [AccountId], [a0].[Email] AS [AccountOwnerEmail], [a].[Currency] AS [AccountCurrency], [a].[Iban] AS [AccountIban]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [c].[Id] = @__cardId_0
2023-04-04 12:09:45.175 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.176 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-04 12:09:45.178 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.179 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 12:09:45.184 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt.Date == DateTime.Now.Date && (int)t.TransactionType == 0)'
2023-04-04 12:09:45.195 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromIban (string), 1], [Property: TransactionEntity.AccountFromId (Guid?), 2], [Property: TransactionEntity.AccountToIban (string), 3], [Property: TransactionEntity.AccountToId (Guid?), 4], [Property: TransactionEntity.CreatedAt (DateTime) Required, 5], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 6], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 7], [Property: TransactionEntity.Fee (decimal) Required, 8], [Property: TransactionEntity.ReceivedAmount (decimal) Required, 9], [Property: TransactionEntity.TransactionType (TransactionType) Required, 10], [Property: TransactionEntity.WithDrawnAmount (decimal) Required, 11] }
        SELECT t.Id, t.AccountFromIban, t.AccountFromId, t.AccountToIban, t.AccountToId, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.ReceivedAmount, t.TransactionType, t.WithDrawnAmount
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (CONVERT(date, t.CreatedAt) == CONVERT(date, GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-04-04 12:09:45.201 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:45.202 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-04 12:09:45.203 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-04-04 12:09:45.204 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.205 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.206 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-04 12:09:45.211 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromIban], [t].[AccountFromId], [t].[AccountToIban], [t].[AccountToId], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[ReceivedAmount], [t].[TransactionType], [t].[WithDrawnAmount]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND CONVERT(date, [t].[CreatedAt]) = CONVERT(date, GETDATE()) AND [t].[TransactionType] = 0
2023-04-04 12:09:45.213 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.214 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-04-04 12:09:45.216 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.217 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 12:09:45.224 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .FirstOrDefault(a => a.Id == __accountId_0)'
2023-04-04 12:09:45.230 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AccountEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
            SELECT TOP(1) a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Accounts AS a
            WHERE a.Id == @__accountId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-04-04 12:09:45.233 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:45.234 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-04-04 12:09:45.235 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-04-04 12:09:45.236 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.237 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.238 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Accounts] AS [a]
WHERE [a].[Id] = @__accountId_0
2023-04-04 12:09:45.241 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Accounts] AS [a]
WHERE [a].[Id] = @__accountId_0
2023-04-04 12:09:45.244 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.245 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.246 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 2ms reading results.
2023-04-04 12:09:45.247 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.248 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-04-04 12:09:45.255 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.287 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.301 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.305 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-04-04 12:09:45.308 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-04-04 12:09:45.333 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-04-04 12:09:45.389 +04:00 [DBG] Executing 3 update commands as a batch.
2023-04-04 12:09:45.394 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.395 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.397 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-04-04 12:09:45.403 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-04-04 12:09:45.407 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-04-04 12:09:45.408 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-04-04 12:09:45.412 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-04-04 12:09:45.413 +04:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-04 12:09:45.427 +04:00 [INF] Executed DbCommand (13ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Guid), @p12='?' (Size = 4000), @p13='?' (DbType = Guid), @p14='?' (Size = 4000), @p15='?' (DbType = Guid), @p16='?' (DbType = DateTime2), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p20='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (Precision = 18) (Scale = 3) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0, [Currency] = @p1, [Iban] = @p2, [UserId] = @p3
OUTPUT 1
WHERE [Id] = @p4;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p5, @p6, @p7, @p8, @p9, @p10);
INSERT INTO [Transactions] ([Id], [AccountFromIban], [AccountFromId], [AccountToIban], [AccountToId], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [ReceivedAmount], [TransactionType], [WithDrawnAmount])
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2023-04-04 12:09:45.432 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.434 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-04-04 12:09:45.438 +04:00 [DBG] Committing transaction.
2023-04-04 12:09:45.442 +04:00 [DBG] Committed transaction.
2023-04-04 12:09:45.444 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.445 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-04-04 12:09:45.448 +04:00 [DBG] Disposing transaction.
2023-04-04 12:09:45.451 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.454 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.456 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-04-04 12:09:45.460 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-04-04 12:09:45.461 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-04-04 12:09:45.463 +04:00 [DBG] No information found on request to perform content negotiation.
2023-04-04 12:09:45.464 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-04-04 12:09:45.464 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-04-04 12:09:45.465 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-04-04 12:09:45.466 +04:00 [INF] Executing OkObjectResult, writing value of type 'BankSystem.Common.Models.HttpResult'.
2023-04-04 12:09:45.472 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api) in 460.2829ms
2023-04-04 12:09:45.475 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (BankSystem.Atm.Api)'
2023-04-04 12:09:45.476 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-04-04 12:09:45.477 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-04-04 12:09:45.478 +04:00 [DBG] Disposed connection to database '' on server '' (0ms).
2023-04-04 12:09:45.478 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Transaction/cash-out application/json 26 - 200 - application/json;+charset=utf-8 487.9763ms
2023-04-04 12:10:07.520 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" received FIN.
2023-04-04 12:10:07.520 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" received FIN.
2023-04-04 12:10:07.524 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" sending FIN because: "The client closed the connection."
2023-04-04 12:10:07.524 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" sending FIN because: "The client closed the connection."
2023-04-04 12:10:07.525 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" is closed. The last processed stream ID was 7.
2023-04-04 12:10:07.525 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" is closed. The last processed stream ID was 17.
2023-04-04 12:10:07.528 +04:00 [DBG] The connection queue processing loop for 0HMPKSFHTPMJD completed.
2023-04-04 12:10:07.529 +04:00 [DBG] The connection queue processing loop for 0HMPKSFHTPMJE completed.
2023-04-04 12:10:07.532 +04:00 [DBG] Connection id "0HMPKSFHTPMJD" stopped.
2023-04-04 12:10:07.532 +04:00 [DBG] Connection id "0HMPKSFHTPMJE" stopped.
