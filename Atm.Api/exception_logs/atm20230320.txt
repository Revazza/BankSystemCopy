2023-03-20 15:02:05.929 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 15:02:06.011 +04:00 [DBG] Hosting starting
2023-03-20 15:02:06.045 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 15:02:06.054 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 15:02:06.060 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 15:02:06.065 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 15:02:06.071 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 15:02:06.080 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 15:02:06.085 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:02:06.088 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 15:02:06.091 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:02:06.096 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 15:02:06.102 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 15:02:06.106 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 15:02:06.108 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 15:02:06.227 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 15:02:06.228 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 15:02:06.229 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 15:02:06.230 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 15:02:06.231 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 15:02:06.232 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 15:02:06.233 +04:00 [INF] Hosting environment: Development
2023-03-20 15:02:06.234 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 15:02:06.235 +04:00 [DBG] Hosting started
2023-03-20 15:02:06.239 +04:00 [DBG] Connection id "0HMP96A5I2V7G" accepted.
2023-03-20 15:02:06.241 +04:00 [DBG] Connection id "0HMP96A5I2V7G" started.
2023-03-20 15:02:06.258 +04:00 [DBG] Connection id "0HMP96A5I2V7G" received FIN.
2023-03-20 15:02:06.265 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:02:06.290 +04:00 [DBG] Connection id "0HMP96A5I2V7G" stopped.
2023-03-20 15:02:06.293 +04:00 [DBG] Connection id "0HMP96A5I2V7G" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:02:07.012 +04:00 [DBG] Connection id "0HMP96A5I2V7H" accepted.
2023-03-20 15:02:07.013 +04:00 [DBG] Connection id "0HMP96A5I2V7H" started.
2023-03-20 15:02:07.061 +04:00 [DBG] Connection 0HMP96A5I2V7H established using the following protocol: "Tls12"
2023-03-20 15:02:07.290 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 15:02:07.321 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 15:02:07.358 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 15:02:07.360 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:02:08.210 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 15:02:08.246 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 15:02:08.251 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 964.3176ms
2023-03-20 15:02:08.283 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 15:02:08.290 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.7899ms
2023-03-20 15:02:08.322 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 15:02:08.404 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 82.3421ms
2023-03-20 15:02:08.511 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 15:02:08.518 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 15:02:08.520 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:02:08.641 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 130.1923ms
2023-03-20 15:02:14.815 +04:00 [DBG] Connection id "0HMP96A5I2V7H" received FIN.
2023-03-20 15:02:14.819 +04:00 [DBG] The connection queue processing loop for 0HMP96A5I2V7H completed.
2023-03-20 15:02:14.822 +04:00 [DBG] Connection id "0HMP96A5I2V7H" is closed. The last processed stream ID was 7.
2023-03-20 15:02:14.824 +04:00 [DBG] Connection id "0HMP96A5I2V7H" sending FIN because: "The client closed the connection."
2023-03-20 15:02:14.831 +04:00 [DBG] Connection id "0HMP96A5I2V7H" stopped.
2023-03-20 15:03:14.246 +04:00 [DBG] Connection id "0HMP96A5I2V7I" accepted.
2023-03-20 15:03:14.248 +04:00 [DBG] Connection id "0HMP96A5I2V7I" received FIN.
2023-03-20 15:03:14.249 +04:00 [DBG] Connection id "0HMP96A5I2V7I" started.
2023-03-20 15:03:14.249 +04:00 [DBG] Connection id "0HMP96A5I2V7J" accepted.
2023-03-20 15:03:14.252 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:03:14.253 +04:00 [DBG] Connection id "0HMP96A5I2V7J" started.
2023-03-20 15:03:14.257 +04:00 [DBG] Connection id "0HMP96A5I2V7I" stopped.
2023-03-20 15:03:14.260 +04:00 [DBG] Connection id "0HMP96A5I2V7I" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:03:14.267 +04:00 [DBG] Connection 0HMP96A5I2V7J established using the following protocol: "Tls12"
2023-03-20 15:03:14.280 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 52
2023-03-20 15:03:14.285 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:03:14.290 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:03:14.293 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:03:14.297 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:03:14.397 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:03:14.407 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:03:14.438 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:03:14.442 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:03:14.443 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:03:14.446 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:03:14.448 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:03:14.449 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:03:14.452 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:03:14.651 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 15:03:14.673 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:03:14.683 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:03:14.686 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:03:14.689 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:03:14.699 +04:00 [DBG] Connection id "0HMP96A5I2V7J", Request id "0HMP96A5I2V7J:00000001": started reading request body.
2023-03-20 15:03:14.700 +04:00 [DBG] Connection id "0HMP96A5I2V7J", Request id "0HMP96A5I2V7J:00000001": done reading request body.
2023-03-20 15:03:14.705 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:03:14.706 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:03:14.708 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:03:14.709 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:03:14.721 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:03:15.473 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 15:03:15.475 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 15:03:15.747 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:03:15.852 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && (int)c.Pin == (int)__request_Pin_1)'
2023-03-20 15:03:15.900 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:03:16.043 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:03:16.085 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:03:16.088 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:03:16.115 +04:00 [DBG] Created DbConnection. (24ms).
2023-03-20 15:03:16.124 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (39ms).
2023-03-20 15:03:16.135 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (51ms).
2023-03-20 15:03:16.140 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:03:16.363 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:03:16.373 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:03:16.446 +04:00 [INF] Executed DbCommand (74ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:03:16.479 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:03:16.525 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:03:16.535 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:03:16.554 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:03:16.562 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 108ms reading results.
2023-03-20 15:03:16.568 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:03:16.574 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-03-20 15:03:16.701 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:03:16.705 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:03:16.706 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:03:16.707 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:03:16.709 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:03:16.710 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 15:03:16.717 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 2264.4151ms
2023-03-20 15:03:16.719 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:03:16.722 +04:00 [DBG] Connection id "0HMP96A5I2V7J" completed keep alive response.
2023-03-20 15:03:16.725 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:03:16.730 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:03:16.733 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 15:03:16.735 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 52 - 200 - text/plain;+charset=utf-8 2455.0395ms
2023-03-20 15:05:05.520 +04:00 [INF] Request starting HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - -
2023-03-20 15:05:05.524 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-03-20 15:05:05.525 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-03-20 15:05:05.528 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:05:05.529 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:05:05.586 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:05:05.589 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:05:05.596 +04:00 [DBG] Authorization was successful.
2023-03-20 15:05:05.599 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:05:05.604 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:05:05.608 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:05:05.609 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:05:05.611 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:05:05.614 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:05:05.615 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:05:05.617 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:05:05.619 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:05:05.640 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:05:05.645 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 15:05:05.649 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:05:05.660 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:05:05.666 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:05:05.668 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:05:05.669 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:05:05.671 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:05:05.673 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2023-03-20 15:05:05.675 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:05:05.679 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:05:05.681 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:05:05.691 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:05:05.696 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:05:05.698 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 2ms reading results.
2023-03-20 15:05:05.700 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:05:05.702 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:05:05.707 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:05:05.710 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:05:05.711 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:05:05.712 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:05:05.713 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:05:05.715 +04:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-03-20 15:05:05.717 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (ATM.Api) in 100.1429ms
2023-03-20 15:05:05.719 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:05:05.722 +04:00 [DBG] Connection id "0HMP96A5I2V7J" completed keep alive response.
2023-03-20 15:05:05.724 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:05:05.725 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:05:05.727 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:05:05.730 +04:00 [INF] Request finished HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - - - 400 - text/plain;+charset=utf-8 209.4654ms
2023-03-20 15:07:15.938 +04:00 [DBG] Connection id "0HMP96A5I2V7J" disconnecting.
2023-03-20 15:07:15.940 +04:00 [DBG] Connection id "0HMP96A5I2V7J" stopped.
2023-03-20 15:07:15.941 +04:00 [DBG] Connection id "0HMP96A5I2V7J" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:13:07.750 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 15:13:07.821 +04:00 [DBG] Hosting starting
2023-03-20 15:13:07.844 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 15:13:07.850 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 15:13:07.857 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 15:13:07.862 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 15:13:07.866 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 15:13:07.871 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 15:13:07.875 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:13:07.878 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 15:13:07.880 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:13:07.884 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 15:13:07.889 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 15:13:07.892 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 15:13:07.894 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 15:13:08.001 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 15:13:08.002 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 15:13:08.003 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 15:13:08.004 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 15:13:08.005 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 15:13:08.005 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 15:13:08.006 +04:00 [INF] Hosting environment: Development
2023-03-20 15:13:08.007 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 15:13:08.008 +04:00 [DBG] Hosting started
2023-03-20 15:13:08.320 +04:00 [DBG] Connection id "0HMP96GAS647D" accepted.
2023-03-20 15:13:08.323 +04:00 [DBG] Connection id "0HMP96GAS647D" started.
2023-03-20 15:13:08.329 +04:00 [DBG] Connection id "0HMP96GAS647E" accepted.
2023-03-20 15:13:08.331 +04:00 [DBG] Connection id "0HMP96GAS647E" started.
2023-03-20 15:13:08.362 +04:00 [DBG] Connection id "0HMP96GAS647D" received FIN.
2023-03-20 15:13:08.362 +04:00 [DBG] Connection id "0HMP96GAS647E" received FIN.
2023-03-20 15:13:08.369 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:13:08.369 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:13:08.406 +04:00 [DBG] Connection id "0HMP96GAS647E" stopped.
2023-03-20 15:13:08.406 +04:00 [DBG] Connection id "0HMP96GAS647D" stopped.
2023-03-20 15:13:08.410 +04:00 [DBG] Connection id "0HMP96GAS647E" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:13:08.410 +04:00 [DBG] Connection id "0HMP96GAS647D" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:13:08.598 +04:00 [DBG] Connection id "0HMP96GAS647F" accepted.
2023-03-20 15:13:08.600 +04:00 [DBG] Connection id "0HMP96GAS647F" started.
2023-03-20 15:13:08.647 +04:00 [DBG] Connection 0HMP96GAS647F established using the following protocol: "Tls12"
2023-03-20 15:13:08.707 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 15:13:08.732 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 15:13:08.756 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 15:13:08.758 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:13:08.912 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 15:13:08.925 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 15:13:08.928 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 223.2785ms
2023-03-20 15:13:08.945 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 15:13:08.951 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.3383ms
2023-03-20 15:13:08.977 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 15:13:08.993 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 16.3025ms
2023-03-20 15:13:09.098 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 15:13:09.100 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 15:13:09.102 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:13:09.198 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 99.5557ms
2023-03-20 15:13:10.618 +04:00 [DBG] Connection id "0HMP96GAS647F" received FIN.
2023-03-20 15:13:10.623 +04:00 [DBG] The connection queue processing loop for 0HMP96GAS647F completed.
2023-03-20 15:13:10.624 +04:00 [DBG] Connection id "0HMP96GAS647F" is closed. The last processed stream ID was 7.
2023-03-20 15:13:10.626 +04:00 [DBG] Connection id "0HMP96GAS647F" sending FIN because: "The client closed the connection."
2023-03-20 15:13:10.633 +04:00 [DBG] Connection id "0HMP96GAS647F" stopped.
2023-03-20 15:14:01.377 +04:00 [DBG] Connection id "0HMP96GAS647G" accepted.
2023-03-20 15:14:01.378 +04:00 [DBG] Connection id "0HMP96GAS647G" started.
2023-03-20 15:14:01.381 +04:00 [DBG] Connection 0HMP96GAS647G established using the following protocol: "Tls12"
2023-03-20 15:14:01.386 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 40
2023-03-20 15:14:01.392 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-03-20 15:14:01.396 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-03-20 15:14:01.400 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:01.403 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:14:01.406 +04:00 [DBG] The request has an origin header: 'https://localhost:7261'.
2023-03-20 15:14:01.408 +04:00 [INF] CORS policy execution successful.
2023-03-20 15:14:01.437 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:14:01.445 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:01.473 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:14:01.478 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:14:01.480 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:14:01.482 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:14:01.488 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:14:01.490 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:14:01.494 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:14:01.600 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 15:14:01.623 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:14:01.631 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:14:01.636 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:14:01.640 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:14:01.649 +04:00 [DBG] Connection id "0HMP96GAS647G", Request id "0HMP96GAS647G:00000001": started reading request body.
2023-03-20 15:14:01.651 +04:00 [DBG] Connection id "0HMP96GAS647G", Request id "0HMP96GAS647G:00000001": done reading request body.
2023-03-20 15:14:01.657 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:14:01.659 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:01.661 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:01.662 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:14:01.674 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:02.095 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 15:14:02.097 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 15:14:02.353 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:14:02.419 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && (int)c.Pin == (int)__request_Pin_1)'
2023-03-20 15:14:02.467 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:14:02.591 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:14:02.625 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:14:02.628 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:14:02.644 +04:00 [DBG] Created DbConnection. (14ms).
2023-03-20 15:14:02.648 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (23ms).
2023-03-20 15:14:02.657 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (32ms).
2023-03-20 15:14:02.661 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:02.793 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:02.803 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:14:02.847 +04:00 [INF] Executed DbCommand (47ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:14:02.859 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:02.866 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 12ms reading results.
2023-03-20 15:14:02.870 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:02.875 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-03-20 15:14:02.885 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 1389.6564ms
2023-03-20 15:14:02.887 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:02.890 +04:00 [ERR] Can't identify card
System.ArgumentException: Can't identify card
   at ATM.Services.LoginService.LoginAsync(LoginRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\LoginService.cs:line 28
   at ATM.Api.Controllers.CardController.Login(LoginRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\CardController.cs:line 38
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 15:14:02.976 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:14:02.980 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:02.982 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 15:14:02.984 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 40 - 400 - application/json 1598.5071ms
2023-03-20 15:14:08.829 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Card/see-balance - -
2023-03-20 15:14:08.833 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-03-20 15:14:08.834 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-03-20 15:14:08.836 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:14:08.837 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:14:08.840 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:14:08.845 +04:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2023-03-20 15:14:08.853 +04:00 [INF] AuthenticationScheme: Bearer was challenged.
2023-03-20 15:14:08.855 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Card/see-balance - - - 401 0 - 25.6731ms
2023-03-20 15:14:17.221 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Test/get-all-cards - -
2023-03-20 15:14:17.223 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Test/get-all-cards'
2023-03-20 15:14:17.225 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TestController.GetAllCards (ATM.Api)' with route pattern 'api/Test/get-all-cards' is valid for the request path '/api/Test/get-all-cards'
2023-03-20 15:14:17.227 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TestController.GetAllCards (ATM.Api)'
2023-03-20 15:14:17.228 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:14:17.231 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:14:17.234 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TestController.GetAllCards (ATM.Api)'
2023-03-20 15:14:17.239 +04:00 [INF] Route matched with {action = "GetAllCards", controller = "Test"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllCards() on controller ATM.Api.Controllers.TestController (ATM.Api).
2023-03-20 15:14:17.241 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:14:17.243 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:14:17.245 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:14:17.247 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:14:17.250 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:14:17.252 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TestController (ATM.Api)
2023-03-20 15:14:17.255 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TestController (ATM.Api)
2023-03-20 15:14:17.268 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:14:17.274 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()'
2023-03-20 15:14:17.280 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CardEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
        SELECT c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin
        FROM Cards AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:14:17.289 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:14:17.291 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:14:17.292 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:14:17.293 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:14:17.295 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:14:17.297 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:17.301 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:17.304 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin]
FROM [Cards] AS [c]
2023-03-20 15:14:17.309 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin]
FROM [Cards] AS [c]
2023-03-20 15:14:17.331 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:17.357 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:17.360 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:17.364 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:17.367 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 54ms reading results.
2023-03-20 15:14:17.370 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:17.372 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (2ms).
2023-03-20 15:14:17.376 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:14:17.381 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:14:17.382 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:14:17.384 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:14:17.386 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:14:17.389 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BankSystem.Common.Db.Entities.CardEntity, Common, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-03-20 15:14:17.420 +04:00 [INF] Executed action ATM.Api.Controllers.TestController.GetAllCards (ATM.Api) in 167.8436ms
2023-03-20 15:14:17.422 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TestController.GetAllCards (ATM.Api)'
2023-03-20 15:14:17.423 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:14:17.425 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:17.426 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:14:17.428 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Test/get-all-cards - - - 200 - application/json;+charset=utf-8 206.7200ms
2023-03-20 15:14:44.059 +04:00 [DBG] Connection id "0HMP96GAS647H" accepted.
2023-03-20 15:14:44.061 +04:00 [DBG] Connection id "0HMP96GAS647H" received FIN.
2023-03-20 15:14:44.061 +04:00 [DBG] Connection id "0HMP96GAS647H" started.
2023-03-20 15:14:44.062 +04:00 [DBG] Connection id "0HMP96GAS647I" accepted.
2023-03-20 15:14:44.065 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:14:44.066 +04:00 [DBG] Connection id "0HMP96GAS647I" started.
2023-03-20 15:14:44.068 +04:00 [DBG] Connection id "0HMP96GAS647H" stopped.
2023-03-20 15:14:44.071 +04:00 [DBG] Connection id "0HMP96GAS647H" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:14:44.075 +04:00 [DBG] Connection 0HMP96GAS647I established using the following protocol: "Tls12"
2023-03-20 15:14:44.084 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44
2023-03-20 15:14:44.085 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:14:44.087 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:14:44.088 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:44.089 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:14:44.090 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:14:44.093 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:44.095 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:14:44.097 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:14:44.098 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:14:44.100 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:14:44.102 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:14:44.104 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:14:44.105 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:14:44.107 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:14:44.109 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:14:44.111 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:14:44.113 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:14:44.116 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000001": started reading request body.
2023-03-20 15:14:44.117 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000001": done reading request body.
2023-03-20 15:14:44.120 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:14:44.121 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:44.123 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:44.124 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:14:44.128 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:14:44.177 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:14:44.186 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:14:44.187 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:14:44.188 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:14:44.188 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:14:44.190 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:14:44.191 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:44.192 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:44.193 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:14:44.196 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:14:44.200 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:44.213 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:44.222 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:14:44.231 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:44.232 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 33ms reading results.
2023-03-20 15:14:44.234 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:44.235 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:14:44.237 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 132.4911ms
2023-03-20 15:14:44.239 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:14:44.240 +04:00 [ERR] Card is deprecated
ATM.Exceptions.CardIsDeprecatedException: Card is deprecated
   at ATM.Services.LoginService.LoginAsync(LoginRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\LoginService.cs:line 34
   at ATM.Api.Controllers.CardController.Login(LoginRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\CardController.cs:line 38
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 15:14:44.248 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:14:44.249 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:14:44.250 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:14:44.251 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:14:44.253 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44 - 410 - application/json 168.8285ms
2023-03-20 15:14:45.744 +04:00 [DBG] Connection id "0HMP96GAS647G" received FIN.
2023-03-20 15:14:45.746 +04:00 [DBG] Connection id "0HMP96GAS647G" is closed. The last processed stream ID was 5.
2023-03-20 15:14:45.746 +04:00 [DBG] Connection id "0HMP96GAS647G" sending FIN because: "The client closed the connection."
2023-03-20 15:14:45.750 +04:00 [DBG] The connection queue processing loop for 0HMP96GAS647G completed.
2023-03-20 15:14:45.751 +04:00 [DBG] Connection id "0HMP96GAS647G" stopped.
2023-03-20 15:15:15.218 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44
2023-03-20 15:15:15.220 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:15:15.222 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:15:15.224 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:15:15.225 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:15:15.226 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:15:15.227 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:15:15.228 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:15:15.231 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:15:15.233 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:15:15.235 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:15:15.237 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:15:15.238 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:15:15.240 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:15:15.244 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:15:15.245 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:15:15.247 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:15:15.250 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:15:15.252 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000002": started reading request body.
2023-03-20 15:15:15.254 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000002": done reading request body.
2023-03-20 15:15:15.255 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:15:15.256 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:15:15.258 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:15:15.259 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:15:15.261 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:15:15.264 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:15:15.267 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:15.268 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:15:15.269 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:15:15.271 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:15:15.272 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:15:15.274 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:15.275 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:15.277 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:15:15.281 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:15:15.286 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:15.288 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:15.290 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:15.292 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:15.294 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 8ms reading results.
2023-03-20 15:15:15.296 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:15.298 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:15.377 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:15:15.381 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:15:15.383 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:15:15.384 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:15:15.385 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:15:15.387 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 15:15:15.388 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 148.2517ms
2023-03-20 15:15:15.390 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:15:15.392 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:15:15.394 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:15:15.395 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:15.397 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:15:15.399 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44 - 200 - text/plain;+charset=utf-8 180.7961ms
2023-03-20 15:15:30.275 +04:00 [INF] Request starting HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - -
2023-03-20 15:15:30.276 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-03-20 15:15:30.278 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-03-20 15:15:30.280 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:15:30.282 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:15:30.316 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:15:30.319 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:15:30.322 +04:00 [DBG] Authorization was successful.
2023-03-20 15:15:30.323 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:15:30.327 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:15:30.330 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:15:30.331 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:15:30.333 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:15:30.336 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:15:30.338 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:15:30.340 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:15:30.342 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:15:30.347 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:15:30.350 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 15:15:30.353 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:15:30.360 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:15:30.364 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:30.365 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:15:30.366 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:15:30.367 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:15:30.368 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:15:30.370 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:30.372 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:30.373 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:15:30.391 +04:00 [INF] Executed DbCommand (18ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:15:30.394 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:30.396 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:30.398 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:30.400 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:30.402 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:15:30.405 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:30.406 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:30.409 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:15:30.411 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:15:30.412 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:15:30.413 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:15:30.415 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:15:30.417 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.Decimal'.
2023-03-20 15:15:30.421 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (ATM.Api) in 80.9934ms
2023-03-20 15:15:30.423 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:15:30.425 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:15:30.426 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:15:30.427 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:30.429 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:15:30.431 +04:00 [INF] Request finished HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 156.5433ms
2023-03-20 15:15:48.623 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:15:48.624 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:15:48.625 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:15:48.627 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:15:48.628 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:15:48.631 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:15:48.632 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:15:48.634 +04:00 [DBG] Authorization was successful.
2023-03-20 15:15:48.635 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:15:48.640 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:15:48.642 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:15:48.644 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:15:48.647 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:15:48.651 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:15:48.653 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:15:48.655 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:15:48.656 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:15:48.658 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:15:48.659 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:15:48.663 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:15:48.670 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000004": started reading request body.
2023-03-20 15:15:48.671 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000004": done reading request body.
2023-03-20 15:15:48.675 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:15:48.677 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:15:48.678 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:15:48.679 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:15:48.684 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:15:48.692 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:15:48.696 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 15:15:48.702 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:15:48.705 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:48.706 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:15:48.707 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:15:48.708 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:15:48.710 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:15:48.711 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.712 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.713 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:15:48.730 +04:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:15:48.736 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.757 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.759 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.761 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.762 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.764 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.767 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.768 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.770 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.772 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.774 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.776 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.778 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.779 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.781 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.784 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.786 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.788 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.790 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.796 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.798 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.800 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.802 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.804 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.805 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.808 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.809 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.811 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.815 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.817 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.820 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.822 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.823 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.827 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.829 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.836 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.839 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.840 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 108ms reading results.
2023-03-20 15:15:48.842 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.843 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:48.851 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:48.852 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:15:48.853 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:15:48.854 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.855 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.856 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:15:48.861 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:15:48.865 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.867 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.868 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:48.869 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.870 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-03-20 15:15:48.872 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.873 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:48.879 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt > DateTime.Now.AddDays(-1) && (int)t.TransactionType == 0)'
2023-03-20 15:15:48.896 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid?), 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (t.CreatedAt > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:15:48.904 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:48.905 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:15:48.907 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:15:48.908 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.910 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.912 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:15:48.918 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:15:48.922 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.923 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:15:48.925 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:48.927 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:48.934 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 15:15:48.940 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 15:15:48.993 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:15:49.004 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:49.005 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:15:49.008 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:15:49.009 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.011 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.013 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:15:49.021 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:15:49.064 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.069 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.105 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.107 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.110 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.111 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 85ms reading results.
2023-03-20 15:15:49.113 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.114 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:49.151 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.168 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.173 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 15:15:49.176 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 15:15:49.218 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 15:15:49.225 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.240 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 15:15:49.319 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 15:15:49.323 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.325 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.328 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 15:15:49.338 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 15:15:49.344 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:15:49.346 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:15:49.351 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2023-03-20 15:15:49.353 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:15:49.380 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:15:49.389 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.391 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:15:49.397 +04:00 [DBG] Committing transaction.
2023-03-20 15:15:49.410 +04:00 [DBG] Committed transaction.
2023-03-20 15:15:49.412 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.414 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:15:49.419 +04:00 [DBG] Disposing transaction.
2023-03-20 15:15:49.424 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.427 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.429 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:15:49.434 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 15:15:49.435 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:15:49.438 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:15:49.439 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:15:49.440 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:15:49.441 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:15:49.442 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 15:15:49.446 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 791.6268ms
2023-03-20 15:15:49.449 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:15:49.451 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:15:49.453 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:15:49.454 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:15:49.456 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:15:49.457 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 200 - application/json;+charset=utf-8 834.7772ms
2023-03-20 15:16:04.757 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44
2023-03-20 15:16:04.759 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:16:04.760 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:16:04.762 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:04.763 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:16:04.765 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:16:04.767 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:04.768 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:16:04.770 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:16:04.772 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:16:04.773 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:16:04.775 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:16:04.776 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:16:04.778 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:04.779 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:04.781 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:16:04.783 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:16:04.785 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:16:04.786 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000005": started reading request body.
2023-03-20 15:16:04.787 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000005": done reading request body.
2023-03-20 15:16:04.788 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:16:04.789 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:04.790 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:04.791 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:16:04.792 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:04.794 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:16:04.797 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:16:04.800 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:16:04.801 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:16:04.802 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:16:04.803 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:16:04.804 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:04.805 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:04.808 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:16:04.813 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:16:04.818 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:04.820 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:04.822 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:04.824 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:04.825 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:16:04.827 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:04.829 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:16:04.833 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:16:04.836 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:16:04.837 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:16:04.838 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:16:04.839 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:16:04.841 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 15:16:04.843 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 64.8079ms
2023-03-20 15:16:04.844 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:04.846 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:16:04.847 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:16:04.849 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:04.850 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:16:04.852 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44 - 200 - text/plain;+charset=utf-8 94.9369ms
2023-03-20 15:16:22.779 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44
2023-03-20 15:16:22.780 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:16:22.781 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:16:22.783 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:22.784 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:16:22.785 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:16:22.786 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:22.787 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:16:22.789 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:16:22.791 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:16:22.792 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:16:22.794 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:16:22.795 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:16:22.797 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:22.798 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:22.800 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:16:22.801 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:16:22.802 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:16:22.803 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000006": started reading request body.
2023-03-20 15:16:22.805 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000006": done reading request body.
2023-03-20 15:16:22.806 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:16:22.807 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:22.808 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:22.809 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:16:22.810 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:16:22.812 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:16:22.815 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:16:22.816 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:16:22.816 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:16:22.817 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:16:22.818 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:16:22.820 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:22.821 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:22.822 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:16:22.827 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:16:22.831 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:22.832 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:22.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:22.835 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:22.836 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-03-20 15:16:22.858 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:22.859 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:16:22.861 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:16:22.863 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:16:22.864 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:16:22.865 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:16:22.865 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:16:22.867 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 15:16:22.868 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 71.4144ms
2023-03-20 15:16:22.869 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:16:22.870 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:16:22.871 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:16:22.872 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:22.873 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:16:22.875 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 44 - 200 - text/plain;+charset=utf-8 95.9544ms
2023-03-20 15:16:26.126 +04:00 [INF] Request starting HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - -
2023-03-20 15:16:26.127 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-03-20 15:16:26.129 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-03-20 15:16:26.131 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:16:26.133 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:16:26.134 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:16:26.136 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:16:26.137 +04:00 [DBG] Authorization was successful.
2023-03-20 15:16:26.139 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:16:26.140 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:16:26.144 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:16:26.145 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:16:26.147 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:16:26.150 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:16:26.152 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:16:26.154 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:26.156 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:16:26.159 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:16:26.162 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:16:26.164 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:16:26.165 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:16:26.166 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:16:26.168 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-03-20 15:16:26.170 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:26.171 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:26.173 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:16:26.178 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:16:26.182 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:26.184 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:26.186 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:16:26.188 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:26.190 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 8ms reading results.
2023-03-20 15:16:26.191 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:26.192 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:16:26.194 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:16:26.196 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:16:26.197 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:16:26.199 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:16:26.200 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:16:26.202 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.Decimal'.
2023-03-20 15:16:26.204 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (ATM.Api) in 50.1869ms
2023-03-20 15:16:26.206 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:16:26.208 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:16:26.209 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:16:26.211 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:16:26.213 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:16:26.215 +04:00 [INF] Request finished HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 88.6835ms
2023-03-20 15:17:01.647 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:17:01.649 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:17:01.651 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:17:01.653 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:01.654 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:17:01.655 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:17:01.656 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:17:01.657 +04:00 [DBG] Authorization was successful.
2023-03-20 15:17:01.658 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:01.659 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:17:01.661 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:17:01.664 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:17:01.665 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:17:01.668 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:17:01.670 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:17:01.672 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:17:01.675 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:17:01.676 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:17:01.678 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:17:01.681 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:17:01.683 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000008": started reading request body.
2023-03-20 15:17:01.684 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000008": done reading request body.
2023-03-20 15:17:01.686 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:17:01.687 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:01.689 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:01.690 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:17:01.692 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:01.696 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:17:01.699 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:01.701 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:17:01.702 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:17:01.703 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:17:01.705 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:17:01.706 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.708 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.709 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:17:01.713 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:17:01.717 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.719 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.720 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.722 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.724 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.725 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.727 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.728 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.731 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.733 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.735 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.737 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.739 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.740 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.743 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.744 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.747 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.749 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.750 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.752 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.753 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.755 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.756 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.759 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.760 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.762 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.765 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.766 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.768 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.770 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.772 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.774 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.776 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.778 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.781 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.783 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.784 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.786 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.787 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.790 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.796 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.799 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.800 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 83ms reading results.
2023-03-20 15:17:01.802 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.804 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:01.807 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:01.808 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:17:01.810 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:17:01.811 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.814 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.817 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:01.823 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:01.825 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.827 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.828 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.829 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.831 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-03-20 15:17:01.833 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.834 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:01.836 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:01.837 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:17:01.838 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:01.839 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.840 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.842 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:17:01.847 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:17:01.849 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.850 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:17:01.852 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.853 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:01.856 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:01.857 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:17:01.858 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:01.860 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.861 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.862 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:17:01.869 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:17:01.872 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.874 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.875 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.877 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.878 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.879 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:17:01.881 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.882 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:01.884 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.885 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.887 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 15:17:01.888 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 15:17:01.889 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 15:17:01.891 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.892 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 15:17:01.894 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 15:17:01.895 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.897 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.898 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 15:17:01.899 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 15:17:01.900 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:01.901 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 15:17:01.902 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:01.903 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:17:01.909 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:17:01.913 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.914 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:17:01.915 +04:00 [DBG] Committing transaction.
2023-03-20 15:17:01.926 +04:00 [DBG] Committed transaction.
2023-03-20 15:17:01.927 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.928 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:01.930 +04:00 [DBG] Disposing transaction.
2023-03-20 15:17:01.931 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.933 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.934 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:01.936 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 15:17:01.937 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:17:01.939 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:17:01.940 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:17:01.941 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:17:01.942 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:17:01.943 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 15:17:01.944 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 271.8473ms
2023-03-20 15:17:01.945 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:01.947 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:17:01.948 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:17:01.949 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:01.950 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:17:01.951 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 200 - application/json;+charset=utf-8 304.8431ms
2023-03-20 15:17:16.955 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:17:16.956 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:17:16.958 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:17:16.960 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:16.961 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:17:16.963 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:17:16.964 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:17:16.966 +04:00 [DBG] Authorization was successful.
2023-03-20 15:17:16.968 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:16.969 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:17:16.972 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:17:16.974 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:17:16.975 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:17:16.981 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:17:16.983 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:17:16.985 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:17:16.988 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:17:16.989 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:17:16.991 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:17:16.993 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:17:16.995 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000009": started reading request body.
2023-03-20 15:17:16.997 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:00000009": done reading request body.
2023-03-20 15:17:16.998 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:17:17.000 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:17.001 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:17.003 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:17:17.004 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:17:17.007 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:17:17.010 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:17.011 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:17:17.013 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:17:17.014 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:17:17.016 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:17:17.017 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.019 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.021 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:17:17.025 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:17:17.028 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.029 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.032 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.034 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.036 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.038 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.041 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.043 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.044 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.046 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.048 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.051 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.052 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.054 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.055 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.057 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.058 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.059 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.060 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.062 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.064 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.065 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.066 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.068 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.069 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.070 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.071 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.073 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.074 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.075 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.076 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.078 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.080 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.081 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.083 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.084 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.085 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.087 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.089 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.090 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.091 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.093 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.094 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.095 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 67ms reading results.
2023-03-20 15:17:17.097 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.098 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:17.100 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:17.101 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 15:17:17.103 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:17.104 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.105 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.106 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:17.111 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:17.114 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.115 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.118 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.121 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.122 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 8ms reading results.
2023-03-20 15:17:17.123 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.124 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 15:17:17.126 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:17.127 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 15:17:17.129 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:17.130 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.132 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.133 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:17:17.138 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:17:17.142 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.143 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.144 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 3ms reading results.
2023-03-20 15:17:17.146 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.147 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:17.149 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:17.150 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:17:17.152 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:17.153 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.154 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.155 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:17:17.163 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:17:17.168 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.169 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.170 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.172 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.173 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.174 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-03-20 15:17:17.175 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.176 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:17.178 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.180 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.181 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 15:17:17.182 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 15:17:17.183 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 15:17:17.185 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.187 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 15:17:17.188 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 15:17:17.189 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.190 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.191 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 15:17:17.192 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 15:17:17.193 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:17.194 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 15:17:17.195 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:17:17.196 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:17:17.204 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:17:17.208 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.209 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:17:17.211 +04:00 [DBG] Committing transaction.
2023-03-20 15:17:17.212 +04:00 [DBG] Committed transaction.
2023-03-20 15:17:17.213 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.214 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:17.216 +04:00 [DBG] Disposing transaction.
2023-03-20 15:17:17.217 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.219 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.221 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:17.222 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 15:17:17.224 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:17:17.226 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:17:17.227 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:17:17.228 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:17:17.228 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:17:17.231 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 15:17:17.233 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 247.7831ms
2023-03-20 15:17:17.235 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:17:17.236 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:17:17.237 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:17:17.239 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:17.240 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:17:17.242 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 200 - application/json;+charset=utf-8 287.5875ms
2023-03-20 15:17:30.201 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 46
2023-03-20 15:17:30.202 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 15:17:30.204 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 15:17:30.206 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:17:30.207 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:17:30.208 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 15:17:30.209 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:17:30.210 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:17:30.213 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:17:30.215 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:17:30.216 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:17:30.219 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:17:30.220 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:17:30.222 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:17:30.223 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:17:30.224 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:17:30.226 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 15:17:30.228 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:17:30.230 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:0000000A": started reading request body.
2023-03-20 15:17:30.231 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:0000000A": done reading request body.
2023-03-20 15:17:30.233 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 15:17:30.234 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:17:30.236 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:17:30.237 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 15:17:30.238 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 15:17:30.241 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:17:30.243 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:30.244 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:17:30.245 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 15:17:30.246 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:17:30.248 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:17:30.249 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:30.252 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:30.253 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:17:30.259 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 15:17:30.263 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:30.265 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:30.267 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:30.269 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:30.270 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:17:30.272 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:30.274 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:30.276 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:17:30.278 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:17:30.280 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:17:30.281 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:17:30.282 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 15:17:30.283 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 15:17:30.285 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 63.0405ms
2023-03-20 15:17:30.286 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 15:17:30.287 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:17:30.289 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:17:30.290 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:30.291 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:17:30.293 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 46 - 200 - text/plain;+charset=utf-8 91.7310ms
2023-03-20 15:17:43.513 +04:00 [INF] Request starting HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - -
2023-03-20 15:17:43.514 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/see-balance'
2023-03-20 15:17:43.516 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)' with route pattern 'api/Card/see-balance' is valid for the request path '/api/Card/see-balance'
2023-03-20 15:17:43.519 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:17:43.521 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:17:43.523 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:17:43.524 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:17:43.525 +04:00 [DBG] Authorization was successful.
2023-03-20 15:17:43.526 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:17:43.527 +04:00 [INF] Route matched with {action = "SeeBalance", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SeeBalance() on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 15:17:43.530 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:17:43.531 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:17:43.533 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:17:43.536 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:17:43.538 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:17:43.540 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:17:43.542 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 15:17:43.544 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:17:43.547 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:17:43.549 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:17:43.551 +04:00 [DBG] Created DbConnection. (2ms).
2023-03-20 15:17:43.552 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:17:43.554 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-03-20 15:17:43.556 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:43.558 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:43.560 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:43.564 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:17:43.568 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:43.570 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:43.571 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:17:43.573 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:43.575 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:17:43.577 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:43.578 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:17:43.580 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:17:43.584 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:17:43.585 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:17:43.586 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:17:43.587 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:17:43.589 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.Decimal'.
2023-03-20 15:17:43.591 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.SeeBalance (ATM.Api) in 50.6627ms
2023-03-20 15:17:43.592 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.SeeBalance (ATM.Api)'
2023-03-20 15:17:43.593 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:17:43.595 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:17:43.596 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:17:43.598 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 15:17:43.600 +04:00 [INF] Request finished HTTP/1.1 GET https://localhost:7261/api/Card/see-balance - - - 200 - application/json;+charset=utf-8 86.7610ms
2023-03-20 15:18:16.791 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:18:16.792 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:18:16.793 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:18:16.795 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:18:16.796 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:18:16.798 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:18:16.798 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:18:16.799 +04:00 [DBG] Authorization was successful.
2023-03-20 15:18:16.800 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:18:16.802 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:18:16.804 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:18:16.806 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:18:16.808 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:18:16.810 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:18:16.812 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:18:16.814 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:18:16.816 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:18:16.817 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:18:16.819 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:18:16.821 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:18:16.822 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:0000000C": started reading request body.
2023-03-20 15:18:16.824 +04:00 [DBG] Connection id "0HMP96GAS647I", Request id "0HMP96GAS647I:0000000C": done reading request body.
2023-03-20 15:18:16.826 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:18:16.827 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:18:16.829 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:18:16.831 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:18:16.833 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:18:16.835 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:18:16.837 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:18:16.838 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:18:16.839 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:18:16.841 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:18:16.842 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:18:16.844 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.845 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.847 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:18:16.851 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:18:16.854 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.856 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.858 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.859 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.861 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.863 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.865 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.866 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.868 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.870 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.872 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.874 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.875 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.877 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.879 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.881 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.882 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.884 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.886 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.888 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.889 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.891 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.893 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.894 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.896 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.898 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.900 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.901 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.903 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.905 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.906 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.908 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.910 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.912 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.914 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.915 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.917 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.920 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.922 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.923 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.925 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.927 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.930 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.931 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.933 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 78ms reading results.
2023-03-20 15:18:16.934 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.936 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:18:16.937 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:18:16.938 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:18:16.940 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:18:16.942 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.943 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.945 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:18:16.951 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:18:16.954 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.956 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.957 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:16.959 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.961 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 6ms reading results.
2023-03-20 15:18:16.963 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.964 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:18:16.966 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:18:16.967 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:18:16.969 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:18:16.971 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.972 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.973 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:18:16.979 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:18:16.983 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.984 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:18:16.986 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.988 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:18:16.990 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:18:16.992 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:18:16.993 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:18:16.995 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.997 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:16.999 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:18:17.008 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:18:17.013 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.016 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.017 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.019 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.021 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.022 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 8ms reading results.
2023-03-20 15:18:17.024 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.025 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:18:17.027 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.029 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.031 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 15:18:17.032 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 15:18:17.034 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 15:18:17.035 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.038 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 15:18:17.039 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 15:18:17.041 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.042 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.043 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 15:18:17.046 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 15:18:17.047 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:18:17.048 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:18:17.050 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:18:17.051 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:18:17.057 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 15:18:17.062 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.063 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:18:17.065 +04:00 [DBG] Committing transaction.
2023-03-20 15:18:17.076 +04:00 [DBG] Committed transaction.
2023-03-20 15:18:17.078 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.080 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:18:17.082 +04:00 [DBG] Disposing transaction.
2023-03-20 15:18:17.083 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.085 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.087 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:18:17.090 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 15:18:17.091 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 15:18:17.094 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 15:18:17.095 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 15:18:17.096 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 15:18:17.097 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 15:18:17.099 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 15:18:17.101 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 286.6866ms
2023-03-20 15:18:17.102 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:18:17.103 +04:00 [DBG] Connection id "0HMP96GAS647I" completed keep alive response.
2023-03-20 15:18:17.105 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:18:17.106 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:18:17.108 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 15:18:17.110 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 200 - application/json;+charset=utf-8 319.1947ms
2023-03-20 15:19:02.030 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 15:19:02.132 +04:00 [DBG] Hosting starting
2023-03-20 15:19:02.189 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 15:19:02.197 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 15:19:02.207 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 15:19:02.214 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 15:19:02.220 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 15:19:02.227 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 15:19:02.230 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:19:02.233 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 15:19:02.236 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:19:02.241 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 15:19:02.247 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 15:19:02.253 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 15:19:02.256 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 15:19:02.457 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 15:19:02.458 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 15:19:02.459 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 15:19:02.460 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 15:19:02.461 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 15:19:02.462 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 15:19:02.463 +04:00 [INF] Hosting environment: Development
2023-03-20 15:19:02.464 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 15:19:02.464 +04:00 [DBG] Hosting started
2023-03-20 15:19:02.913 +04:00 [DBG] Connection id "0HMP96JKHRDBI" accepted.
2023-03-20 15:19:02.916 +04:00 [DBG] Connection id "0HMP96JKHRDBI" started.
2023-03-20 15:19:02.951 +04:00 [DBG] Connection id "0HMP96JKHRDBJ" accepted.
2023-03-20 15:19:02.952 +04:00 [DBG] Connection id "0HMP96JKHRDBJ" started.
2023-03-20 15:19:03.347 +04:00 [DBG] Connection id "0HMP96JKHRDBK" accepted.
2023-03-20 15:19:03.351 +04:00 [DBG] Connection id "0HMP96JKHRDBK" started.
2023-03-20 15:19:03.422 +04:00 [DBG] Connection 0HMP96JKHRDBK established using the following protocol: "Tls12"
2023-03-20 15:19:03.502 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 15:19:03.531 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 15:19:03.562 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 15:19:03.563 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:19:03.766 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 15:19:03.952 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 15:19:03.957 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 456.0105ms
2023-03-20 15:19:03.973 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 15:19:03.980 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.2015ms
2023-03-20 15:19:04.007 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 15:19:04.065 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 57.2994ms
2023-03-20 15:19:04.162 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 15:19:04.163 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 15:19:04.165 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:19:04.369 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 207.2276ms
2023-03-20 15:19:06.109 +04:00 [DBG] Connection id "0HMP96JKHRDBK" received FIN.
2023-03-20 15:19:06.113 +04:00 [DBG] The connection queue processing loop for 0HMP96JKHRDBK completed.
2023-03-20 15:19:06.116 +04:00 [DBG] Connection id "0HMP96JKHRDBK" is closed. The last processed stream ID was 7.
2023-03-20 15:19:06.118 +04:00 [DBG] Connection id "0HMP96JKHRDBK" sending FIN because: "The client closed the connection."
2023-03-20 15:19:06.126 +04:00 [DBG] Connection id "0HMP96JKHRDBK" stopped.
2023-03-20 15:19:12.011 +04:00 [DBG] Connection id "0HMP96JKHRDBL" accepted.
2023-03-20 15:19:12.013 +04:00 [DBG] Connection id "0HMP96JKHRDBL" received FIN.
2023-03-20 15:19:12.013 +04:00 [DBG] Connection id "0HMP96JKHRDBL" started.
2023-03-20 15:19:12.014 +04:00 [DBG] Connection id "0HMP96JKHRDBM" accepted.
2023-03-20 15:19:12.027 +04:00 [DBG] Connection id "0HMP96JKHRDBM" started.
2023-03-20 15:19:12.041 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:19:12.044 +04:00 [DBG] Connection 0HMP96JKHRDBM established using the following protocol: "Tls12"
2023-03-20 15:19:12.110 +04:00 [DBG] Connection id "0HMP96JKHRDBL" stopped.
2023-03-20 15:19:12.115 +04:00 [DBG] Connection id "0HMP96JKHRDBL" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:19:12.125 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:19:12.135 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:19:12.139 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:19:12.142 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:19:12.146 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:19:12.483 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:19:12.486 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:19:12.498 +04:00 [DBG] Authorization was successful.
2023-03-20 15:19:12.502 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:19:12.548 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:19:12.553 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:19:12.555 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:19:12.557 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:19:12.561 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:19:12.563 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:19:12.567 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:19:12.705 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 15:19:12.735 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:19:12.751 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:19:12.755 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:19:12.760 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:19:12.772 +04:00 [DBG] Connection id "0HMP96JKHRDBM", Request id "0HMP96JKHRDBM:00000001": started reading request body.
2023-03-20 15:19:12.773 +04:00 [DBG] Connection id "0HMP96JKHRDBM", Request id "0HMP96JKHRDBM:00000001": done reading request body.
2023-03-20 15:19:12.782 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:19:12.784 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:19:12.785 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:19:12.786 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:19:12.800 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:19:12.939 +04:00 [DBG] Authentication of the HTTPS connection timed out.
2023-03-20 15:19:12.940 +04:00 [DBG] Connection id "0HMP96JKHRDBI" stopped.
2023-03-20 15:19:12.941 +04:00 [DBG] Connection id "0HMP96JKHRDBI" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:19:12.969 +04:00 [DBG] Authentication of the HTTPS connection timed out.
2023-03-20 15:19:12.970 +04:00 [DBG] Connection id "0HMP96JKHRDBJ" stopped.
2023-03-20 15:19:12.971 +04:00 [DBG] Connection id "0HMP96JKHRDBJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:19:13.250 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 15:19:13.253 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 15:19:13.577 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:19:13.644 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 15:19:13.818 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:19:13.855 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:19:13.859 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:19:13.890 +04:00 [DBG] Created DbConnection. (28ms).
2023-03-20 15:19:13.897 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (42ms).
2023-03-20 15:19:13.900 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (46ms).
2023-03-20 15:19:13.905 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.144 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.154 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:19:14.198 +04:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:19:14.230 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.264 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.266 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.267 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.269 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.270 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.272 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.273 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.275 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.277 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.278 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.280 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.281 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.282 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.283 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.285 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.287 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.288 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.289 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.290 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.291 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.292 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.294 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.296 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.297 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.298 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.300 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.301 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.302 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.304 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.305 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.306 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.307 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.309 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.310 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.311 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.313 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.314 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.315 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.317 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.318 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.323 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.324 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.330 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.337 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 132ms reading results.
2023-03-20 15:19:14.342 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.349 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-03-20 15:19:14.370 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 15:19:14.412 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:19:14.476 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:19:14.490 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:19:14.492 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:19:14.497 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-03-20 15:19:14.499 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.501 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.506 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:19:14.536 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:19:14.545 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.581 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.590 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:19:14.603 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.605 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 66ms reading results.
2023-03-20 15:19:14.607 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.609 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:19:14.619 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => t.AccountFromId == __accountId_0 && t.CreatedAt > DateTime.Now.AddDays(-1) && (int)t.TransactionType == 0)'
2023-03-20 15:19:14.638 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid?), 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE ((t.AccountFromId == @__accountId_0) && (t.CreatedAt > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()))) && (t.TransactionType == 0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:19:14.650 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:19:14.651 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:19:14.653 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:19:14.654 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.655 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.657 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:19:14.663 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[AccountFromId] = @__accountId_0 AND [t].[CreatedAt] > DATEADD(day, CAST(-1.0E0 AS int), GETDATE()) AND [t].[TransactionType] = 0
2023-03-20 15:19:14.666 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.667 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:19:14.668 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:19:14.670 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:20:25.487 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 15:20:25.618 +04:00 [DBG] Hosting starting
2023-03-20 15:20:25.674 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 15:20:25.681 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 15:20:25.688 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 15:20:25.693 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 15:20:25.698 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 15:20:25.704 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 15:20:25.708 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:20:25.711 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 15:20:25.713 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:20:25.718 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 15:20:25.722 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 15:20:25.727 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 15:20:25.729 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 15:20:25.908 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 15:20:25.909 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 15:20:25.910 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 15:20:25.911 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 15:20:25.912 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 15:20:25.913 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 15:20:25.914 +04:00 [INF] Hosting environment: Development
2023-03-20 15:20:25.915 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 15:20:25.916 +04:00 [DBG] Hosting started
2023-03-20 15:20:26.079 +04:00 [DBG] Connection id "0HMP96KDAVJB2" received FIN.
2023-03-20 15:20:26.085 +04:00 [DBG] Connection id "0HMP96KDAVJB2" accepted.
2023-03-20 15:20:26.087 +04:00 [DBG] Connection id "0HMP96KDAVJB2" started.
2023-03-20 15:20:26.108 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:20:26.165 +04:00 [DBG] Connection id "0HMP96KDAVJB2" stopped.
2023-03-20 15:20:26.170 +04:00 [DBG] Connection id "0HMP96KDAVJB2" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:20:26.624 +04:00 [DBG] Connection id "0HMP96KDAVJB3" accepted.
2023-03-20 15:20:26.625 +04:00 [DBG] Connection id "0HMP96KDAVJB3" started.
2023-03-20 15:20:26.697 +04:00 [DBG] Connection 0HMP96KDAVJB3 established using the following protocol: "Tls12"
2023-03-20 15:20:26.768 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 15:20:26.796 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 15:20:26.821 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 15:20:26.823 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:20:27.033 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 15:20:27.054 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 15:20:27.059 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 292.3719ms
2023-03-20 15:20:27.078 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 15:20:27.084 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.6984ms
2023-03-20 15:20:27.109 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 15:20:27.155 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 46.1436ms
2023-03-20 15:20:27.240 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 15:20:27.241 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 15:20:27.242 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:20:27.362 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 122.5206ms
2023-03-20 15:20:29.818 +04:00 [DBG] Connection id "0HMP96KDAVJB4" accepted.
2023-03-20 15:20:29.819 +04:00 [DBG] Connection id "0HMP96KDAVJB4" received FIN.
2023-03-20 15:20:29.820 +04:00 [DBG] Connection id "0HMP96KDAVJB4" started.
2023-03-20 15:20:29.820 +04:00 [DBG] Connection id "0HMP96KDAVJB5" accepted.
2023-03-20 15:20:29.823 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:20:29.824 +04:00 [DBG] Connection id "0HMP96KDAVJB5" started.
2023-03-20 15:20:29.826 +04:00 [DBG] Connection id "0HMP96KDAVJB4" stopped.
2023-03-20 15:20:29.828 +04:00 [DBG] Connection id "0HMP96KDAVJB4" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:20:29.831 +04:00 [DBG] Connection 0HMP96KDAVJB5 established using the following protocol: "Tls12"
2023-03-20 15:20:29.839 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:20:29.844 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:20:29.848 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:20:29.850 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:20:29.853 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:20:30.078 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:20:30.081 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:20:30.087 +04:00 [DBG] Authorization was successful.
2023-03-20 15:20:30.090 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:20:30.114 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:20:30.117 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:20:30.119 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:20:30.120 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:20:30.122 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:20:30.123 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:20:30.127 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:20:30.272 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 15:20:30.297 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:20:30.311 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:20:30.314 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:20:30.317 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:20:30.328 +04:00 [DBG] Connection id "0HMP96KDAVJB5", Request id "0HMP96KDAVJB5:00000001": started reading request body.
2023-03-20 15:20:30.330 +04:00 [DBG] Connection id "0HMP96KDAVJB5", Request id "0HMP96KDAVJB5:00000001": done reading request body.
2023-03-20 15:20:30.336 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:20:30.338 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:20:30.339 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:20:30.340 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:20:30.353 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:20:30.801 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 15:20:30.803 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 15:20:31.113 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:20:31.158 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 15:20:31.288 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:20:31.318 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:20:31.321 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:20:31.349 +04:00 [DBG] Created DbConnection. (25ms).
2023-03-20 15:20:31.358 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (38ms).
2023-03-20 15:20:31.361 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (44ms).
2023-03-20 15:20:31.367 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.590 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.598 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:20:31.635 +04:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:20:31.671 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.709 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.712 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.713 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.715 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.716 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.717 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.719 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.720 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.722 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.723 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.724 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.726 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.728 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.729 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.730 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.732 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.733 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.735 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.736 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.738 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.739 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.741 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.742 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.744 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.745 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.746 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.747 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.749 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.750 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.751 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.753 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.755 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.756 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.758 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.759 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.761 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.762 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.763 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.764 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.769 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.771 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:31.777 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.784 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 140ms reading results.
2023-03-20 15:20:31.788 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.795 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-03-20 15:20:31.816 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 15:20:31.856 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:20:31.924 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:20:31.935 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:20:31.936 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:20:31.940 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 15:20:31.942 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.944 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:31.948 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:20:31.972 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:20:31.979 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:32.017 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:32.026 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:20:32.036 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:32.038 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 63ms reading results.
2023-03-20 15:20:32.040 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:20:32.041 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:51:51.311 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 15:51:51.457 +04:00 [DBG] Hosting starting
2023-03-20 15:51:51.551 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 15:51:51.562 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 15:51:51.587 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 15:51:51.598 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 15:51:51.607 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 15:51:51.619 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 15:51:51.623 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:51:51.627 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 15:51:51.629 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 15:51:51.634 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 15:51:51.639 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 15:51:51.645 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 15:51:51.647 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 15:51:51.926 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 15:51:51.927 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 15:51:51.928 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 15:51:51.929 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 15:51:51.930 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 15:51:51.931 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 15:51:51.932 +04:00 [INF] Hosting environment: Development
2023-03-20 15:51:51.933 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 15:51:51.934 +04:00 [DBG] Hosting started
2023-03-20 15:51:52.240 +04:00 [DBG] Connection id "0HMP975VEQ3LS" accepted.
2023-03-20 15:51:52.243 +04:00 [DBG] Connection id "0HMP975VEQ3LS" started.
2023-03-20 15:51:52.282 +04:00 [DBG] Connection id "0HMP975VEQ3LS" received FIN.
2023-03-20 15:51:52.294 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:51:52.368 +04:00 [DBG] Connection id "0HMP975VEQ3LS" stopped.
2023-03-20 15:51:52.371 +04:00 [DBG] Connection id "0HMP975VEQ3LS" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:51:52.682 +04:00 [DBG] Connection id "0HMP975VEQ3LT" accepted.
2023-03-20 15:51:52.685 +04:00 [DBG] Connection id "0HMP975VEQ3LT" started.
2023-03-20 15:51:52.761 +04:00 [DBG] Connection 0HMP975VEQ3LT established using the following protocol: "Tls12"
2023-03-20 15:51:52.877 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 15:51:52.911 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 15:51:52.949 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 15:51:52.963 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:51:53.189 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 15:51:53.243 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 15:51:53.248 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 372.9405ms
2023-03-20 15:51:53.281 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 15:51:53.287 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.0365ms
2023-03-20 15:51:53.302 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 15:51:53.350 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 47.3341ms
2023-03-20 15:51:53.426 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 15:51:53.428 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 15:51:53.429 +04:00 [DBG] Request did not match any endpoints
2023-03-20 15:51:53.584 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 157.2293ms
2023-03-20 15:51:54.287 +04:00 [DBG] Connection id "0HMP975VEQ3LT" received FIN.
2023-03-20 15:51:54.294 +04:00 [DBG] The connection queue processing loop for 0HMP975VEQ3LT completed.
2023-03-20 15:51:54.296 +04:00 [DBG] Connection id "0HMP975VEQ3LT" is closed. The last processed stream ID was 7.
2023-03-20 15:51:54.298 +04:00 [DBG] Connection id "0HMP975VEQ3LT" sending FIN because: "The client closed the connection."
2023-03-20 15:51:54.302 +04:00 [DBG] Connection id "0HMP975VEQ3LT" stopped.
2023-03-20 15:51:56.767 +04:00 [DBG] Connection id "0HMP975VEQ3LU" accepted.
2023-03-20 15:51:56.768 +04:00 [DBG] Connection id "0HMP975VEQ3LU" started.
2023-03-20 15:51:56.768 +04:00 [DBG] Connection id "0HMP975VEQ3LU" received FIN.
2023-03-20 15:51:56.769 +04:00 [DBG] Connection id "0HMP975VEQ3LV" accepted.
2023-03-20 15:51:56.776 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 15:51:56.776 +04:00 [DBG] Connection id "0HMP975VEQ3LV" started.
2023-03-20 15:51:56.779 +04:00 [DBG] Connection id "0HMP975VEQ3LU" stopped.
2023-03-20 15:51:56.781 +04:00 [DBG] Connection id "0HMP975VEQ3LU" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 15:51:56.788 +04:00 [DBG] Connection 0HMP975VEQ3LV established using the following protocol: "Tls12"
2023-03-20 15:51:56.799 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:51:56.804 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:51:56.808 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:51:56.811 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:51:56.814 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:51:57.108 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:51:57.110 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:51:57.119 +04:00 [DBG] Authorization was successful.
2023-03-20 15:51:57.122 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:51:57.156 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:51:57.160 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:51:57.162 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:51:57.164 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:51:57.166 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:51:57.167 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:51:57.170 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:51:57.386 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 15:51:57.412 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:51:57.430 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:51:57.433 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:51:57.436 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:51:57.449 +04:00 [DBG] Connection id "0HMP975VEQ3LV", Request id "0HMP975VEQ3LV:00000001": started reading request body.
2023-03-20 15:51:57.451 +04:00 [DBG] Connection id "0HMP975VEQ3LV", Request id "0HMP975VEQ3LV:00000001": done reading request body.
2023-03-20 15:51:57.484 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:51:57.485 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:51:57.486 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:51:57.488 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:51:57.503 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:51:58.136 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 15:51:58.138 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 15:51:58.622 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:51:58.688 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 15:51:58.895 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 15:51:58.928 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:51:58.931 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:51:58.996 +04:00 [DBG] Created DbConnection. (61ms).
2023-03-20 15:51:59.004 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (76ms).
2023-03-20 15:51:59.007 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (80ms).
2023-03-20 15:51:59.013 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:01.608 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:01.621 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:52:01.693 +04:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:52:01.751 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.792 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.794 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.796 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.797 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.799 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.800 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.801 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.803 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.805 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.806 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.808 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.809 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.810 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.812 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.813 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.814 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.816 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.817 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.820 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.822 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.824 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.826 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.827 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.829 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.831 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.833 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.834 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.836 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.838 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.839 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.841 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.843 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.844 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.846 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.848 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.849 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.851 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.853 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.855 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.862 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.864 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:01.893 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:01.901 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 199ms reading results.
2023-03-20 15:52:01.907 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:01.915 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (7ms).
2023-03-20 15:52:01.947 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 15:52:02.022 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 15:52:02.104 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:52:02.119 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:52:02.120 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:52:02.125 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 15:52:02.126 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.129 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.134 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:52:02.647 +04:00 [INF] Executed DbCommand (516ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:52:02.653 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.678 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.689 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.700 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.702 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 52ms reading results.
2023-03-20 15:52:02.704 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.705 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:52:02.712 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 15:52:02.720 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 15:52:02.770 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 15:52:02.780 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:52:02.781 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:52:02.783 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:52:02.784 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.785 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.786 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:52:02.801 +04:00 [INF] Executed DbCommand (15ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:52:02.816 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.819 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.853 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.855 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:52:02.858 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.859 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 54ms reading results.
2023-03-20 15:52:02.860 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.861 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:52:02.868 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 15:52:02.872 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 15:52:02.885 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 15:52:02.891 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:52:02.892 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:52:02.893 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:52:02.894 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.895 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.896 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 15:52:02.902 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 15:52:02.905 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.906 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:52:02.908 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:02.909 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:52:02.913 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accounts_0
        .Any(a => (Guid?)a.Id == t.AccountFromId))'
2023-03-20 15:52:03.404 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 6233.2048ms
2023-03-20 15:52:03.408 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:52:03.481 +04:00 [ERR] The LINQ expression 'a => (Guid?)a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'a => (Guid?)a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ATM.Api.Repositories.TransactionRepository.GetAccountsTransactionsAsync(List`1 accounts) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Repositories\TransactionRepository.cs:line 43
   at ATM.Services.CashoutService.IsCashOutPossibleAsync(Guid accountId, Decimal requestedAmount) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 71
   at ATM.Services.CashoutService.PerformCashoutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 85
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\TransactionController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 15:52:03.596 +04:00 [DBG] Connection id "0HMP975VEQ3LV" completed keep alive response.
2023-03-20 15:52:03.599 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:52:03.604 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:52:03.606 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 15:52:03.608 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 500 - application/json 6809.6395ms
2023-03-20 15:55:48.723 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 15:55:48.727 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 15:55:48.728 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 15:55:48.730 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:55:48.731 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 15:55:48.741 +04:00 [DBG] Successfully validated the token.
2023-03-20 15:55:48.742 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 15:55:48.744 +04:00 [DBG] Authorization was successful.
2023-03-20 15:55:48.746 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:55:48.747 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 15:55:48.752 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 15:55:48.753 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 15:55:48.755 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 15:55:48.759 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 15:55:48.760 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 15:55:48.762 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:55:48.765 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 15:55:48.800 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:55:48.802 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 15:55:48.805 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 15:55:48.807 +04:00 [DBG] Connection id "0HMP975VEQ3LV", Request id "0HMP975VEQ3LV:00000002": started reading request body.
2023-03-20 15:55:48.808 +04:00 [DBG] Connection id "0HMP975VEQ3LV", Request id "0HMP975VEQ3LV:00000002": done reading request body.
2023-03-20 15:55:48.810 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 15:55:48.811 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:55:48.815 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:55:48.817 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 15:55:48.821 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 15:55:48.836 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 15:55:48.840 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:55:48.841 +04:00 [DBG] Creating DbConnection.
2023-03-20 15:55:48.842 +04:00 [DBG] Created DbConnection. (1ms).
2023-03-20 15:55:48.843 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2023-03-20 15:55:48.846 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-03-20 15:55:48.848 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.849 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.851 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:55:48.855 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 15:55:48.858 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.860 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.864 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.866 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.868 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.871 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.872 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.874 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.875 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.880 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.882 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.883 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.886 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.888 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.890 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.893 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.897 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.899 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.901 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.903 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.905 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.908 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.912 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.913 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.916 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.917 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.920 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.922 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.926 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.928 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.930 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.932 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.934 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.936 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.938 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.943 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.945 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.947 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.949 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.950 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.952 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.955 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.960 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.962 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.963 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 105ms reading results.
2023-03-20 15:55:48.965 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.967 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:55:48.974 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:55:48.975 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:55:48.977 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:55:48.978 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.980 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:48.981 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:55:48.989 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 15:55:48.994 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.996 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:48.998 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:49.000 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.001 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 7ms reading results.
2023-03-20 15:55:49.006 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.008 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:55:49.010 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:55:49.011 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 15:55:49.012 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:55:49.014 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.015 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.017 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:55:49.032 +04:00 [INF] Executed DbCommand (15ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 15:55:49.041 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:49.044 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:49.047 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:49.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 15:55:49.051 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.057 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 15ms reading results.
2023-03-20 15:55:49.059 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.060 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:55:49.062 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 15:55:49.063 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 15:55:49.065 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 15:55:49.066 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.071 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.072 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 15:55:49.080 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 15:55:49.088 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.089 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 15:55:49.092 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.093 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 15:55:49.095 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accounts_0
        .Any(a => (Guid?)a.Id == t.AccountFromId))'
2023-03-20 15:55:49.269 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 505.9736ms
2023-03-20 15:55:49.271 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 15:55:49.344 +04:00 [ERR] The LINQ expression 'a => (Guid?)a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'a => (Guid?)a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ATM.Api.Repositories.TransactionRepository.GetAccountsTransactionsAsync(List`1 accounts) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Repositories\TransactionRepository.cs:line 43
   at ATM.Services.CashoutService.IsCashOutPossibleAsync(Guid accountId, Decimal requestedAmount) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 71
   at ATM.Services.CashoutService.PerformCashoutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 85
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\TransactionController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 15:55:49.391 +04:00 [DBG] Connection id "0HMP975VEQ3LV" completed keep alive response.
2023-03-20 15:55:49.392 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 15:55:49.394 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 15:55:49.395 +04:00 [DBG] Disposed connection to database '' on server '' (1ms).
2023-03-20 15:55:49.397 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 500 - application/json 674.3730ms
2023-03-20 16:00:25.816 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:00:25.999 +04:00 [DBG] Hosting starting
2023-03-20 16:00:26.052 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:00:26.059 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:00:26.067 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:00:26.073 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:00:26.080 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:00:26.087 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:00:26.092 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:00:26.095 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:00:26.098 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:00:26.103 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:00:26.109 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:00:26.115 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:00:26.117 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:00:26.309 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:00:26.310 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:00:26.311 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:00:26.323 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:00:26.324 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:00:26.326 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:00:26.327 +04:00 [INF] Hosting environment: Development
2023-03-20 16:00:26.328 +04:00 [DBG] Connection id "0HMP97AOLHEDN" received FIN.
2023-03-20 16:00:26.330 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:00:26.332 +04:00 [DBG] Hosting started
2023-03-20 16:00:26.337 +04:00 [DBG] Connection id "0HMP97AOLHEDN" accepted.
2023-03-20 16:00:26.339 +04:00 [DBG] Connection id "0HMP97AOLHEDN" started.
2023-03-20 16:00:26.358 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:00:26.433 +04:00 [DBG] Connection id "0HMP97AOLHEDN" stopped.
2023-03-20 16:00:26.437 +04:00 [DBG] Connection id "0HMP97AOLHEDN" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:00:26.896 +04:00 [DBG] Connection id "0HMP97AOLHEDO" accepted.
2023-03-20 16:00:26.901 +04:00 [DBG] Connection id "0HMP97AOLHEDO" started.
2023-03-20 16:00:26.979 +04:00 [DBG] Connection 0HMP97AOLHEDO established using the following protocol: "Tls12"
2023-03-20 16:00:27.057 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:00:27.089 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:00:27.119 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:00:27.120 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:00:27.317 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:00:27.346 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:00:27.351 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 294.6755ms
2023-03-20 16:00:27.368 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:00:27.376 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.4901ms
2023-03-20 16:00:27.401 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:00:27.453 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 51.6282ms
2023-03-20 16:00:27.545 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:00:27.547 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:00:27.549 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:00:27.691 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 145.7852ms
2023-03-20 16:00:31.137 +04:00 [DBG] Connection id "0HMP97AOLHEDP" accepted.
2023-03-20 16:00:31.138 +04:00 [DBG] Connection id "0HMP97AOLHEDP" received FIN.
2023-03-20 16:00:31.139 +04:00 [DBG] Connection id "0HMP97AOLHEDP" started.
2023-03-20 16:00:31.139 +04:00 [DBG] Connection id "0HMP97AOLHEDQ" accepted.
2023-03-20 16:00:31.142 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:00:31.142 +04:00 [DBG] Connection id "0HMP97AOLHEDQ" started.
2023-03-20 16:00:31.146 +04:00 [DBG] Connection id "0HMP97AOLHEDP" stopped.
2023-03-20 16:00:31.148 +04:00 [DBG] Connection id "0HMP97AOLHEDP" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:00:31.154 +04:00 [DBG] Connection 0HMP97AOLHEDQ established using the following protocol: "Tls12"
2023-03-20 16:00:31.163 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:00:31.168 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:00:31.172 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:00:31.175 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:00:31.178 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:00:31.438 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:00:31.440 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:00:31.448 +04:00 [DBG] Authorization was successful.
2023-03-20 16:00:31.452 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:00:31.487 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:00:31.491 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:00:31.493 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:00:31.495 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:00:31.497 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:00:31.499 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:00:31.502 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:00:31.680 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:00:31.710 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:00:31.729 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:00:31.734 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:00:31.737 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:00:31.749 +04:00 [DBG] Connection id "0HMP97AOLHEDQ", Request id "0HMP97AOLHEDQ:00000001": started reading request body.
2023-03-20 16:00:31.750 +04:00 [DBG] Connection id "0HMP97AOLHEDQ", Request id "0HMP97AOLHEDQ:00000001": done reading request body.
2023-03-20 16:00:31.758 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:00:31.760 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:00:31.762 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:00:31.763 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:00:31.774 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:00:32.290 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:00:32.292 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:00:32.658 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:00:32.717 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:00:32.856 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:00:32.892 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:00:32.896 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:00:32.935 +04:00 [DBG] Created DbConnection. (36ms).
2023-03-20 16:00:32.946 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (52ms).
2023-03-20 16:00:32.950 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (59ms).
2023-03-20 16:00:32.955 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:33.703 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:33.716 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:00:33.777 +04:00 [INF] Executed DbCommand (62ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:00:33.823 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.870 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.873 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.875 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.877 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.879 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.882 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.885 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.889 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.891 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.893 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.895 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.898 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.900 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.905 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.907 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.910 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.912 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.914 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.916 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.922 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.924 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.927 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.929 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.931 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.934 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.940 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.942 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.944 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.946 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.948 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.953 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.955 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.957 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.959 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.961 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.964 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.966 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.972 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.974 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.977 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.984 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.987 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:33.996 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.006 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 216ms reading results.
2023-03-20 16:00:34.013 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.025 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (11ms).
2023-03-20 16:00:34.063 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:00:34.108 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:00:34.176 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:00:34.190 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:00:34.192 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:00:34.196 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 16:00:34.197 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.201 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.207 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:00:34.236 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:00:34.245 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.294 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.308 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.321 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.323 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 82ms reading results.
2023-03-20 16:00:34.325 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.326 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:00:34.337 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:00:34.346 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:00:34.416 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:00:34.430 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:00:34.431 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:00:34.433 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:00:34.434 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.439 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.440 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:00:34.448 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:00:34.471 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.476 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.514 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.517 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:00:34.520 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.521 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 64ms reading results.
2023-03-20 16:00:34.523 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.524 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:00:34.531 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:00:34.536 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:00:34.552 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:00:34.563 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:00:34.564 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:00:34.569 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 16:00:34.570 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.572 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.573 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:00:34.584 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:00:34.588 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.589 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:00:34.594 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:34.596 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:00:34.601 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accounts_0
        .Any(a => a.Id == t.AccountFromId))'
2023-03-20 16:00:34.771 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 3267.3816ms
2023-03-20 16:00:34.775 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:00:34.852 +04:00 [DBG] Connection id "0HMP97AOLHEDO" received FIN.
2023-03-20 16:00:34.853 +04:00 [ERR] The LINQ expression 'a => a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'a => a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ATM.Api.Repositories.TransactionRepository.GetAccountsTransactionsAsync(List`1 accounts) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Repositories\TransactionRepository.cs:line 43
   at ATM.Services.CashoutService.IsCashOutPossibleAsync(Guid accountId, Decimal requestedAmount) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 71
   at ATM.Services.CashoutService.PerformCashoutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 85
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\TransactionController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 16:00:34.854 +04:00 [DBG] Connection id "0HMP97AOLHEDO" is closed. The last processed stream ID was 7.
2023-03-20 16:00:34.855 +04:00 [DBG] The connection queue processing loop for 0HMP97AOLHEDO completed.
2023-03-20 16:00:34.928 +04:00 [DBG] Connection id "0HMP97AOLHEDO" sending FIN because: "The client closed the connection."
2023-03-20 16:00:34.937 +04:00 [DBG] Connection id "0HMP97AOLHEDO" stopped.
2023-03-20 16:00:35.014 +04:00 [DBG] Connection id "0HMP97AOLHEDQ" completed keep alive response.
2023-03-20 16:00:35.019 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 16:00:35.023 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:00:35.026 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 16:00:35.028 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 500 - application/json 3865.6611ms
2023-03-20 16:02:40.915 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:02:41.016 +04:00 [DBG] Hosting starting
2023-03-20 16:02:41.074 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:02:41.081 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:02:41.088 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:02:41.093 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:02:41.097 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:02:41.104 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:02:41.107 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:02:41.110 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:02:41.112 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:02:41.116 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:02:41.122 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:02:41.126 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:02:41.127 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:02:41.330 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:02:41.332 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:02:41.333 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:02:41.334 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:02:41.335 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:02:41.336 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:02:41.337 +04:00 [INF] Hosting environment: Development
2023-03-20 16:02:41.338 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:02:41.338 +04:00 [DBG] Hosting started
2023-03-20 16:02:41.469 +04:00 [DBG] Connection id "0HMP97C0UB98O" accepted.
2023-03-20 16:02:41.469 +04:00 [DBG] Connection id "0HMP97C0UB98P" accepted.
2023-03-20 16:02:41.471 +04:00 [DBG] Connection id "0HMP97C0UB98O" started.
2023-03-20 16:02:41.472 +04:00 [DBG] Connection id "0HMP97C0UB98P" started.
2023-03-20 16:02:41.490 +04:00 [DBG] Connection id "0HMP97C0UB98O" received FIN.
2023-03-20 16:02:41.490 +04:00 [DBG] Connection id "0HMP97C0UB98P" received FIN.
2023-03-20 16:02:41.505 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:02:41.505 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:02:41.555 +04:00 [DBG] Connection id "0HMP97C0UB98P" stopped.
2023-03-20 16:02:41.555 +04:00 [DBG] Connection id "0HMP97C0UB98O" stopped.
2023-03-20 16:02:41.558 +04:00 [DBG] Connection id "0HMP97C0UB98O" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:02:41.558 +04:00 [DBG] Connection id "0HMP97C0UB98P" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:02:42.036 +04:00 [DBG] Connection id "0HMP97C0UB98Q" accepted.
2023-03-20 16:02:42.039 +04:00 [DBG] Connection id "0HMP97C0UB98Q" started.
2023-03-20 16:02:42.138 +04:00 [DBG] Connection 0HMP97C0UB98Q established using the following protocol: "Tls12"
2023-03-20 16:02:42.238 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:02:42.282 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:02:42.316 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:02:42.318 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:02:42.519 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:02:42.552 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:02:42.555 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 320.6707ms
2023-03-20 16:02:42.574 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:02:42.585 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.5774ms
2023-03-20 16:02:42.611 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:02:42.657 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 45.8303ms
2023-03-20 16:02:42.761 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:02:42.764 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:02:42.765 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:02:42.940 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 178.1640ms
2023-03-20 16:02:45.406 +04:00 [DBG] Connection id "0HMP97C0UB98R" accepted.
2023-03-20 16:02:45.407 +04:00 [DBG] Connection id "0HMP97C0UB98R" received FIN.
2023-03-20 16:02:45.408 +04:00 [DBG] Connection id "0HMP97C0UB98R" started.
2023-03-20 16:02:45.408 +04:00 [DBG] Connection id "0HMP97C0UB98S" accepted.
2023-03-20 16:02:45.410 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:02:45.411 +04:00 [DBG] Connection id "0HMP97C0UB98S" started.
2023-03-20 16:02:45.415 +04:00 [DBG] Connection id "0HMP97C0UB98R" stopped.
2023-03-20 16:02:45.418 +04:00 [DBG] Connection id "0HMP97C0UB98R" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:02:45.423 +04:00 [DBG] Connection 0HMP97C0UB98S established using the following protocol: "Tls12"
2023-03-20 16:02:45.434 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:02:45.441 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:02:45.446 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:02:45.448 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:02:45.451 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:02:45.719 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:02:45.722 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:02:45.730 +04:00 [DBG] Authorization was successful.
2023-03-20 16:02:45.735 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:02:45.773 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:02:45.778 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:02:45.780 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:02:45.782 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:02:45.784 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:02:45.786 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:02:45.790 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:02:45.983 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:02:46.010 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:02:46.029 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:02:46.033 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:02:46.037 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:02:46.058 +04:00 [DBG] Connection id "0HMP97C0UB98S", Request id "0HMP97C0UB98S:00000001": started reading request body.
2023-03-20 16:02:46.060 +04:00 [DBG] Connection id "0HMP97C0UB98S", Request id "0HMP97C0UB98S:00000001": done reading request body.
2023-03-20 16:02:46.073 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:02:46.075 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:02:46.076 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:02:46.078 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:02:46.097 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:02:46.664 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:02:46.666 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:02:47.083 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:02:47.148 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:02:47.282 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:02:47.312 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:02:47.315 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:02:47.351 +04:00 [DBG] Created DbConnection. (32ms).
2023-03-20 16:02:47.364 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (48ms).
2023-03-20 16:02:47.368 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (57ms).
2023-03-20 16:02:47.376 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:47.777 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:47.791 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:02:47.841 +04:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:02:47.879 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.912 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.914 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.916 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.917 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.919 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.920 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.921 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.922 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.924 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.925 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.926 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.927 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.929 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.930 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.932 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.933 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.935 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.936 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.937 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.938 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.940 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.941 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.942 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.943 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.945 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.946 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.948 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.949 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.950 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.951 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.953 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.954 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.955 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.956 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.958 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.959 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.960 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.961 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.963 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.965 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.969 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.970 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:47.976 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:47.985 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 134ms reading results.
2023-03-20 16:02:47.989 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:47.997 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (7ms).
2023-03-20 16:02:48.028 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:02:48.087 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:02:48.158 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:02:48.169 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:02:48.170 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:02:48.174 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:02:48.175 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.177 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.181 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:02:48.208 +04:00 [INF] Executed DbCommand (30ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:02:48.216 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.242 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.252 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.261 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.264 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 52ms reading results.
2023-03-20 16:02:48.266 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.267 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:02:48.273 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:02:48.280 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:02:48.357 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:02:48.369 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:02:48.371 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:02:48.372 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:02:48.373 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.375 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.376 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:02:48.386 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:02:48.423 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.428 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.500 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.503 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:02:48.505 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.507 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 116ms reading results.
2023-03-20 16:02:48.509 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.510 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:02:48.518 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:02:48.522 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:02:48.540 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:02:48.547 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:02:48.548 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:02:48.550 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:02:48.551 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.553 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.554 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:02:48.560 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:02:48.565 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.566 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:02:48.567 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.568 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:02:48.573 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accounts_0
        .Any(a => a.Id == t.AccountFromId))'
2023-03-20 16:02:48.786 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 2994.9008ms
2023-03-20 16:02:48.790 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:02:48.877 +04:00 [ERR] The LINQ expression 'a => a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
System.InvalidOperationException: The LINQ expression 'a => a.Id == EntityShaperExpression: 
    BankSystem.Common.Db.Entities.TransactionEntity
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
.AccountFromId' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ATM.Api.Repositories.TransactionRepository.GetAccountsTransactionsAsync(List`1 accounts) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Repositories\TransactionRepository.cs:line 43
   at ATM.Services.CashoutService.IsCashOutPossibleAsync(Guid accountId, Decimal requestedAmount) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 71
   at ATM.Services.CashoutService.PerformCashoutAsync(CashOutRequest request, Guid cardId) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Services\Services\CashoutService.cs:line 85
   at ATM.Api.Controllers.TransactionController.CashOut(CashOutRequest request) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Controllers\TransactionController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ATM.Api.Middlewares.GlobalExceptionHandlingMiddleware.InvokeAsync(HttpContext httpContext, RequestDelegate next) in C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api\Middlewares\GlobalExceptionHandlingMiddleware.cs:line 45
2023-03-20 16:02:48.979 +04:00 [DBG] Connection id "0HMP97C0UB98S" completed keep alive response.
2023-03-20 16:02:48.982 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 16:02:48.986 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:02:48.989 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 16:02:48.991 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 500 - application/json 3556.8597ms
2023-03-20 16:02:50.051 +04:00 [DBG] Connection id "0HMP97C0UB98Q" received FIN.
2023-03-20 16:02:50.065 +04:00 [DBG] The connection queue processing loop for 0HMP97C0UB98Q completed.
2023-03-20 16:02:50.065 +04:00 [DBG] Connection id "0HMP97C0UB98Q" is closed. The last processed stream ID was 7.
2023-03-20 16:02:50.067 +04:00 [DBG] Connection id "0HMP97C0UB98Q" sending FIN because: "The client closed the connection."
2023-03-20 16:02:50.084 +04:00 [DBG] Connection id "0HMP97C0UB98Q" stopped.
2023-03-20 16:03:18.483 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:03:18.696 +04:00 [DBG] Hosting starting
2023-03-20 16:03:18.792 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:03:18.804 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:03:18.818 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:03:18.828 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:03:18.835 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:03:18.842 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:03:18.848 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:03:18.852 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:03:18.855 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:03:18.859 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:03:18.866 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:03:18.872 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:03:18.874 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:03:19.082 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:03:19.083 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:03:19.084 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:03:19.085 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:03:19.086 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:03:19.087 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:03:19.088 +04:00 [INF] Hosting environment: Development
2023-03-20 16:03:19.089 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:03:19.089 +04:00 [DBG] Hosting started
2023-03-20 16:03:19.294 +04:00 [DBG] Connection id "0HMP97CC72HP7" accepted.
2023-03-20 16:03:19.296 +04:00 [DBG] Connection id "0HMP97CC72HP7" started.
2023-03-20 16:03:19.319 +04:00 [DBG] Connection id "0HMP97CC72HP7" received FIN.
2023-03-20 16:03:19.326 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:03:19.375 +04:00 [DBG] Connection id "0HMP97CC72HP7" stopped.
2023-03-20 16:03:19.380 +04:00 [DBG] Connection id "0HMP97CC72HP7" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:03:19.831 +04:00 [DBG] Connection id "0HMP97CC72HP8" accepted.
2023-03-20 16:03:19.833 +04:00 [DBG] Connection id "0HMP97CC72HP8" started.
2023-03-20 16:03:19.898 +04:00 [DBG] Connection 0HMP97CC72HP8 established using the following protocol: "Tls12"
2023-03-20 16:03:19.994 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:03:20.020 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:03:20.049 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:03:20.050 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:03:20.273 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:03:20.305 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:03:20.310 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 316.3599ms
2023-03-20 16:03:20.327 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:03:20.338 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 11.3754ms
2023-03-20 16:03:20.359 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:03:20.396 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 36.1637ms
2023-03-20 16:03:20.486 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:03:20.487 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:03:20.489 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:03:20.633 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 146.7912ms
2023-03-20 16:03:22.591 +04:00 [DBG] Connection id "0HMP97CC72HP9" accepted.
2023-03-20 16:03:22.591 +04:00 [DBG] Connection id "0HMP97CC72HP9" received FIN.
2023-03-20 16:03:22.592 +04:00 [DBG] Connection id "0HMP97CC72HP9" started.
2023-03-20 16:03:22.593 +04:00 [DBG] Connection id "0HMP97CC72HPA" accepted.
2023-03-20 16:03:22.595 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:03:22.596 +04:00 [DBG] Connection id "0HMP97CC72HPA" started.
2023-03-20 16:03:22.599 +04:00 [DBG] Connection id "0HMP97CC72HP9" stopped.
2023-03-20 16:03:22.602 +04:00 [DBG] Connection id "0HMP97CC72HP9" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:03:22.608 +04:00 [DBG] Connection 0HMP97CC72HPA established using the following protocol: "Tls12"
2023-03-20 16:03:22.619 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:03:22.625 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:03:22.629 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:03:22.631 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:03:22.635 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:03:22.901 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:03:22.903 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:03:22.912 +04:00 [DBG] Authorization was successful.
2023-03-20 16:03:22.916 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:03:22.944 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:03:22.948 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:03:22.949 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:03:22.950 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:03:22.952 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:03:22.954 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:03:22.956 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:03:23.127 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:03:23.153 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:03:23.170 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:03:23.174 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:03:23.177 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:03:23.188 +04:00 [DBG] Connection id "0HMP97CC72HPA", Request id "0HMP97CC72HPA:00000001": started reading request body.
2023-03-20 16:03:23.189 +04:00 [DBG] Connection id "0HMP97CC72HPA", Request id "0HMP97CC72HPA:00000001": done reading request body.
2023-03-20 16:03:23.195 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:03:23.197 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:03:23.198 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:03:23.199 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:03:23.210 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:03:23.736 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:03:23.738 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:03:24.138 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:03:24.208 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:03:24.352 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:03:24.404 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:03:24.408 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:03:24.451 +04:00 [DBG] Created DbConnection. (41ms).
2023-03-20 16:03:24.462 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (59ms).
2023-03-20 16:03:24.466 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (66ms).
2023-03-20 16:03:24.471 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:24.916 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:24.926 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:03:24.983 +04:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:03:25.034 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.096 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.099 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.101 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.102 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.104 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.106 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.108 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.109 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.111 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.113 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.115 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.117 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.119 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.121 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.123 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.125 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.127 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.129 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.131 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.133 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.135 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.137 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.139 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.141 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.143 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.145 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.148 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.150 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.151 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.153 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.155 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.156 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.158 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.160 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.161 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.164 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.165 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.166 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.168 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.169 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.173 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.175 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.182 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.188 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 197ms reading results.
2023-03-20 16:03:25.192 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.199 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-03-20 16:03:25.222 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:03:25.276 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:03:25.375 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:03:25.390 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:03:25.391 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:03:25.397 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2023-03-20 16:03:25.398 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.401 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.406 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:03:25.435 +04:00 [INF] Executed DbCommand (32ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:03:25.441 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.474 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.483 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.492 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.494 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 56ms reading results.
2023-03-20 16:03:25.497 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.498 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:03:25.503 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:03:25.509 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:03:25.567 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:03:25.578 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:03:25.579 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:03:25.581 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 16:03:25.583 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.584 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.585 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:03:25.595 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:03:25.617 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.621 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.671 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.674 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.677 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.679 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 80ms reading results.
2023-03-20 16:03:25.682 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.683 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:03:25.691 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:03:25.697 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:03:25.712 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:03:25.718 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:03:25.719 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:03:25.721 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:03:25.722 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.723 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.724 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:03:25.730 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:03:25.733 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.734 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:03:25.735 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.736 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:03:25.741 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:03:25.762 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:03:25.769 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:03:25.770 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:03:25.771 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:03:25.772 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.773 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.774 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:03:25.785 +04:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:03:25.791 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.808 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:03:25.809 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.810 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 23ms reading results.
2023-03-20 16:03:25.812 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:03:25.814 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:09:48.429 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:09:48.582 +04:00 [DBG] Hosting starting
2023-03-20 16:09:48.656 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:09:48.665 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:09:48.675 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:09:48.682 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:09:48.687 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:09:48.695 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:09:48.700 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:09:48.704 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:09:48.708 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:09:48.715 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:09:48.720 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:09:48.725 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:09:48.727 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:09:48.920 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:09:48.921 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:09:48.923 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:09:48.924 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:09:48.925 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:09:48.926 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:09:48.926 +04:00 [INF] Hosting environment: Development
2023-03-20 16:09:48.927 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:09:48.928 +04:00 [DBG] Hosting started
2023-03-20 16:09:49.006 +04:00 [DBG] Connection id "0HMP97G0BL66O" accepted.
2023-03-20 16:09:49.006 +04:00 [DBG] Connection id "0HMP97G0BL66N" accepted.
2023-03-20 16:09:49.013 +04:00 [DBG] Connection id "0HMP97G0BL66O" received FIN.
2023-03-20 16:09:49.013 +04:00 [DBG] Connection id "0HMP97G0BL66N" started.
2023-03-20 16:09:49.013 +04:00 [DBG] Connection id "0HMP97G0BL66N" received FIN.
2023-03-20 16:09:49.013 +04:00 [DBG] Connection id "0HMP97G0BL66O" started.
2023-03-20 16:09:49.030 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:09:49.030 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:09:49.072 +04:00 [DBG] Connection id "0HMP97G0BL66O" stopped.
2023-03-20 16:09:49.072 +04:00 [DBG] Connection id "0HMP97G0BL66N" stopped.
2023-03-20 16:09:49.075 +04:00 [DBG] Connection id "0HMP97G0BL66N" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:09:49.075 +04:00 [DBG] Connection id "0HMP97G0BL66O" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:09:49.818 +04:00 [DBG] Connection id "0HMP97G0BL66P" accepted.
2023-03-20 16:09:49.824 +04:00 [DBG] Connection id "0HMP97G0BL66P" started.
2023-03-20 16:09:49.902 +04:00 [DBG] Connection 0HMP97G0BL66P established using the following protocol: "Tls12"
2023-03-20 16:09:50.006 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:09:50.041 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:09:50.066 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:09:50.068 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:09:50.277 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:09:50.304 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:09:50.307 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 304.1724ms
2023-03-20 16:09:50.325 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:09:50.331 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.1790ms
2023-03-20 16:09:50.362 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:09:50.425 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 62.7243ms
2023-03-20 16:09:50.517 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:09:50.520 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:09:50.523 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:09:50.777 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 260.2442ms
2023-03-20 16:09:58.081 +04:00 [DBG] Connection id "0HMP97G0BL66Q" accepted.
2023-03-20 16:09:58.082 +04:00 [DBG] Connection id "0HMP97G0BL66Q" received FIN.
2023-03-20 16:09:58.083 +04:00 [DBG] Connection id "0HMP97G0BL66Q" started.
2023-03-20 16:09:58.084 +04:00 [DBG] Connection id "0HMP97G0BL66R" accepted.
2023-03-20 16:09:58.089 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:09:58.090 +04:00 [DBG] Connection id "0HMP97G0BL66R" started.
2023-03-20 16:09:58.097 +04:00 [DBG] Connection id "0HMP97G0BL66Q" stopped.
2023-03-20 16:09:58.101 +04:00 [DBG] Connection id "0HMP97G0BL66Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:09:58.106 +04:00 [DBG] Connection 0HMP97G0BL66R established using the following protocol: "Tls12"
2023-03-20 16:09:58.120 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:09:58.128 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:09:58.134 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:09:58.137 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:09:58.142 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:09:58.459 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:09:58.463 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:09:58.476 +04:00 [DBG] Authorization was successful.
2023-03-20 16:09:58.482 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:09:58.526 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:09:58.532 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:09:58.535 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:09:58.538 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:09:58.543 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:09:58.545 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:09:58.549 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:09:58.711 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:09:58.742 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:09:58.767 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:09:58.774 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:09:58.779 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:09:58.796 +04:00 [DBG] Connection id "0HMP97G0BL66R", Request id "0HMP97G0BL66R:00000001": started reading request body.
2023-03-20 16:09:58.798 +04:00 [DBG] Connection id "0HMP97G0BL66R", Request id "0HMP97G0BL66R:00000001": done reading request body.
2023-03-20 16:09:58.809 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:09:58.811 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:09:58.813 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:09:58.815 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:09:58.832 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:09:59.321 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:09:59.327 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:09:59.707 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:09:59.748 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:09:59.881 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:09:59.916 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:09:59.920 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:09:59.950 +04:00 [DBG] Created DbConnection. (27ms).
2023-03-20 16:09:59.959 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (40ms).
2023-03-20 16:09:59.962 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (47ms).
2023-03-20 16:09:59.967 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.191 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.200 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:10:00.245 +04:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:10:00.274 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.304 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.306 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.308 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.309 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.310 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.311 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.313 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.314 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.315 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.317 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.318 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.319 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.322 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.323 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.325 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.326 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.327 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.328 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.330 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.331 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.332 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.334 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.335 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.337 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.338 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.340 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.341 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.342 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.344 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.345 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.346 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.348 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.349 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.351 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.352 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.353 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.355 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.356 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.358 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.359 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.363 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.365 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.371 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.378 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 127ms reading results.
2023-03-20 16:10:00.383 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.389 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-03-20 16:10:00.411 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:10:00.458 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:10:00.520 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:10:00.533 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:00.534 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:00.538 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:10:00.540 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.542 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.546 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:10:00.579 +04:00 [INF] Executed DbCommand (35ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:10:00.586 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.616 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.630 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.645 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.647 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 64ms reading results.
2023-03-20 16:10:00.649 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.651 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:10:00.659 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:10:00.667 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:10:00.740 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:10:00.751 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:00.753 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:00.754 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:10:00.755 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.756 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.757 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:10:00.770 +04:00 [INF] Executed DbCommand (13ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:10:00.787 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.791 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.828 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.830 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.833 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.834 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 60ms reading results.
2023-03-20 16:10:00.836 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.838 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:10:00.842 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:10:00.846 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:10:00.860 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:10:00.867 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:00.868 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:00.869 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:10:00.870 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.872 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.873 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:10:00.877 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:10:00.880 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.882 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:10:00.883 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.884 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:10:00.889 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:10:00.909 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:10:00.916 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:00.917 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 16:10:00.918 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:00.919 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.920 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.921 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:10:00.925 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:10:00.930 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.947 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:00.949 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.951 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 24ms reading results.
2023-03-20 16:10:00.952 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:00.953 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:10:10.417 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:10.419 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:10.422 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:10:10.424 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.426 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.427 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:10:10.434 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:10:10.439 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.441 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 2ms reading results.
2023-03-20 16:10:10.444 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.445 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:10:10.480 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.513 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.521 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 16:10:10.526 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 16:10:10.601 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 16:10:10.610 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.651 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 16:10:10.773 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 16:10:10.778 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.781 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.784 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 16:10:10.795 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 16:10:10.801 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:10:10.802 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:10:10.812 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2023-03-20 16:10:10.814 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 16:10:10.834 +04:00 [INF] Executed DbCommand (19ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 16:10:10.846 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.848 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 10ms reading results.
2023-03-20 16:10:10.859 +04:00 [DBG] Committing transaction.
2023-03-20 16:10:10.866 +04:00 [DBG] Committed transaction.
2023-03-20 16:10:10.871 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.873 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (2ms).
2023-03-20 16:10:10.879 +04:00 [DBG] Disposing transaction.
2023-03-20 16:10:10.886 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.891 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.895 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:10:10.900 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 16:10:10.910 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 16:10:10.916 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 16:10:10.918 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 16:10:10.919 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 16:10:10.923 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 16:10:10.927 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 16:10:10.963 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 12411.7657ms
2023-03-20 16:10:10.966 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:10:10.970 +04:00 [DBG] Connection id "0HMP97G0BL66R" completed keep alive response.
2023-03-20 16:10:10.975 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 16:10:10.983 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:10:10.985 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 16:10:10.987 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 200 - application/json;+charset=utf-8 12867.5692ms
2023-03-20 16:17:48.079 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:17:48.202 +04:00 [DBG] Hosting starting
2023-03-20 16:17:48.286 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:17:48.293 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:17:48.300 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:17:48.308 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:17:48.314 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:17:48.322 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:17:48.327 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:17:48.331 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:17:48.333 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:17:48.338 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:17:48.343 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:17:48.349 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:17:48.351 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:17:48.555 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:17:48.556 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:17:48.557 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:17:48.558 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:17:48.559 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:17:48.560 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:17:48.561 +04:00 [INF] Hosting environment: Development
2023-03-20 16:17:48.562 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:17:48.563 +04:00 [DBG] Hosting started
2023-03-20 16:17:48.852 +04:00 [DBG] Connection id "0HMP97KFBQD9C" accepted.
2023-03-20 16:17:48.854 +04:00 [DBG] Connection id "0HMP97KFBQD9C" started.
2023-03-20 16:17:48.860 +04:00 [DBG] Connection id "0HMP97KFBQD9D" accepted.
2023-03-20 16:17:48.861 +04:00 [DBG] Connection id "0HMP97KFBQD9D" started.
2023-03-20 16:17:48.893 +04:00 [DBG] Connection id "0HMP97KFBQD9C" received FIN.
2023-03-20 16:17:48.893 +04:00 [DBG] Connection id "0HMP97KFBQD9D" received FIN.
2023-03-20 16:17:48.909 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:17:48.909 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:17:48.972 +04:00 [DBG] Connection id "0HMP97KFBQD9D" stopped.
2023-03-20 16:17:48.972 +04:00 [DBG] Connection id "0HMP97KFBQD9C" stopped.
2023-03-20 16:17:48.976 +04:00 [DBG] Connection id "0HMP97KFBQD9D" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:17:48.976 +04:00 [DBG] Connection id "0HMP97KFBQD9C" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:17:49.280 +04:00 [DBG] Connection id "0HMP97KFBQD9E" accepted.
2023-03-20 16:17:49.281 +04:00 [DBG] Connection id "0HMP97KFBQD9E" started.
2023-03-20 16:17:49.343 +04:00 [DBG] Connection 0HMP97KFBQD9E established using the following protocol: "Tls12"
2023-03-20 16:17:49.456 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:17:49.484 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:17:49.509 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:17:49.511 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:17:49.710 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:17:49.741 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:17:49.745 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 290.3992ms
2023-03-20 16:17:49.771 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:17:49.779 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.3336ms
2023-03-20 16:17:49.819 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:17:49.871 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 52.8577ms
2023-03-20 16:17:49.959 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:17:49.960 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:17:49.961 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:17:50.065 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 106.1169ms
2023-03-20 16:17:51.662 +04:00 [DBG] Connection id "0HMP97KFBQD9E" received FIN.
2023-03-20 16:17:51.670 +04:00 [DBG] The connection queue processing loop for 0HMP97KFBQD9E completed.
2023-03-20 16:17:51.673 +04:00 [DBG] Connection id "0HMP97KFBQD9E" is closed. The last processed stream ID was 7.
2023-03-20 16:17:51.675 +04:00 [DBG] Connection id "0HMP97KFBQD9E" sending FIN because: "The client closed the connection."
2023-03-20 16:17:51.679 +04:00 [DBG] Connection id "0HMP97KFBQD9E" stopped.
2023-03-20 16:17:56.741 +04:00 [DBG] Connection id "0HMP97KFBQD9F" accepted.
2023-03-20 16:17:56.741 +04:00 [DBG] Connection id "0HMP97KFBQD9F" received FIN.
2023-03-20 16:17:56.742 +04:00 [DBG] Connection id "0HMP97KFBQD9F" started.
2023-03-20 16:17:56.743 +04:00 [DBG] Connection id "0HMP97KFBQD9G" accepted.
2023-03-20 16:17:56.745 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:17:56.746 +04:00 [DBG] Connection id "0HMP97KFBQD9G" started.
2023-03-20 16:17:56.749 +04:00 [DBG] Connection id "0HMP97KFBQD9F" stopped.
2023-03-20 16:17:56.751 +04:00 [DBG] Connection id "0HMP97KFBQD9F" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:17:56.755 +04:00 [DBG] Connection 0HMP97KFBQD9G established using the following protocol: "Tls12"
2023-03-20 16:17:56.766 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:17:56.772 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:17:56.775 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:17:56.777 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:17:56.779 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:17:57.036 +04:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '3/20/2023 12:17:30 PM', Current time: '3/20/2023 12:17:57 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2023-03-20 16:17:57.042 +04:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '3/20/2023 12:17:30 PM', Current time: '3/20/2023 12:17:57 PM'.
2023-03-20 16:17:57.048 +04:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2023-03-20 16:17:57.055 +04:00 [INF] AuthenticationScheme: Bearer was challenged.
2023-03-20 16:17:57.069 +04:00 [DBG] Connection id "0HMP97KFBQD9G" completed keep alive response.
2023-03-20 16:17:57.071 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41 - 401 0 - 304.6480ms
2023-03-20 16:17:57.072 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000001": started reading request body.
2023-03-20 16:17:57.074 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000001": done reading request body.
2023-03-20 16:18:02.286 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 46
2023-03-20 16:18:02.289 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/Login'
2023-03-20 16:18:02.290 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/Login'
2023-03-20 16:18:02.293 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 16:18:02.294 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:18:02.298 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 16:18:02.304 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 16:18:02.337 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 16:18:02.342 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:18:02.344 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:18:02.347 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:18:02.350 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:18:02.352 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:18:02.357 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 16:18:02.585 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:18:02.618 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 16:18:02.627 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 16:18:02.633 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 16:18:02.638 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:18:02.650 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000002": started reading request body.
2023-03-20 16:18:02.652 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000002": done reading request body.
2023-03-20 16:18:02.660 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 16:18:02.662 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 16:18:02.664 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 16:18:02.666 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 16:18:02.682 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 16:18:03.251 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:18:03.253 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:18:03.567 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:18:03.676 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && (int)c.Pin == (int)__request_Pin_1)'
2023-03-20 16:18:03.733 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:18:03.900 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:18:03.947 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:03.950 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:18:03.988 +04:00 [DBG] Created DbConnection. (35ms).
2023-03-20 16:18:03.995 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (49ms).
2023-03-20 16:18:04.007 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (62ms).
2023-03-20 16:18:04.012 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:04.285 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:04.297 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 16:18:04.354 +04:00 [INF] Executed DbCommand (61ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 16:18:04.389 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:04.426 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:04.436 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:04.451 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:04.458 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 96ms reading results.
2023-03-20 16:18:04.462 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:04.468 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-03-20 16:18:04.502 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 16:18:04.506 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 16:18:04.507 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 16:18:04.508 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 16:18:04.510 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 16:18:04.512 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 16:18:04.519 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 2160.5082ms
2023-03-20 16:18:04.521 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 16:18:04.523 +04:00 [DBG] Connection id "0HMP97KFBQD9G" completed keep alive response.
2023-03-20 16:18:04.526 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 16:18:04.532 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:04.534 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 16:18:04.536 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Card/Login application/json 46 - 200 - text/plain;+charset=utf-8 2250.2063ms
2023-03-20 16:18:16.310 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:18:16.311 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:18:16.312 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:18:16.314 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:18:16.315 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:18:16.332 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:18:16.334 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:18:16.338 +04:00 [DBG] Authorization was successful.
2023-03-20 16:18:16.339 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:18:16.344 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:18:16.346 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:18:16.348 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:18:16.349 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:18:16.351 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:18:16.353 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:18:16.354 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:18:16.357 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:18:16.358 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:18:16.360 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:18:16.361 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:18:16.369 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000003": started reading request body.
2023-03-20 16:18:16.370 +04:00 [DBG] Connection id "0HMP97KFBQD9G", Request id "0HMP97KFBQD9G:00000003": done reading request body.
2023-03-20 16:18:16.374 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:18:16.375 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:16.377 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:16.378 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:18:16.383 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:16.399 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:18:16.403 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:18:16.410 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:18:16.414 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:16.415 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:18:16.416 +04:00 [DBG] Created DbConnection. (0ms).
2023-03-20 16:18:16.417 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:16.418 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:18:16.419 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.421 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.423 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:18:16.429 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:18:16.435 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.454 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.455 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.456 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.457 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.459 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.460 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.461 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.463 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.464 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.465 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.466 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.467 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.469 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.470 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.472 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.473 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.474 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.475 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.476 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.478 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.479 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.481 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.482 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.483 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.484 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.486 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.487 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.489 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.490 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.492 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.494 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.495 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.497 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.499 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.500 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.501 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.503 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.505 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.506 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.508 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.512 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.514 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.515 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.516 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 84ms reading results.
2023-03-20 16:18:16.518 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.519 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:16.527 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:18:16.530 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:18:16.536 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:18:16.541 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:16.542 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 16:18:16.543 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:16.544 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.545 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.547 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:18:16.552 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:18:16.555 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.557 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.558 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.560 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.561 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-03-20 16:18:16.563 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.564 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:16.569 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:18:16.575 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:18:16.634 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:18:16.642 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:16.643 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:16.644 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:16.646 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.647 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.648 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:18:16.655 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:18:16.673 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.676 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.718 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.720 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.723 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.725 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 65ms reading results.
2023-03-20 16:18:16.726 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.728 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:16.736 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:18:16.739 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:18:16.756 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:18:16.761 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:16.763 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:16.764 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:16.765 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.766 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.767 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:18:16.773 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:18:16.776 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.777 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:18:16.779 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.780 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:16.785 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:18:16.808 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:18:16.815 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:16.816 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:16.818 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:16.819 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.820 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.821 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:18:16.825 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:18:16.832 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.848 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:16.850 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.851 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 23ms reading results.
2023-03-20 16:18:16.852 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:16.853 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:18:29.006 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:18:29.131 +04:00 [DBG] Hosting starting
2023-03-20 16:18:29.197 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:18:29.204 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:18:29.212 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:18:29.217 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:18:29.222 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:18:29.229 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:18:29.233 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:18:29.236 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:18:29.239 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:18:29.243 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:18:29.248 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:18:29.254 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:18:29.255 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:18:29.464 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:18:29.465 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:18:29.467 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:18:29.481 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:18:29.483 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:18:29.484 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:18:29.485 +04:00 [INF] Hosting environment: Development
2023-03-20 16:18:29.486 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:18:29.488 +04:00 [DBG] Hosting started
2023-03-20 16:18:29.493 +04:00 [DBG] Connection id "0HMP97KRFD9HA" accepted.
2023-03-20 16:18:29.493 +04:00 [DBG] Connection id "0HMP97KRFD9HB" accepted.
2023-03-20 16:18:29.496 +04:00 [DBG] Connection id "0HMP97KRFD9HA" started.
2023-03-20 16:18:29.496 +04:00 [DBG] Connection id "0HMP97KRFD9HB" started.
2023-03-20 16:18:29.515 +04:00 [DBG] Connection id "0HMP97KRFD9HB" received FIN.
2023-03-20 16:18:29.515 +04:00 [DBG] Connection id "0HMP97KRFD9HA" received FIN.
2023-03-20 16:18:29.525 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:18:29.525 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:18:29.580 +04:00 [DBG] Connection id "0HMP97KRFD9HA" stopped.
2023-03-20 16:18:29.580 +04:00 [DBG] Connection id "0HMP97KRFD9HB" stopped.
2023-03-20 16:18:29.585 +04:00 [DBG] Connection id "0HMP97KRFD9HB" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:18:29.585 +04:00 [DBG] Connection id "0HMP97KRFD9HA" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:18:29.875 +04:00 [DBG] Connection id "0HMP97KRFD9HC" accepted.
2023-03-20 16:18:29.877 +04:00 [DBG] Connection id "0HMP97KRFD9HC" started.
2023-03-20 16:18:29.938 +04:00 [DBG] Connection 0HMP97KRFD9HC established using the following protocol: "Tls12"
2023-03-20 16:18:30.034 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:18:30.064 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:18:30.091 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:18:30.093 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:18:30.302 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:18:30.326 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:18:30.332 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 300.5537ms
2023-03-20 16:18:30.353 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:18:30.362 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.6034ms
2023-03-20 16:18:30.394 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:18:30.442 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 48.5385ms
2023-03-20 16:18:30.526 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:18:30.527 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:18:30.528 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:18:30.652 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 126.3033ms
2023-03-20 16:18:31.723 +04:00 [DBG] Connection id "0HMP97KRFD9HC" received FIN.
2023-03-20 16:18:31.728 +04:00 [DBG] The connection queue processing loop for 0HMP97KRFD9HC completed.
2023-03-20 16:18:31.731 +04:00 [DBG] Connection id "0HMP97KRFD9HC" is closed. The last processed stream ID was 7.
2023-03-20 16:18:31.734 +04:00 [DBG] Connection id "0HMP97KRFD9HC" sending FIN because: "The client closed the connection."
2023-03-20 16:18:31.744 +04:00 [DBG] Connection id "0HMP97KRFD9HC" stopped.
2023-03-20 16:18:33.552 +04:00 [DBG] Connection id "0HMP97KRFD9HD" accepted.
2023-03-20 16:18:33.553 +04:00 [DBG] Connection id "0HMP97KRFD9HD" received FIN.
2023-03-20 16:18:33.554 +04:00 [DBG] Connection id "0HMP97KRFD9HD" started.
2023-03-20 16:18:33.555 +04:00 [DBG] Connection id "0HMP97KRFD9HE" accepted.
2023-03-20 16:18:33.559 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:18:33.560 +04:00 [DBG] Connection id "0HMP97KRFD9HE" started.
2023-03-20 16:18:33.565 +04:00 [DBG] Connection id "0HMP97KRFD9HD" stopped.
2023-03-20 16:18:33.568 +04:00 [DBG] Connection id "0HMP97KRFD9HD" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:18:33.572 +04:00 [DBG] Connection 0HMP97KRFD9HE established using the following protocol: "Tls12"
2023-03-20 16:18:33.585 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:18:33.593 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:18:33.598 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:18:33.602 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:18:33.605 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:18:33.851 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:18:33.854 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:18:33.863 +04:00 [DBG] Authorization was successful.
2023-03-20 16:18:33.867 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:18:33.897 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:18:33.901 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:18:33.903 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:18:33.905 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:18:33.907 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:18:33.909 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:18:33.914 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:18:34.067 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:18:34.090 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:18:34.105 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:18:34.109 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:18:34.112 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:18:34.123 +04:00 [DBG] Connection id "0HMP97KRFD9HE", Request id "0HMP97KRFD9HE:00000001": started reading request body.
2023-03-20 16:18:34.124 +04:00 [DBG] Connection id "0HMP97KRFD9HE", Request id "0HMP97KRFD9HE:00000001": done reading request body.
2023-03-20 16:18:34.132 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:18:34.133 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:34.134 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:34.136 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:18:34.146 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:18:34.589 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:18:34.591 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:18:34.930 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:18:34.972 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:18:35.135 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:18:35.174 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:35.177 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:18:35.204 +04:00 [DBG] Created DbConnection. (25ms).
2023-03-20 16:18:35.210 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (36ms).
2023-03-20 16:18:35.213 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (40ms).
2023-03-20 16:18:35.218 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.445 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.453 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:18:35.494 +04:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:18:35.524 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.553 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.556 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.557 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.558 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.560 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.562 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.564 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.565 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.566 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.567 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.568 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.569 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.571 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.572 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.574 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.575 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.576 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.578 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.579 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.581 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.583 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.584 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.585 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.586 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.588 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.589 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.591 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.592 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.593 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.595 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.596 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.598 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.599 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.600 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.601 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.603 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.604 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.605 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.607 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.608 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.612 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.614 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.620 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.626 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 125ms reading results.
2023-03-20 16:18:35.631 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.637 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-03-20 16:18:35.659 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:18:35.703 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:18:35.770 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:18:35.781 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:35.782 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:35.786 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:18:35.787 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.789 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.793 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:18:35.819 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:18:35.826 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.852 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.861 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:35.871 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.873 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 51ms reading results.
2023-03-20 16:18:35.876 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.877 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:35.883 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:18:35.891 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:18:35.962 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:18:35.973 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:35.974 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:35.975 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:35.976 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.978 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:35.979 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:18:35.986 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:18:36.004 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.008 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.046 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.048 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.050 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.052 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 62ms reading results.
2023-03-20 16:18:36.053 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.054 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:36.059 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:18:36.063 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:18:36.076 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:18:36.082 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:36.083 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:36.084 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:36.085 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.087 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.088 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:18:36.092 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:18:36.096 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.097 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:18:36.099 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.100 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:18:36.108 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:18:36.131 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:18:36.137 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:18:36.138 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:18:36.139 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:18:36.141 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.142 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.143 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:18:36.147 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:18:36.153 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.172 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:18:36.174 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.175 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 25ms reading results.
2023-03-20 16:18:36.177 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:18:36.178 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:19:01.135 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:19:01.309 +04:00 [DBG] Hosting starting
2023-03-20 16:19:01.360 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:19:01.368 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:19:01.379 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:19:01.388 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:19:01.396 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:19:01.406 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:19:01.412 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:19:01.416 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:19:01.419 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:19:01.424 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:19:01.430 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:19:01.437 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:19:01.439 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:19:01.668 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:19:01.669 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:19:01.671 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:19:01.672 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:19:01.673 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:19:01.674 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:19:01.675 +04:00 [INF] Hosting environment: Development
2023-03-20 16:19:01.676 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:19:01.676 +04:00 [DBG] Hosting started
2023-03-20 16:19:02.052 +04:00 [DBG] Connection id "0HMP97L55T7UU" accepted.
2023-03-20 16:19:02.054 +04:00 [DBG] Connection id "0HMP97L55T7UU" started.
2023-03-20 16:19:02.068 +04:00 [DBG] Connection id "0HMP97L55T7UV" accepted.
2023-03-20 16:19:02.070 +04:00 [DBG] Connection id "0HMP97L55T7UV" started.
2023-03-20 16:19:02.085 +04:00 [DBG] Connection id "0HMP97L55T7UV" received FIN.
2023-03-20 16:19:02.085 +04:00 [DBG] Connection id "0HMP97L55T7UU" received FIN.
2023-03-20 16:19:02.093 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:19:02.093 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:19:02.135 +04:00 [DBG] Connection id "0HMP97L55T7UU" stopped.
2023-03-20 16:19:02.135 +04:00 [DBG] Connection id "0HMP97L55T7UV" stopped.
2023-03-20 16:19:02.138 +04:00 [DBG] Connection id "0HMP97L55T7UU" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:19:02.138 +04:00 [DBG] Connection id "0HMP97L55T7UV" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:19:02.573 +04:00 [DBG] Connection id "0HMP97L55T7V0" accepted.
2023-03-20 16:19:02.575 +04:00 [DBG] Connection id "0HMP97L55T7V0" started.
2023-03-20 16:19:02.634 +04:00 [DBG] Connection 0HMP97L55T7V0 established using the following protocol: "Tls12"
2023-03-20 16:19:02.720 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:19:02.755 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:19:02.782 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:19:02.783 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:19:02.976 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:19:02.999 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:19:03.002 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 284.6864ms
2023-03-20 16:19:03.031 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:19:03.038 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.4321ms
2023-03-20 16:19:03.063 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:19:03.100 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 36.2483ms
2023-03-20 16:19:03.188 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:19:03.189 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:19:03.190 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:19:03.318 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 129.5249ms
2023-03-20 16:19:04.996 +04:00 [DBG] Connection id "0HMP97L55T7V1" accepted.
2023-03-20 16:19:04.998 +04:00 [DBG] Connection id "0HMP97L55T7V1" started.
2023-03-20 16:19:04.999 +04:00 [DBG] Connection id "0HMP97L55T7V1" received FIN.
2023-03-20 16:19:04.999 +04:00 [DBG] Connection id "0HMP97L55T7V2" accepted.
2023-03-20 16:19:05.010 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:19:05.011 +04:00 [DBG] Connection id "0HMP97L55T7V2" started.
2023-03-20 16:19:05.015 +04:00 [DBG] Connection id "0HMP97L55T7V1" stopped.
2023-03-20 16:19:05.017 +04:00 [DBG] Connection id "0HMP97L55T7V1" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:19:05.021 +04:00 [DBG] Connection 0HMP97L55T7V2 established using the following protocol: "Tls12"
2023-03-20 16:19:05.032 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:19:05.038 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:19:05.042 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:19:05.046 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:19:05.050 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:19:05.380 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:19:05.383 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:19:05.391 +04:00 [DBG] Authorization was successful.
2023-03-20 16:19:05.397 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:19:05.422 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:19:05.425 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:19:05.427 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:19:05.428 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:19:05.430 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:19:05.432 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:19:05.434 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:19:05.582 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:19:05.611 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:19:05.627 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:19:05.632 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:19:05.635 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:19:05.645 +04:00 [DBG] Connection id "0HMP97L55T7V2", Request id "0HMP97L55T7V2:00000001": started reading request body.
2023-03-20 16:19:05.647 +04:00 [DBG] Connection id "0HMP97L55T7V2", Request id "0HMP97L55T7V2:00000001": done reading request body.
2023-03-20 16:19:05.653 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:19:05.655 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:05.656 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:05.657 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:19:05.668 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:06.092 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:19:06.095 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:19:06.444 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:19:06.485 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:19:06.615 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:19:06.648 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:06.651 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:19:06.679 +04:00 [DBG] Created DbConnection. (25ms).
2023-03-20 16:19:06.686 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (37ms).
2023-03-20 16:19:06.690 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (42ms).
2023-03-20 16:19:06.695 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:06.909 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:06.917 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:19:06.954 +04:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:19:06.985 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.015 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.017 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.019 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.022 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.023 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.024 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.026 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.027 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.029 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.031 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.032 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.034 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.036 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.038 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.040 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.041 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.043 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.044 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.046 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.049 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.050 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.052 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.053 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.055 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.056 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.057 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.059 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.060 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.063 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.065 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.066 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.067 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.068 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.070 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.071 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.072 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.073 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.075 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.076 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.077 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.083 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.084 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.090 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.097 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 135ms reading results.
2023-03-20 16:19:07.101 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.107 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (6ms).
2023-03-20 16:19:07.129 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:19:07.168 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:19:07.235 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:19:07.248 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:07.249 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:07.253 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 16:19:07.255 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.257 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.262 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:19:07.286 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:19:07.293 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.321 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.330 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.340 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.342 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 52ms reading results.
2023-03-20 16:19:07.344 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.345 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:19:07.350 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:19:07.357 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:19:07.411 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:19:07.422 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:07.423 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:07.424 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:19:07.425 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.426 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.427 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:19:07.435 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:19:07.456 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.461 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.499 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.501 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.504 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.505 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 66ms reading results.
2023-03-20 16:19:07.507 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.508 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:19:07.513 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:19:07.517 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:19:07.530 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:19:07.536 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:07.537 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:07.538 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:19:07.540 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.541 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.542 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:19:07.547 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:19:07.551 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.552 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:19:07.553 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.555 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:19:07.560 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:19:07.584 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:19:07.592 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:07.593 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:07.595 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:19:07.596 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.597 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.598 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:19:07.602 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:19:07.608 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.630 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:07.632 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.633 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 28ms reading results.
2023-03-20 16:19:07.635 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:07.636 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:19:47.508 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:19:47.648 +04:00 [DBG] Hosting starting
2023-03-20 16:19:47.759 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:19:47.768 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:19:47.778 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:19:47.784 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:19:47.790 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:19:47.801 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:19:47.807 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:19:47.810 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:19:47.813 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:19:47.817 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:19:47.823 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:19:47.832 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:19:47.834 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:19:48.019 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:19:48.020 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:19:48.022 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:19:48.023 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:19:48.024 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:19:48.025 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:19:48.026 +04:00 [INF] Hosting environment: Development
2023-03-20 16:19:48.028 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:19:48.029 +04:00 [DBG] Hosting started
2023-03-20 16:19:48.252 +04:00 [DBG] Connection id "0HMP97LIUGD88" received FIN.
2023-03-20 16:19:48.257 +04:00 [DBG] Connection id "0HMP97LIUGD88" accepted.
2023-03-20 16:19:48.259 +04:00 [DBG] Connection id "0HMP97LIUGD88" started.
2023-03-20 16:19:48.278 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:19:48.331 +04:00 [DBG] Connection id "0HMP97LIUGD88" stopped.
2023-03-20 16:19:48.337 +04:00 [DBG] Connection id "0HMP97LIUGD88" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:19:48.651 +04:00 [DBG] Connection id "0HMP97LIUGD89" accepted.
2023-03-20 16:19:48.653 +04:00 [DBG] Connection id "0HMP97LIUGD89" started.
2023-03-20 16:19:48.716 +04:00 [DBG] Connection 0HMP97LIUGD89 established using the following protocol: "Tls12"
2023-03-20 16:19:48.810 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:19:48.852 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:19:48.898 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:19:48.901 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:19:49.111 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:19:49.135 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:19:49.139 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 332.0911ms
2023-03-20 16:19:49.153 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:19:49.158 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.4941ms
2023-03-20 16:19:49.184 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:19:49.220 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 35.5892ms
2023-03-20 16:19:49.312 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:19:49.314 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:19:49.315 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:19:49.469 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 156.9346ms
2023-03-20 16:19:50.743 +04:00 [DBG] Connection id "0HMP97LIUGD8A" accepted.
2023-03-20 16:19:50.743 +04:00 [DBG] Connection id "0HMP97LIUGD8A" received FIN.
2023-03-20 16:19:50.744 +04:00 [DBG] Connection id "0HMP97LIUGD8A" started.
2023-03-20 16:19:50.744 +04:00 [DBG] Connection id "0HMP97LIUGD8B" accepted.
2023-03-20 16:19:50.752 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:19:50.753 +04:00 [DBG] Connection id "0HMP97LIUGD8B" started.
2023-03-20 16:19:50.756 +04:00 [DBG] Connection id "0HMP97LIUGD8A" stopped.
2023-03-20 16:19:50.757 +04:00 [DBG] Connection id "0HMP97LIUGD8A" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:19:50.762 +04:00 [DBG] Connection 0HMP97LIUGD8B established using the following protocol: "Tls12"
2023-03-20 16:19:50.771 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 41
2023-03-20 16:19:50.776 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:19:50.781 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:19:50.783 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:19:50.785 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:19:50.999 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:19:51.001 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:19:51.009 +04:00 [DBG] Authorization was successful.
2023-03-20 16:19:51.015 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:19:51.047 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:19:51.050 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:19:51.052 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:19:51.053 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:19:51.055 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:19:51.057 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:19:51.060 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:19:51.193 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:19:51.221 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:19:51.238 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:19:51.242 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:19:51.245 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:19:51.256 +04:00 [DBG] Connection id "0HMP97LIUGD8B", Request id "0HMP97LIUGD8B:00000001": started reading request body.
2023-03-20 16:19:51.257 +04:00 [DBG] Connection id "0HMP97LIUGD8B", Request id "0HMP97LIUGD8B:00000001": done reading request body.
2023-03-20 16:19:51.265 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:19:51.266 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:51.268 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:51.269 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:19:51.280 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:19:51.720 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:19:51.722 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:19:51.883 +04:00 [DBG] Connection id "0HMP97LIUGD89" received FIN.
2023-03-20 16:19:51.886 +04:00 [DBG] The connection queue processing loop for 0HMP97LIUGD89 completed.
2023-03-20 16:19:51.888 +04:00 [DBG] Connection id "0HMP97LIUGD89" is closed. The last processed stream ID was 7.
2023-03-20 16:19:51.889 +04:00 [DBG] Connection id "0HMP97LIUGD89" sending FIN because: "The client closed the connection."
2023-03-20 16:19:51.899 +04:00 [DBG] Connection id "0HMP97LIUGD89" stopped.
2023-03-20 16:19:52.050 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:19:52.093 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:19:52.219 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:19:52.253 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:52.256 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:19:52.288 +04:00 [DBG] Created DbConnection. (28ms).
2023-03-20 16:19:52.296 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (43ms).
2023-03-20 16:19:52.299 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (47ms).
2023-03-20 16:19:52.304 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.535 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.544 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:19:52.580 +04:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:19:52.609 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.646 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.648 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.649 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.651 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.652 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.654 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.655 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.656 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.658 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.660 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.661 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.663 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.664 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.666 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.668 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.669 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.670 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.672 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.674 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.675 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.677 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.678 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.680 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.681 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.683 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.684 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.686 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.687 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.688 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.690 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.691 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.693 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.694 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.696 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.697 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.699 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.700 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.702 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.703 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.705 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.711 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.713 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.722 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.732 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 142ms reading results.
2023-03-20 16:19:52.737 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.745 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (7ms).
2023-03-20 16:19:52.769 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:19:52.809 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:19:52.871 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:19:52.883 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:52.885 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:52.888 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2023-03-20 16:19:52.890 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.892 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.896 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:19:52.922 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:19:52.931 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.957 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.966 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:52.976 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.978 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 53ms reading results.
2023-03-20 16:19:52.980 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:52.981 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:19:52.986 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:19:52.993 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:19:53.046 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:19:53.057 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:53.058 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:53.060 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 16:19:53.061 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.062 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.064 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:19:53.072 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:19:53.089 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.092 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.133 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.135 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.137 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.139 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 63ms reading results.
2023-03-20 16:19:53.140 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.141 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:19:53.147 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:19:53.151 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:19:53.166 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:19:53.172 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:53.173 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 16:19:53.174 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:19:53.175 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.177 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.179 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:19:53.183 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:19:53.185 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.187 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:19:53.188 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.189 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:19:53.194 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:19:53.214 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:19:53.222 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:19:53.224 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:19:53.225 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:19:53.226 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.228 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.229 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:19:53.232 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:19:53.238 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.254 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:19:53.257 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.258 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 23ms reading results.
2023-03-20 16:19:53.259 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:19:53.260 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:20.908 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 16:20:20.987 +04:00 [DBG] Hosting starting
2023-03-20 16:20:21.011 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 16:20:21.018 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 16:20:21.025 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 16:20:21.031 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 16:20:21.036 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 16:20:21.043 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 16:20:21.047 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:20:21.050 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 16:20:21.053 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 16:20:21.058 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 16:20:21.063 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 16:20:21.067 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 16:20:21.069 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 16:20:21.204 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 16:20:21.205 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 16:20:21.207 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 16:20:21.208 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 16:20:21.209 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 16:20:21.211 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 16:20:21.212 +04:00 [INF] Hosting environment: Development
2023-03-20 16:20:21.213 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 16:20:21.214 +04:00 [DBG] Hosting started
2023-03-20 16:20:21.476 +04:00 [DBG] Connection id "0HMP97LSRBLJV" accepted.
2023-03-20 16:20:21.476 +04:00 [DBG] Connection id "0HMP97LSRBLJU" accepted.
2023-03-20 16:20:21.478 +04:00 [DBG] Connection id "0HMP97LSRBLJV" started.
2023-03-20 16:20:21.479 +04:00 [DBG] Connection id "0HMP97LSRBLJU" started.
2023-03-20 16:20:21.486 +04:00 [DBG] Connection id "0HMP97LSRBLJV" received FIN.
2023-03-20 16:20:21.486 +04:00 [DBG] Connection id "0HMP97LSRBLJU" received FIN.
2023-03-20 16:20:21.493 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:20:21.497 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:20:21.519 +04:00 [DBG] Connection id "0HMP97LSRBLJV" stopped.
2023-03-20 16:20:21.520 +04:00 [DBG] Connection id "0HMP97LSRBLJU" stopped.
2023-03-20 16:20:21.523 +04:00 [DBG] Connection id "0HMP97LSRBLJV" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:20:21.523 +04:00 [DBG] Connection id "0HMP97LSRBLJU" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:20:21.735 +04:00 [DBG] Connection id "0HMP97LSRBLK0" accepted.
2023-03-20 16:20:21.737 +04:00 [DBG] Connection id "0HMP97LSRBLK0" started.
2023-03-20 16:20:21.789 +04:00 [DBG] Connection 0HMP97LSRBLK0 established using the following protocol: "Tls12"
2023-03-20 16:20:21.847 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 16:20:21.871 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 16:20:21.893 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 16:20:21.895 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:20:22.059 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 16:20:22.074 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 16:20:22.079 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 235.4422ms
2023-03-20 16:20:22.103 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 16:20:22.109 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.5488ms
2023-03-20 16:20:22.142 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 16:20:22.166 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.9266ms
2023-03-20 16:20:22.284 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 16:20:22.286 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 16:20:22.288 +04:00 [DBG] Request did not match any endpoints
2023-03-20 16:20:22.408 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 123.6545ms
2023-03-20 16:20:23.961 +04:00 [DBG] Connection id "0HMP97LSRBLK1" accepted.
2023-03-20 16:20:23.962 +04:00 [DBG] Connection id "0HMP97LSRBLK1" received FIN.
2023-03-20 16:20:23.963 +04:00 [DBG] Connection id "0HMP97LSRBLK1" started.
2023-03-20 16:20:23.963 +04:00 [DBG] Connection id "0HMP97LSRBLK2" accepted.
2023-03-20 16:20:23.965 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 16:20:23.966 +04:00 [DBG] Connection id "0HMP97LSRBLK2" started.
2023-03-20 16:20:23.968 +04:00 [DBG] Connection id "0HMP97LSRBLK1" stopped.
2023-03-20 16:20:23.969 +04:00 [DBG] Connection id "0HMP97LSRBLK1" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 16:20:23.983 +04:00 [DBG] Connection 0HMP97LSRBLK2 established using the following protocol: "Tls12"
2023-03-20 16:20:23.991 +04:00 [INF] Request starting HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 40
2023-03-20 16:20:23.995 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Transaction/cash-out'
2023-03-20 16:20:23.999 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)' with route pattern 'api/Transaction/cash-out' is valid for the request path '/api/Transaction/cash-out'
2023-03-20 16:20:24.001 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:20:24.004 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 16:20:24.123 +04:00 [DBG] Successfully validated the token.
2023-03-20 16:20:24.126 +04:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2023-03-20 16:20:24.132 +04:00 [DBG] Authorization was successful.
2023-03-20 16:20:24.134 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:20:24.154 +04:00 [INF] Route matched with {action = "CashOut", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CashOut(ATM.Services.Models.Requests.CashOutRequest) on controller ATM.Api.Controllers.TransactionController (ATM.Api).
2023-03-20 16:20:24.157 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 16:20:24.159 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 16:20:24.160 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 16:20:24.162 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 16:20:24.163 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 16:20:24.166 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:20:24.247 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 16:20:24.267 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.TransactionController (ATM.Api)
2023-03-20 16:20:24.274 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:20:24.277 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' using the name '' in request data ...
2023-03-20 16:20:24.280 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 16:20:24.290 +04:00 [DBG] Connection id "0HMP97LSRBLK2", Request id "0HMP97LSRBLK2:00000001": started reading request body.
2023-03-20 16:20:24.291 +04:00 [DBG] Connection id "0HMP97LSRBLK2", Request id "0HMP97LSRBLK2:00000001": done reading request body.
2023-03-20 16:20:24.297 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.CashOutRequest'
2023-03-20 16:20:24.298 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:20:24.299 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:20:24.301 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest' ...
2023-03-20 16:20:24.309 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.CashOutRequest'.
2023-03-20 16:20:24.649 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 16:20:24.651 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 16:20:24.917 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 16:20:24.959 +04:00 [DBG] Compiling query expression: 
'DbSet<CurrencyEntity>()'
2023-03-20 16:20:25.058 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CurrencyEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CurrencyEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CurrencyEntity.Code (string), 1], [Property: CurrencyEntity.Date (DateTime) Required, 2], [Property: CurrencyEntity.Diff (decimal) Required, 3], [Property: CurrencyEntity.DiffFormated (string), 4], [Property: CurrencyEntity.LastUpdatedAt (DateTime) Required, 5], [Property: CurrencyEntity.Name (string), 6], [Property: CurrencyEntity.Quantity (int) Required, 7], [Property: CurrencyEntity.Rate (decimal) Required, 8], [Property: CurrencyEntity.RateFormated (string), 9], [Property: CurrencyEntity.ValidFromDate (DateTime) Required, 10] }
        SELECT c.Id, c.Code, c.Date, c.Diff, c.DiffFormated, c.LastUpdatedAt, c.Name, c.Quantity, c.Rate, c.RateFormated, c.ValidFromDate
        FROM Currencies AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CurrencyEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:20:25.083 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.086 +04:00 [DBG] Creating DbConnection.
2023-03-20 16:20:25.102 +04:00 [DBG] Created DbConnection. (14ms).
2023-03-20 16:20:25.109 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (24ms).
2023-03-20 16:20:25.113 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (30ms).
2023-03-20 16:20:25.117 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.230 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.237 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:20:25.266 +04:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Date], [c].[Diff], [c].[DiffFormated], [c].[LastUpdatedAt], [c].[Name], [c].[Quantity], [c].[Rate], [c].[RateFormated], [c].[ValidFromDate]
FROM [Currencies] AS [c]
2023-03-20 16:20:25.291 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.319 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.321 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.322 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.324 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.325 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.326 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.328 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.329 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.331 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.332 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.333 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.335 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.336 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.337 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.339 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.340 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.341 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.342 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.344 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.345 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.346 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.348 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.349 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.351 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.352 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.353 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.355 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.356 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.357 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.358 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.360 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.361 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.362 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.363 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.364 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.366 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.367 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.368 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.369 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.370 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.374 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.376 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CurrencyEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.381 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.386 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 114ms reading results.
2023-03-20 16:20:25.390 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.396 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (5ms).
2023-03-20 16:20:25.413 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.Id == __cardId_0)'
2023-03-20 16:20:25.447 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 16:20:25.499 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE c.Id == @__cardId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:20:25.509 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.510 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:20:25.514 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 16:20:25.515 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.517 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.520 +04:00 [DBG] Executing DbCommand [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:20:25.538 +04:00 [INF] Executed DbCommand (20ms) [Parameters=[@__cardId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[Id] = @__cardId_0
2023-03-20 16:20:25.545 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.569 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.578 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.588 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.590 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 49ms reading results.
2023-03-20 16:20:25.592 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.593 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:25.599 +04:00 [DBG] Compiling query expression: 
'DbSet<UserEntity>()
    .Include(a => a.Accounts)
    .First(a => a.Accounts
        .Any(d => d.Id == __accountId_0))'
2023-03-20 16:20:25.605 +04:00 [DBG] Including navigation: 'UserEntity.Accounts'.
2023-03-20 16:20:25.669 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<UserEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<UserEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserEntity.AccessFailedCount (int) Required, 1], [Property: UserEntity.BirthDate (DateTime) Required, 2], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 3], [Property: UserEntity.Email (string) MaxLength(256), 4], [Property: UserEntity.EmailConfirmed (bool) Required, 5], [Property: UserEntity.FirstName (string), 6], [Property: UserEntity.LastName (string), 7], [Property: UserEntity.LockoutEnabled (bool) Required, 8], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 9], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 10], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 11], [Property: UserEntity.PasswordHash (string), 12], [Property: UserEntity.PersonalNumber (string), 13], [Property: UserEntity.PhoneNumber (string), 14], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 15], [Property: UserEntity.RegisteredAt (DateTime) Required, 16], [Property: UserEntity.SecurityStamp (string), 17], [Property: UserEntity.TwoFactorEnabled (bool) Required, 18], [Property: UserEntity.UserName (string) MaxLength(256), 19] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: AccountEntity.Amount (decimal) Required, 21], [Property: AccountEntity.Currency (CurrencyType) Required, 22], [Property: AccountEntity.Iban (string), 23], [Property: AccountEntity.UserId (Guid) Required FK Index, 24] }
                3 -> 20
            SELECT t.Id, t.AccessFailedCount, t.BirthDate, t.ConcurrencyStamp, t.Email, t.EmailConfirmed, t.FirstName, t.LastName, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PersonalNumber, t.PhoneNumber, t.PhoneNumberConfirmed, t.RegisteredAt, t.SecurityStamp, t.TwoFactorEnabled, t.UserName, a1.Id, a1.Amount, a1.Currency, a1.Iban, a1.UserId
            FROM 
            (
                SELECT TOP(1) a.Id, a.AccessFailedCount, a.BirthDate, a.ConcurrencyStamp, a.Email, a.EmailConfirmed, a.FirstName, a.LastName, a.LockoutEnabled, a.LockoutEnd, a.NormalizedEmail, a.NormalizedUserName, a.PasswordHash, a.PersonalNumber, a.PhoneNumber, a.PhoneNumberConfirmed, a.RegisteredAt, a.SecurityStamp, a.TwoFactorEnabled, a.UserName
                FROM AspNetUsers AS a
                WHERE EXISTS (
                    SELECT 1
                    FROM Accounts AS a0
                    WHERE ((a.Id != NULL) && (a.Id == a0.UserId)) && (a0.Id == @__accountId_0))
            ) AS t
            LEFT JOIN Accounts AS a1 ON t.Id == a1.UserId
            ORDER BY t.Id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, UserEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 16:20:25.682 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.684 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:20:25.685 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:20:25.686 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.688 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.689 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:20:25.698 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:20:25.723 +04:00 [DBG] The navigation 'AccountEntity.UserEntity' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.726 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'UserEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.768 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.770 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.772 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.773 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 71ms reading results.
2023-03-20 16:20:25.774 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.776 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:25.780 +04:00 [DBG] Compiling query expression: 
'DbSet<AccountEntity>()
    .Include(a => a.UserEntity)
    .Where(a => a.UserEntity == __user_0)'
2023-03-20 16:20:25.783 +04:00 [DBG] Including navigation: 'AccountEntity.UserEntity'.
2023-03-20 16:20:25.796 +04:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__entity_equality_user_0_Id", 
        value: (object)Invoke(queryContext => RelationalSqlTranslatingExpressionVisitor.ParameterValueExtractor<Guid?>(
            context: queryContext, 
            baseParameterName: "__user_0", 
            property: Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd), queryContext));
    return new SingleQueryingEnumerable<AccountEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AccountEntity.Amount (decimal) Required, 1], [Property: AccountEntity.Currency (CurrencyType) Required, 2], [Property: AccountEntity.Iban (string), 3], [Property: AccountEntity.UserId (Guid) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: UserEntity.AccessFailedCount (int) Required, 6], [Property: UserEntity.BirthDate (DateTime) Required, 7], [Property: UserEntity.ConcurrencyStamp (string) Concurrency, 8], [Property: UserEntity.Email (string) MaxLength(256), 9], [Property: UserEntity.EmailConfirmed (bool) Required, 10], [Property: UserEntity.FirstName (string), 11], [Property: UserEntity.LastName (string), 12], [Property: UserEntity.LockoutEnabled (bool) Required, 13], [Property: UserEntity.LockoutEnd (DateTimeOffset?), 14], [Property: UserEntity.NormalizedEmail (string) Index MaxLength(256), 15], [Property: UserEntity.NormalizedUserName (string) Index MaxLength(256), 16], [Property: UserEntity.PasswordHash (string), 17], [Property: UserEntity.PersonalNumber (string), 18], [Property: UserEntity.PhoneNumber (string), 19], [Property: UserEntity.PhoneNumberConfirmed (bool) Required, 20], [Property: UserEntity.RegisteredAt (DateTime) Required, 21], [Property: UserEntity.SecurityStamp (string), 22], [Property: UserEntity.TwoFactorEnabled (bool) Required, 23], [Property: UserEntity.UserName (string) MaxLength(256), 24] }
            SELECT a.Id, a.Amount, a.Currency, a.Iban, a.UserId, a0.Id, a0.AccessFailedCount, a0.BirthDate, a0.ConcurrencyStamp, a0.Email, a0.EmailConfirmed, a0.FirstName, a0.LastName, a0.LockoutEnabled, a0.LockoutEnd, a0.NormalizedEmail, a0.NormalizedUserName, a0.PasswordHash, a0.PersonalNumber, a0.PhoneNumber, a0.PhoneNumberConfirmed, a0.RegisteredAt, a0.SecurityStamp, a0.TwoFactorEnabled, a0.UserName
            FROM Accounts AS a
            INNER JOIN AspNetUsers AS a0 ON a.UserId == a0.Id
            WHERE a0.Id == @__entity_equality_user_0_Id), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    );
}'
2023-03-20 16:20:25.801 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.802 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2023-03-20 16:20:25.803 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:20:25.804 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.805 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.807 +04:00 [DBG] Executing DbCommand [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:20:25.811 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__entity_equality_user_0_Id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[BirthDate], [a0].[ConcurrencyStamp], [a0].[Email], [a0].[EmailConfirmed], [a0].[FirstName], [a0].[LastName], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PersonalNumber], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[RegisteredAt], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName]
FROM [Accounts] AS [a]
INNER JOIN [AspNetUsers] AS [a0] ON [a].[UserId] = [a0].[Id]
WHERE [a0].[Id] = @__entity_equality_user_0_Id
2023-03-20 16:20:25.814 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.815 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:20:25.817 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.818 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:25.822 +04:00 [DBG] Compiling query expression: 
'DbSet<TransactionEntity>()
    .Where(t => (int)t.TransactionType == 0 && __accountIds_0
        .Contains(t.AccountFromId))'
2023-03-20 16:20:25.851 +04:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<TransactionEntity>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: TransactionEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: TransactionEntity.AccountFromId (Guid) Required, 1], [Property: TransactionEntity.AccountToId (Guid?), 2], [Property: TransactionEntity.Amount (decimal) Required, 3], [Property: TransactionEntity.CreatedAt (DateTime) Required, 4], [Property: TransactionEntity.CurrencyFrom (CurrencyType) Required, 5], [Property: TransactionEntity.CurrencyTo (CurrencyType) Required, 6], [Property: TransactionEntity.Fee (decimal) Required, 7], [Property: TransactionEntity.TransactionType (TransactionType) Required, 8] }
        SELECT t.Id, t.AccountFromId, t.AccountToId, t.Amount, t.CreatedAt, t.CurrencyFrom, t.CurrencyTo, t.Fee, t.TransactionType
        FROM Transactions AS t
        WHERE (t.TransactionType == 0) && t.AccountFromId IN (@__accountIds_0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, TransactionEntity>, 
    BankSystem.Common.Db.BankSystemDbContext, 
    False, 
    False, 
    True
)'
2023-03-20 16:20:25.857 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.859 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:20:25.860 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2023-03-20 16:20:25.861 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.863 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.864 +04:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:20:25.867 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccountFromId], [t].[AccountToId], [t].[Amount], [t].[CreatedAt], [t].[CurrencyFrom], [t].[CurrencyTo], [t].[Fee], [t].[TransactionType]
FROM [Transactions] AS [t]
WHERE [t].[TransactionType] = 0 AND [t].[AccountFromId] IN ('bb611ce3-db93-405a-8492-5b0a0af75341', '69f91843-d82c-4b24-92af-9bc4e2d80ab9', '83565761-3126-4d76-9b7a-a2c6eb549f33')
2023-03-20 16:20:25.873 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.888 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.889 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.890 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 20ms reading results.
2023-03-20 16:20:25.892 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.893 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:25.899 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:25.900 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:20:25.902 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2023-03-20 16:20:25.903 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.904 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.906 +04:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:20:25.911 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AccessFailedCount], [t].[BirthDate], [t].[ConcurrencyStamp], [t].[Email], [t].[EmailConfirmed], [t].[FirstName], [t].[LastName], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PersonalNumber], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RegisteredAt], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UserName], [a1].[Id], [a1].[Amount], [a1].[Currency], [a1].[Iban], [a1].[UserId]
FROM (
    SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[BirthDate], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FirstName], [a].[LastName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PersonalNumber], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegisteredAt], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [AspNetUsers] AS [a]
    WHERE EXISTS (
        SELECT 1
        FROM [Accounts] AS [a0]
        WHERE [a].[Id] = [a0].[UserId] AND [a0].[Id] = @__accountId_0)
) AS [t]
LEFT JOIN [Accounts] AS [a1] ON [t].[Id] = [a1].[UserId]
ORDER BY [t].[Id]
2023-03-20 16:20:25.915 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.916 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 1ms reading results.
2023-03-20 16:20:25.917 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:25.919 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (1ms).
2023-03-20 16:20:25.937 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'TransactionEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.954 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'EmailRequestEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:25.958 +04:00 [DBG] SaveChanges starting for 'BankSystemDbContext'.
2023-03-20 16:20:25.962 +04:00 [DBG] DetectChanges starting for 'BankSystemDbContext'.
2023-03-20 16:20:26.003 +04:00 [DBG] The unchanged property 'AccountEntity.Amount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2023-03-20 16:20:26.010 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:26.023 +04:00 [DBG] DetectChanges completed for 'BankSystemDbContext'.
2023-03-20 16:20:26.094 +04:00 [DBG] Executing 3 update commands as a batch.
2023-03-20 16:20:26.098 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:26.099 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:26.101 +04:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2023-03-20 16:20:26.107 +04:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2023-03-20 16:20:26.112 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 16:20:26.114 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2023-03-20 16:20:26.118 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2023-03-20 16:20:26.119 +04:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 16:20:26.131 +04:00 [INF] Executed DbCommand (12ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 3) (DbType = Decimal), @p16='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Amount] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [EmailRequests] ([Id], [Body], [CreatedAt], [Status], [Subject], [ToAddress])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO [Transactions] ([Id], [AccountFromId], [AccountToId], [Amount], [CreatedAt], [CurrencyFrom], [CurrencyTo], [Fee], [TransactionType])
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-03-20 16:20:26.137 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:26.138 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 5ms reading results.
2023-03-20 16:20:26.143 +04:00 [DBG] Committing transaction.
2023-03-20 16:20:26.147 +04:00 [DBG] Committed transaction.
2023-03-20 16:20:26.149 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:26.150 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (0ms).
2023-03-20 16:20:26.153 +04:00 [DBG] Disposing transaction.
2023-03-20 16:20:26.156 +04:00 [DBG] An entity of type 'TransactionEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:26.159 +04:00 [DBG] An entity of type 'EmailRequestEntity' tracked by 'BankSystemDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:26.161 +04:00 [DBG] An entity of type 'AccountEntity' tracked by 'BankSystemDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 16:20:26.164 +04:00 [DBG] SaveChanges completed for 'BankSystemDbContext' with 3 entities written to the database.
2023-03-20 16:20:26.168 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 16:20:26.172 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 16:20:26.172 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 16:20:26.173 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 16:20:26.175 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2023-03-20 16:20:26.176 +04:00 [INF] Executing OkObjectResult, writing value of type 'ATM.Services.Models.CashOutOperation'.
2023-03-20 16:20:26.189 +04:00 [INF] Executed action ATM.Api.Controllers.TransactionController.CashOut (ATM.Api) in 2021.6212ms
2023-03-20 16:20:26.191 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.TransactionController.CashOut (ATM.Api)'
2023-03-20 16:20:26.193 +04:00 [DBG] Connection id "0HMP97LSRBLK2" completed keep alive response.
2023-03-20 16:20:26.195 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 16:20:26.199 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 16:20:26.201 +04:00 [DBG] Disposed connection to database '' on server '' (2ms).
2023-03-20 16:20:26.203 +04:00 [INF] Request finished HTTP/1.1 POST https://localhost:7261/api/Transaction/cash-out application/json 40 - 200 - application/json;+charset=utf-8 2212.3158ms
2023-03-20 16:20:26.937 +04:00 [DBG] Connection id "0HMP97LSRBLK0" received FIN.
2023-03-20 16:20:26.939 +04:00 [DBG] The connection queue processing loop for 0HMP97LSRBLK0 completed.
2023-03-20 16:20:26.939 +04:00 [DBG] Connection id "0HMP97LSRBLK0" is closed. The last processed stream ID was 7.
2023-03-20 16:20:26.942 +04:00 [DBG] Connection id "0HMP97LSRBLK0" sending FIN because: "The client closed the connection."
2023-03-20 16:20:26.952 +04:00 [DBG] Connection id "0HMP97LSRBLK0" stopped.
2023-03-20 16:22:38.149 +04:00 [DBG] Connection id "0HMP97LSRBLK2" disconnecting.
2023-03-20 16:22:38.150 +04:00 [DBG] Connection id "0HMP97LSRBLK2" stopped.
2023-03-20 16:22:38.151 +04:00 [DBG] Connection id "0HMP97LSRBLK2" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 23:56:33.877 +04:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2023-03-20 23:56:33.950 +04:00 [DBG] Hosting starting
2023-03-20 23:56:33.976 +04:00 [INF] User profile is available. Using 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-03-20 23:56:33.982 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-298957ac-1947-4690-b38f-95802ef792d5.xml'.
2023-03-20 23:56:33.990 +04:00 [DBG] Reading data from file 'C:\Users\srevazishvili\AppData\Local\ASP.NET\DataProtection-Keys\key-6b67ca3e-ca56-48ef-abcb-f08bc91b8c44.xml'.
2023-03-20 23:56:33.995 +04:00 [DBG] Found key {298957ac-1947-4690-b38f-95802ef792d5}.
2023-03-20 23:56:34.000 +04:00 [DBG] Found key {6b67ca3e-ca56-48ef-abcb-f08bc91b8c44}.
2023-03-20 23:56:34.006 +04:00 [DBG] Considering key {298957ac-1947-4690-b38f-95802ef792d5} with expiration date 2023-06-02 19:40:18Z as default key.
2023-03-20 23:56:34.009 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 23:56:34.012 +04:00 [DBG] Decrypting secret element using Windows DPAPI.
2023-03-20 23:56:34.014 +04:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=7.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2023-03-20 23:56:34.018 +04:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2023-03-20 23:56:34.023 +04:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2023-03-20 23:56:34.027 +04:00 [DBG] Using key {298957ac-1947-4690-b38f-95802ef792d5} as the default key.
2023-03-20 23:56:34.028 +04:00 [DBG] Key ring with default key {298957ac-1947-4690-b38f-95802ef792d5} was loaded during application startup.
2023-03-20 23:56:34.168 +04:00 [INF] Now listening on: https://localhost:7261
2023-03-20 23:56:34.169 +04:00 [INF] Now listening on: http://localhost:5059
2023-03-20 23:56:34.170 +04:00 [DBG] Loaded hosting startup assembly ATM.Api
2023-03-20 23:56:34.171 +04:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2023-03-20 23:56:34.173 +04:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2023-03-20 23:56:34.174 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2023-03-20 23:56:34.175 +04:00 [INF] Hosting environment: Development
2023-03-20 23:56:34.176 +04:00 [INF] Content root path: C:\Users\srevazishvili\source\repos\BankSystem\ATM.Api
2023-03-20 23:56:34.177 +04:00 [DBG] Hosting started
2023-03-20 23:56:34.369 +04:00 [DBG] Connection id "0HMP9FKQJJAON" accepted.
2023-03-20 23:56:34.371 +04:00 [DBG] Connection id "0HMP9FKQJJAON" started.
2023-03-20 23:56:34.379 +04:00 [DBG] Connection id "0HMP9FKQJJAOO" received FIN.
2023-03-20 23:56:34.379 +04:00 [DBG] Connection id "0HMP9FKQJJAON" received FIN.
2023-03-20 23:56:34.381 +04:00 [DBG] Connection id "0HMP9FKQJJAOO" accepted.
2023-03-20 23:56:34.383 +04:00 [DBG] Connection id "0HMP9FKQJJAOO" started.
2023-03-20 23:56:34.384 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 23:56:34.384 +04:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2023-03-20 23:56:34.417 +04:00 [DBG] Connection id "0HMP9FKQJJAOO" stopped.
2023-03-20 23:56:34.417 +04:00 [DBG] Connection id "0HMP9FKQJJAON" stopped.
2023-03-20 23:56:34.419 +04:00 [DBG] Connection id "0HMP9FKQJJAOO" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 23:56:34.419 +04:00 [DBG] Connection id "0HMP9FKQJJAON" sending FIN because: "The Socket transport's send loop completed gracefully."
2023-03-20 23:56:34.534 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" accepted.
2023-03-20 23:56:34.535 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" started.
2023-03-20 23:56:34.583 +04:00 [DBG] Connection 0HMP9FKQJJAOP established using the following protocol: "Tls12"
2023-03-20 23:56:34.631 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - -
2023-03-20 23:56:34.653 +04:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2023-03-20 23:56:34.675 +04:00 [DBG] No candidates found for the request path '/swagger/index.html'
2023-03-20 23:56:34.677 +04:00 [DBG] Request did not match any endpoints
2023-03-20 23:56:34.848 +04:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2023-03-20 23:56:34.864 +04:00 [DBG] Response markup was updated to include browser refresh script injection.
2023-03-20 23:56:34.867 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - - - 200 - text/html;charset=utf-8 238.2377ms
2023-03-20 23:56:34.896 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - -
2023-03-20 23:56:34.904 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.2915ms
2023-03-20 23:56:34.928 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/_vs/browserLink - -
2023-03-20 23:56:34.948 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 19.7778ms
2023-03-20 23:56:35.056 +04:00 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - -
2023-03-20 23:56:35.058 +04:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2023-03-20 23:56:35.060 +04:00 [DBG] Request did not match any endpoints
2023-03-20 23:56:35.193 +04:00 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 136.8685ms
2023-03-20 23:56:39.532 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" received FIN.
2023-03-20 23:56:39.536 +04:00 [DBG] The connection queue processing loop for 0HMP9FKQJJAOP completed.
2023-03-20 23:56:39.540 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" is closed. The last processed stream ID was 7.
2023-03-20 23:56:39.542 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" sending FIN because: "The client closed the connection."
2023-03-20 23:56:39.546 +04:00 [DBG] Connection id "0HMP9FKQJJAOP" stopped.
2023-03-20 23:56:51.093 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" accepted.
2023-03-20 23:56:51.094 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" started.
2023-03-20 23:56:51.098 +04:00 [DBG] Connection 0HMP9FKQJJAOQ established using the following protocol: "Tls12"
2023-03-20 23:56:51.102 +04:00 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Card/login application/json 45
2023-03-20 23:56:51.108 +04:00 [DBG] 1 candidate(s) found for the request path '/api/Card/login'
2023-03-20 23:56:51.122 +04:00 [DBG] Endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)' with route pattern 'api/Card/login' is valid for the request path '/api/Card/login'
2023-03-20 23:56:51.124 +04:00 [DBG] Request matched endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 23:56:51.126 +04:00 [DBG] Static files was skipped as the request already matched an endpoint.
2023-03-20 23:56:51.128 +04:00 [DBG] The request has an origin header: 'https://localhost:7261'.
2023-03-20 23:56:51.129 +04:00 [INF] CORS policy execution successful.
2023-03-20 23:56:51.160 +04:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2023-03-20 23:56:51.166 +04:00 [INF] Executing endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 23:56:51.186 +04:00 [INF] Route matched with {action = "Login", controller = "Card"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ATM.Services.Models.Requests.LoginRequest) on controller ATM.Api.Controllers.CardController (ATM.Api).
2023-03-20 23:56:51.190 +04:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2023-03-20 23:56:51.191 +04:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2023-03-20 23:56:51.193 +04:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2023-03-20 23:56:51.195 +04:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2023-03-20 23:56:51.197 +04:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2023-03-20 23:56:51.200 +04:00 [DBG] Executing controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 23:56:51.313 +04:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2023-03-20 23:56:51.334 +04:00 [DBG] Executed controller factory for controller ATM.Api.Controllers.CardController (ATM.Api)
2023-03-20 23:56:51.353 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 23:56:51.357 +04:00 [DBG] Attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' using the name '' in request data ...
2023-03-20 23:56:51.360 +04:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2023-03-20 23:56:51.369 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ", Request id "0HMP9FKQJJAOQ:00000001": started reading request body.
2023-03-20 23:56:51.370 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ", Request id "0HMP9FKQJJAOQ:00000001": done reading request body.
2023-03-20 23:56:51.376 +04:00 [DBG] JSON input formatter succeeded, deserializing to type 'ATM.Services.Models.Requests.LoginRequest'
2023-03-20 23:56:51.377 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 23:56:51.378 +04:00 [DBG] Done attempting to bind parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 23:56:51.379 +04:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest' ...
2023-03-20 23:56:51.388 +04:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ATM.Services.Models.Requests.LoginRequest'.
2023-03-20 23:56:51.853 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<Guid>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2023-03-20 23:56:51.855 +04:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<Guid>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2023-03-20 23:56:52.119 +04:00 [DBG] Entity Framework Core 7.0.3 initialized 'BankSystemDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:7.0.3' with options: None
2023-03-20 23:56:52.191 +04:00 [DBG] Compiling query expression: 
'DbSet<CardEntity>()
    .Include(c => c.Account)
    .FirstOrDefault(c => c.CardNumber == __request_CardNumber_0 && (int)c.Pin == (int)__request_Pin_1)'
2023-03-20 23:56:52.248 +04:00 [DBG] Including navigation: 'CardEntity.Account'.
2023-03-20 23:56:52.387 +04:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CardEntity>(
    asyncEnumerable: new SingleQueryingEnumerable<CardEntity>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: CardEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CardEntity.AccountId (Guid) Required FK Index, 1], [Property: CardEntity.CardNumber (string), 2], [Property: CardEntity.CreatedAt (DateTime) Required, 3], [Property: CardEntity.Cvv (short) Required, 4], [Property: CardEntity.ExpiresAt (DateTime) Required, 5], [Property: CardEntity.FullName (string), 6], [Property: CardEntity.Pin (short) Required, 7] }
                1 -> Dictionary<IProperty, int> { [Property: AccountEntity.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: AccountEntity.Amount (decimal) Required, 9], [Property: AccountEntity.Currency (CurrencyType) Required, 10], [Property: AccountEntity.Iban (string), 11], [Property: AccountEntity.UserId (Guid) Required FK Index, 12] }
            SELECT TOP(1) c.Id, c.AccountId, c.CardNumber, c.CreatedAt, c.Cvv, c.ExpiresAt, c.FullName, c.Pin, a.Id, a.Amount, a.Currency, a.Iban, a.UserId
            FROM Cards AS c
            INNER JOIN Accounts AS a ON c.AccountId == a.Id
            WHERE (c.CardNumber == @__request_CardNumber_0) && (c.Pin == @__request_Pin_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CardEntity>, 
        BankSystem.Common.Db.BankSystemDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2023-03-20 23:56:52.419 +04:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2023-03-20 23:56:52.422 +04:00 [DBG] Creating DbConnection.
2023-03-20 23:56:52.445 +04:00 [DBG] Created DbConnection. (21ms).
2023-03-20 23:56:52.452 +04:00 [DBG] Created DbCommand for 'ExecuteReader' (34ms).
2023-03-20 23:56:52.460 +04:00 [DBG] Initialized DbCommand for 'ExecuteReader' (43ms).
2023-03-20 23:56:52.465 +04:00 [DBG] Opening connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 23:56:52.641 +04:00 [DBG] Opened connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 23:56:52.651 +04:00 [DBG] Executing DbCommand [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 23:56:52.692 +04:00 [INF] Executed DbCommand (45ms) [Parameters=[@__request_CardNumber_0='?' (Size = 4000), @__request_Pin_1='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[AccountId], [c].[CardNumber], [c].[CreatedAt], [c].[Cvv], [c].[ExpiresAt], [c].[FullName], [c].[Pin], [a].[Id], [a].[Amount], [a].[Currency], [a].[Iban], [a].[UserId]
FROM [Cards] AS [c]
INNER JOIN [Accounts] AS [a] ON [c].[AccountId] = [a].[Id]
WHERE [c].[CardNumber] = @__request_CardNumber_0 AND [c].[Pin] = @__request_Pin_1
2023-03-20 23:56:52.715 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'CardEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 23:56:52.746 +04:00 [DBG] The navigation 'CardEntity.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 23:56:52.754 +04:00 [DBG] Context 'BankSystemDbContext' started tracking 'AccountEntity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2023-03-20 23:56:52.768 +04:00 [DBG] Closing data reader to 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 23:56:52.776 +04:00 [DBG] A data reader for 'BankSystem' on server '(localdb)\MSSQLLocalDB' is being disposed after spending 76ms reading results.
2023-03-20 23:56:52.780 +04:00 [DBG] Closing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 23:56:52.785 +04:00 [DBG] Closed connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB' (4ms).
2023-03-20 23:56:52.878 +04:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2023-03-20 23:56:52.881 +04:00 [DBG] No information found on request to perform content negotiation.
2023-03-20 23:56:52.882 +04:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2023-03-20 23:56:52.883 +04:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2023-03-20 23:56:52.885 +04:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2023-03-20 23:56:52.886 +04:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2023-03-20 23:56:52.892 +04:00 [INF] Executed action ATM.Api.Controllers.CardController.Login (ATM.Api) in 1690.6426ms
2023-03-20 23:56:52.894 +04:00 [INF] Executed endpoint 'ATM.Api.Controllers.CardController.Login (ATM.Api)'
2023-03-20 23:56:52.897 +04:00 [DBG] 'BankSystemDbContext' disposed.
2023-03-20 23:56:52.903 +04:00 [DBG] Disposing connection to database 'BankSystem' on server '(localdb)\MSSQLLocalDB'.
2023-03-20 23:56:52.906 +04:00 [DBG] Disposed connection to database '' on server '' (3ms).
2023-03-20 23:56:52.908 +04:00 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Card/login application/json 45 - 200 - text/plain;+charset=utf-8 1805.9311ms
2023-03-20 23:56:59.567 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" received FIN.
2023-03-20 23:56:59.568 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" is closed. The last processed stream ID was 1.
2023-03-20 23:56:59.568 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" sending FIN because: "The client closed the connection."
2023-03-20 23:56:59.572 +04:00 [DBG] The connection queue processing loop for 0HMP9FKQJJAOQ completed.
2023-03-20 23:56:59.574 +04:00 [DBG] Connection id "0HMP9FKQJJAOQ" stopped.
